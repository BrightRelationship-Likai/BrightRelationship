!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="//concat.lietou-static.com/dev/c/pc/v3/build/",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(111),_reactDom2=_interopRequireDefault(_reactDom),_imcore=__webpack_require__(112),_imcore2=_interopRequireDefault(_imcore),_imui=__webpack_require__(168),_imui2=_interopRequireDefault(_imui),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_send=__webpack_require__(221),_showDialog=__webpack_require__(283),_showDialog2=_interopRequireDefault(_showDialog),_cMessageActions=__webpack_require__(287),_MsgCards=__webpack_require__(288),_MsgCards2=_interopRequireDefault(_MsgCards),_api=__webpack_require__(301),api=_interopRequireWildcard(_api);!function(){function _toggleUnRead(unread){$("#header-c-beta2 [data-selector=drop-menu-message] .red-dot").toggleClass("hide",!unread)}function _openPanel(callback){$("#header-c-beta2").on("click",'[data-selector="drop-menu-message"]',function(e){callback()})}function _componentDidMounted(_ref){var imcore=_ref.imcore,actions=_ref.actions,dispatch=_ref.dispatch;window.showDialog=function(options){options.jobDetail&&!$.isEmptyObject(options.jobDetail)?dispatch((0,_cMessageActions.cSendJobCardAndApplyResume)(imcore,options)):actions.selectContact(imcore,options)},window.sendResume=function(options){dispatch((0,_cMessageActions.cSendResume)(imcore,options.info,options.text))},window.onLPMessageDisconnect=function(){imcore.disconnect()}}function _onSelectContact(contact){"1"===contact.oppositeUserKind&&LT.ajax({url:LT.Env.cRoot+"user/open-hr-window.json",type:"post",data:{otherId:contact.oppositeUserId},success:function success(data){1===data.flag}})}function initImcore(userInfo){window.ImcacheInfo={jobs:{},resumes:{}};var imcore=new _imcore2["default"]({fillInfo:api.fillInfo,userInfo:userInfo,env:"c",debug:!1,inited:function inited(){$("#header-c-beta2").find('[data-selector="drop-menu-friends"]').show(),$("#header-c-beta2").find('[data-selector="drop-menu-message"]').show(),_reactDom2["default"].render(_react2["default"].createElement(_imui2["default"],{imcore:this,toggleUnRead:function toggleUnRead(unread){_toggleUnRead(unread)},openPanel:function openPanel(callback){return _openPanel(callback)},wrap:document.getElementById("im-root"),onSelectContact:function onSelectContact(contact){return _onSelectContact(contact)},componentDidMounted:function componentDidMounted(props){return _componentDidMounted(props)},msgcard:_MsgCards2["default"]}),document.getElementById("im-root")),(0,_showDialog2["default"])(this.subscribe.bind(this),this.publish.bind(this)),window.onLPMessageReady&&window.onLPMessageReady(),window.onFriendsMessageReady&&window.onFriendsMessageReady()}});window.imcore=imcore}LT.User.isLogin&&"0"===LT.User.user_kind&&(0===$("#im-root").length&&$('<div id="im-root" growing-ignore="true"></div>').appendTo("body"),LT.ajax({url:LT.Env.cRoot+"user/getcurrentuserinfo.json",type:"POST",data:{},cache:!1,dataType:"json",success:function success(_ref2){var userInfo,flag=_ref2.flag,data=_ref2.data;1==flag&&(userInfo={oppositeUserCompany:data.company,oppositeUserKind:data.userKind,oppositeUserName:data.name,oppositeUserPhoto:data.photo,oppositeUserTitle:data.title,chatSetting:data.chatSetting},initImcore(userInfo))}}))}()},,,,,,function(module,exports){(function(__webpack_amd_options__){module.exports=__webpack_amd_options__}).call(exports,{})},,function(module,exports){"use strict";function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){var timeout,len;if(!draining){for(timeout=runTimeout(cleanUpNextTick),draining=!0,len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,queue,draining,currentQueue,queueIndex,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}(),queue=[],draining=!1,queueIndex=-1,process.nextTick=function(fun){var i,args=new Array(arguments.length-1);if(arguments.length>1)for(i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports){module.exports=React},function(module,exports){module.exports=ReactDOM},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass,_imsdk,_imsdk2,_config,_utils,_lpStorage,_lpStorage2,_checkFile,_constants,_receive,_error,_enums,_enums2,ImCore;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_imsdk=__webpack_require__(113),_imsdk2=_interopRequireDefault(_imsdk),_config=__webpack_require__(146),_utils=__webpack_require__(150),_lpStorage=__webpack_require__(154),_lpStorage2=_interopRequireDefault(_lpStorage),_checkFile=__webpack_require__(155),_constants=__webpack_require__(156),_receive=__webpack_require__(161),_error=__webpack_require__(167),_enums=__webpack_require__(162),_enums2=__webpack_require__(116),ImCore=function(){function ImCore(_ref){var random,_ref$env=_ref.env,env=void 0===_ref$env?"c":_ref$env,_ref$userInfo=_ref.userInfo,userInfo=void 0===_ref$userInfo?{}:_ref$userInfo,_ref$debug=_ref.debug,debug=void 0!==_ref$debug&&_ref$debug,_ref$inited=_ref.inited,inited=void 0===_ref$inited?_utils.emptyFn:_ref$inited,_ref$autoLogin=_ref.autoLogin,autoLogin=void 0===_ref$autoLogin||_ref$autoLogin,_ref$fillInfo=_ref.fillInfo,fillInfo=void 0===_ref$fillInfo?_utils.emptyFn:_ref$fillInfo;_classCallCheck(this,ImCore),random=Math.random()*Date.now(),this.pageId=""+random,this.env=env.toLowerCase(),this.userInfo=userInfo,this.onlineStatus=!1,this.debug=debug,this._firstLoaded=!0,this._logs=[],this.debug&&(window.ImDebugArr=this._logs),this.fillInfo=fillInfo,this._timer=null,this.sendMsgContext=null,this._ifAutoLogin=autoLogin,this._inited=inited.bind(this),this._init()}return _createClass(ImCore,[{key:"_init",value:function _init(){var that=this;this._sq=new _utils.Queue,this._rq=new _utils.Queue,this.saveUnread=new _utils.Queue,this.config=(0,_config.setImConfig)(this.env),this._storage=window.lpStorage=new _lpStorage2["default"](this.config.domain,"storage.html"),this.event=new _utils.EventEmitter,this._loginTimer=null,this.subscribe("offline",function(){that.onlineStatus=!1,that.handleVisibleErr("HX_OFFLINE"),that.disconnect()}),this.subscribe("online",function(){that.onlineStatus=!0,that.handleVisibleErr("HX_ONLINE"),LT.Cookie.get(_enums2.Cookie.WEBIM_CONNECT)&&LT.Cookie.get(_enums2.Cookie.WEBIM_PAGEID)==window.name&&that.refreshMsg(!0)}),this.cacheInfo={jobs:{},resumes:{},cardsToResumes:{}},this._conn=new _imsdk2["default"].connection({env:that.env,callback:function callback(data){that.onlineStatus=!0,Object.assign(that.userInfo,{oppositeImId:data.imId,oppositeUserId:data.userId,oppositeImUserType:that.imUserType,imClientId:data.imClientId}),data.noFuc||that._inited&&that._inited()},connectOpts:{onOpened:function onOpened(message){that.handleLog("IM login success."),that.event.trigger("login")},onClosed:function onClosed(message){that.handleLog("IM closed"),that.event.trigger("logout")},onTextMessage:function onTextMessage(message){that.handleLog("textmessage:",message.payload),that.receive(message,"Text")},onSyncReaded:function onSyncReaded(toImId){that.event.trigger(_constants.MsgEvent.UPDATE_READED_MSG,[toImId])},onEmojiMessage:function onEmojiMessage(message){that.handleLog("textmessage:",message),that.receive(message,"Emoji")},onPictureMessage:function onPictureMessage(message){that.handleLog("textmessage:",message),that.receive(message,"Picture")},onBreakMessge:function onBreakMessge(message){},onCmdMessage:function onCmdMessage(message){},onAudioMessage:function onAudioMessage(message){that.handleLog("textmessage:",message),that.receive(message,"Audio")},onLocationMessage:function onLocationMessage(message){},onFileMessage:function onFileMessage(message){},onVideoMessage:function onVideoMessage(message){},onPresence:function onPresence(message){},onRoster:function onRoster(message){},onInviteMessage:function onInviteMessage(message){},onOnline:function onOnline(){that.onlineStatus=!0,that.handleLog("本机网络连接成功"),that.publish("online"),that.onlineTimer&&clearTimeout(that.onlineTimer),that.onlineTimer=setTimeout(function(){that.isLogined()||that.login()},_constants.FOCUS_TO_LOGIN_TIMEOUT)},onOffline:function onOffline(){that.onlineStatus=!1,that.handleLog("本机网络掉线"),that.publish("offline"),that.sendMsgContext&&that._updateSendMsgState(that.sendMsgContext,_enums.MsgState.SEND_FAILED,_constants.ErrorType.HX_OFFLINE)},onError:function onError(message){return message&&2==message.type?void that.handleErr("LOGIN_FAILED  type="+message.type):void that.handleErr("HX_ONERROR type="+message.type)},onReconnect:function onReconnect(){that.refreshMsg()},onBlacklistUpdate:function onBlacklistUpdate(list){}}}),this._ifAutoLogin&&this._autoLogin(),window.addEventListener("unhandledrejection",function(event){that.handleLog("unhandledrejection",event)}),window.addEventListener("onrejectionhandled",function(event){that.handleLog("onrejectionhandled",event)})}},{key:"_autoLogin",value:function _autoLogin(){var that=this;this._firstLoaded&&!this.isLogined()&&(that.login(),that._firstLoaded=!1)}},{key:"_hxSend",value:function _hxSend(msg,sendErr){var that=this;this._conn.send(msg,function(_ref2){var msg=_ref2.msg,code=_ref2.code;sendErr({msg:msg,code:code}),clearTimeout(that.msgSendTimer)})}},{key:"_getUserInfo",value:function _getUserInfo(){return(0,_utils.pajax)({url:this.config.ajaxUrl.getcurrentuserinfo})}},{key:"_getSignatureForMsg",value:function _getSignatureForMsg(message){return(0,_utils.pajax)({url:this.config.ajaxUrl.handlesend,data:{oppositeImId:message.getTo(),extType:message.getExtType(),msgContent:message.getValue(),ext:message.getParamForSign()},type:"POST"})}},{key:"_getLocalAllMsg",value:function(){function _getLocalAllMsg(){return _ref3.apply(this,arguments)}var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var LSKey,data;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,LSKey=(0,_constants.getLocalStorageKey)(this.userInfo.oppositeImId),_context.next=4,this.getLocalDataPromise(LSKey.ALL_MSG_KEY);case 4:return data=_context.sent,_context.abrupt("return",data||{});case 8:throw _context.prev=8,_context.t0=_context["catch"](0),this.handleErr(_context.t0),_context.t0;case 12:case"end":return _context.stop()}},_callee,this,[[0,8]])}));return _getLocalAllMsg}()},{key:"_addMsgToStorage",value:function(){function _addMsgToStorage(_x,_x2){return _ref4.apply(this,arguments)}var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(uid,msg){var LSKey,allMsg,msgArr;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,LSKey=(0,_constants.getLocalStorageKey)(this.userInfo.oppositeImId),_context2.next=4,this._getLocalAllMsg();case 4:return allMsg=_context2.sent,msgArr=allMsg[uid]||[],msgArr.every(function(m){return m.id!==msg.id})&&msgArr.push(msg),allMsg[uid]=msgArr.slice(Math.max(msgArr.length-_constants.MAX_STORAGE_MSG_PER_USER,0)),_context2.next=10,this.setLocalDataPromise(LSKey.ALL_MSG_KEY,allMsg);case 10:_context2.next=16;break;case 12:throw _context2.prev=12,_context2.t0=_context2["catch"](0),this.handleErr(_context2.t0),_context2.t0;case 16:case"end":return _context2.stop()}},_callee2,this,[[0,12]])}));return _addMsgToStorage}()},{key:"_updateMsgToStorage",value:function(){function _updateMsgToStorage(_x3,_x4){return _ref5.apply(this,arguments)}var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(uid,msg){var LSKey,allMsg,msgArr;return regeneratorRuntime.wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.prev=0,LSKey=(0,_constants.getLocalStorageKey)(this.userInfo.oppositeImId),_context3.next=4,this._getLocalAllMsg();case 4:return allMsg=_context3.sent,msgArr=allMsg[uid]||[],msgArr.forEach(function(m){m.id===msg.id&&Object.assign(m,msg)}),allMsg[uid]=msgArr,_context3.next=10,this.setLocalDataPromise(LSKey.ALL_MSG_KEY,allMsg);case 10:_context3.next=16;break;case 12:throw _context3.prev=12,_context3.t0=_context3["catch"](0),this.handleErr(_context3.t0),_context3.t0;case 16:case"end":return _context3.stop()}},_callee3,this,[[0,12]])}));return _updateMsgToStorage}()},{key:"_sendMsg",value:function(){function _sendMsg(_x5,_x6,_x7,_x8,_x9){return _ref6.apply(this,arguments)}var _ref6=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(message,sendSucc,sendFail,sendErr,isResendMsg){var _this=this;return regeneratorRuntime.wrap(function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.prev=0,_context5.delegateYield(regeneratorRuntime.mark(function _callee4(){var that,msgToStore;return regeneratorRuntime.wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return that=_this,msgToStore=message.getStorageBody(),_context4.next=4,_this._addMsgToStorage(message.getTo(),msgToStore);case 4:if(_this.sendMsgContext=message,_this.onlineStatus){_context4.next=10;break}throw"img"!==message.getType()&&_this.event.trigger(_constants.MsgEvent.SEND_MSG,[message]),message.isClick=!1,_this._updateSendMsgState(message,_enums.MsgState.PREPROCESS_FAILED,_constants.ErrorType.HX_OFFLINE),new Error(_constants.ErrorType.HX_OFFLINE);case 10:if(_this.event.trigger(_constants.MsgEvent.SEND_MSG,[message]),"img"!==message.getType()||isResendMsg){_context4.next=16;break}return _this.handleLog("going to upload picture->"),_context4.next=15,_this._uploadFile(message);case 15:message=_context4.sent;case 16:message.onSuccess(function(id,serverMsgId){_this.sendMsgContext=null,_this.event.trigger(_constants.MsgEvent.UPDATE_LIST_MSG,[message]),that._updateSendMsgState(message,_enums.MsgState.SEND_SUCCESS,"",serverMsgId),_this.handleLog("_addMsgToStorage->",message.getStorageBody()),that._addMsgToStorage(message.getTo(),message.getStorageBody()),sendSucc&&sendSucc()}),message.onFail(function(err,code){_this.sendMsgContext=null,that.handleLog("hx send failed"),clearTimeout(that.msgSendTimer),that._updateSendMsgState(message,_enums.MsgState.SEND_FAILED,err),sendFail&&sendFail(err)}),_this.handleLog("hx message send->",message.getBody()),_this._hxSend(message.getBody(),sendErr);case 20:case"end":return _context4.stop()}},_callee4,_this)})(),"t0",2);case 2:_context5.next=10;break;case 4:_context5.prev=4,_context5.t1=_context5["catch"](0),this.sendMsgContext=null,"img"!==message.type&&(message.isClick=!1,this._updateSendMsgState(message,_enums.MsgState.PREPROCESS_FAILED,_context5.t1.message||_constants.ErrorType.NETWORK_ONERROR)),sendFail&&sendFail(_constants.ErrorType.NETWORK_ONERROR),this.handleErr(_context5.t1);case 10:case"end":return _context5.stop()}},_callee5,this,[[0,4]])}));return _sendMsg}()},{key:"_receiveMsgHandle",value:function(){function _receiveMsgHandle(_x10){return _ref7.apply(this,arguments)}var _ref7=_asyncToGenerator(regeneratorRuntime.mark(function _callee6(message){var from,to;return regeneratorRuntime.wrap(function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,message.fillInfo(imcore);case 2:return message=_context6.sent,this.event.trigger(_constants.MsgEvent.RECEIVE_MSG,[message]),this.handleLog("_addMsgToStorage->",message.getBody()),from=message.getFrom(),to=message.getTo(),_context6.next=9,this._addMsgToStorage(from===this.userInfo.oppositeImId?to:from,message.getBody());case 9:case"end":return _context6.stop()}},_callee6,this)}));return _receiveMsgHandle}()},{key:"_receiveMsg",value:function(){function _receiveMsg(_x11){return _ref8.apply(this,arguments)}var _ref8=_asyncToGenerator(regeneratorRuntime.mark(function _callee7(message){return regeneratorRuntime.wrap(function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:try{this.handleLog("_receiveMsg->"),this.userInfo.oppositeImId===message.getFrom()?this._receiveMsgHandle(message):this._receiveMsgHandle(message)}catch(e){this.handleErr(e)}case 1:case"end":return _context7.stop()}},_callee7,this)}));return _receiveMsg}()},{key:"_updateSendMsgState",value:function _updateSendMsgState(message,state,err,serverId){message.setState(state,err),message.status=!1,serverId&&message.setServerId(serverId),this.event.trigger(_constants.MsgEvent.UPDATE_MSG,[message.getStorageBody()])}},{key:"updateSendMsg",value:function updateSendMsg(newmessage){this.event.trigger(_constants.MsgEvent.UPDATE_MSG,[newmessage.getStorageBody()])}},{key:"updateReceiveMsg",value:function updateReceiveMsg(newmessage){this.event.trigger(_constants.MsgEvent.UPDATE_MSG,[newmessage])}},{key:"_uploadFile",value:function _uploadFile(message){var _this2=this,that=this;return new Promise(function(resolve,reject){var onFileUploadError=function onFileUploadError(err){return that._updateSendMsgState(message,_enums.MsgState.SEND_FAILED,err),message.onFileUploadError&&message.onFileUploadError(err),_this2.handleVisibleErr("UPLOAD_FILE_ERROR"),reject(err),!1},onFileUploadComplete=function onFileUploadComplete(data){var msg,url,$img;message.onFileUploadComplete&&message.onFileUploadComplete(data),msg=message.getBody(),url=data.originalUrl,$img=$('<img src="'+url+'" style="position: fixed;visibility:hidden;top:-9999px;left:-9999px">').appendTo("body"),$img.on("load",function(){var $this=$(this);msg.body={type:message.type,url:url,filename:message.filename,size:{width:$this.width()||0,height:$this.height()||0},length:data.fileLength||0,file_length:data.fileLength||0,filetype:msg.filetype,thumbUrl:data.thumbUrl},message.value=url,msg.url=url,$img.remove(),resolve(message)}),$img.on("error",function(error){$(this).remove(),reject(error)})},onFileAppend=function onFileAppend(){message.onFileAppend()},uploadObj=Object.assign({onFileUploadError:onFileUploadError,onFileUploadComplete:onFileUploadComplete,onFileAppend:onFileAppend},message.getBody(),{inputElm:message.fileInputId});_imsdk2["default"].utils.uploadFile.call(_this2._conn,uploadObj)})}},{key:"getLocalData",value:function getLocalData(key,callback){this._storage.get(key,callback)}},{key:"setLocalData",value:function setLocalData(key,value,callback){this._storage.set(key,value,callback)}},{key:"getLocalDataPromise",value:function getLocalDataPromise(key){var _this3=this;return new Promise(function(resolve,reject){_this3._storage.get(key,function(value){resolve(value)})})}},{key:"setLocalDataPromise",value:function setLocalDataPromise(key,value){var _this4=this;return new Promise(function(resolve,reject){_this4._storage.set(key,value,function(){resolve()})})}},{key:"handleVisibleErr",value:function handleVisibleErr(type){var moreInfo=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",desc=_constants.ErrorType[type]||"";this.handleErr({message:desc+moreInfo})}},{key:"handleErr",value:function handleErr(err){this._logs.push({time:Date.now(),type:"error",msg:err.message}),this.debug&&console.error(err)}},{key:"handleLog",value:function handleLog(msg){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._logs.push({time:Date.now(),type:"log",msg:msg,data:data}),this.debug&&console.info(msg)}},{key:"publish",value:function publish(key,value,callback){this._storage.publish(key,value,callback)}},{key:"subscribe",value:function subscribe(key,func){return this._storage.subscribe(key,func)}},{key:"login",value:function login(callback,errcallback){var that=this,timeouted=!1;clearTimeout(this._loginTimer),"function"==typeof callback&&"function"==typeof errcallback&&(this._loginTimer=setTimeout(function(){timeouted=!0,errcallback()},_constants.HX_LOGIN_TIMEOUT),this.event.once("login",function(){clearTimeout(that._loginTimer),!timeouted&&callback()}),this.event.once("loginfailed",function(){clearTimeout(that._loginTimer),!timeouted&&errcallback()})),this._conn.init()}},{key:"loginPromise",value:function loginPromise(){var _this5=this,that=this;return new Promise(function(resolve,reject){_this5.login(function(){resolve()},function(){reject("IM login failed")})})}},{key:"isLogined",value:function isLogined(){return this._conn.isOpened()}},{key:"send",value:function send(msg,sendSucc,sendFail,sendErr,isResendMsg){var _this6=this;this.handleLog("imcore.send->",arguments),this._sq.push(function(){return _this6._sendMsg(msg,sendSucc,sendFail,sendErr,isResendMsg)})}},{key:"resend",value:function resend(msg,sendSucc,sendFail,sendErr,isResendMsg){this.send(msg.reset(),sendSucc,sendFail,sendErr,isResendMsg)}},{key:"receive",value:function receive(message,receiveType){var msg,_this7=this;this.handleLog("imcore.receive->",arguments),msg=(0,_receive.createReceiveMsg)(message,receiveType),this._rq.push(function(){return _this7._receiveMsg(msg)})}},{key:"getTargetLocalHistory",value:function(){function getTargetLocalHistory(_x14){return _ref9.apply(this,arguments)}var _ref9=_asyncToGenerator(regeneratorRuntime.mark(function _callee8(oppositeImId){var allMsg;return regeneratorRuntime.wrap(function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,this._getLocalAllMsg();case 2:return allMsg=_context8.sent,_context8.abrupt("return",allMsg[oppositeImId]||[]);case 4:case"end":return _context8.stop()}},_callee8,this)}));return getTargetLocalHistory}()},{key:"unReadMsg",value:function unReadMsg(callback,refreshMsg){this._conn.unSign(callback,refreshMsg)}},{key:"disconnect",value:function disconnect(){this._conn.disconnect()}},{key:"refreshMsg",value:function refreshMsg(hasConnect){this.event.trigger(_constants.MsgEvent.CONN_MSG,[hasConnect])}}]),ImCore}(),exports["default"]=ImCore},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function Connection(options){switch(this.options=options||{},this.listen(options.connectOpts),this.listenNetwork(this.onOnline,this.onOffline),this.isOpenState=!1,this._storage=window.lpStorage,this.pageId="webim_pageid_"+Math.random()*Date.now(),this.beExited=!1,this.linkTime=0,this.accountQuit=!1,this.reConnectTime=0,this.options.env){case"c":this.imUserType="0";break;case"h":this.imUserType="2";break;case"b":this.imUserType="3"}var that=this;this.socket=new _socket2["default"]({imApp:"1",config:{url:"https://im.liepin.com/conf.json",params:{imApp:"1"},cookie:"WebIMConf"},token:{url:"https://im.liepin.com/token.json",params:{imUserType:that.imUserType,deviceType:"0",imApp:"1"},cookie:"WebIMToken"},reconnectTimeList:[1,5,10,30,60,300]}),this.onbeforeunload()}var _typeof,_socket,_socket2,_enums,_Dialog,_Dialog2,ajaxIM;Object.defineProperty(exports,"__esModule",{value:!0}),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_socket=__webpack_require__(114),_socket2=_interopRequireDefault(_socket),_enums=__webpack_require__(116),__webpack_require__(118),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog),ajaxIM=function ajaxIM(options){return new Promise(function(resolve,reject){options.url||reject(new Error("url is necessary!")),LT.ajax(Object.assign(options,{success:function success(data){resolve(data)},error:function error(err){reject(err)},timeout:15e3}))})},window.WebIM={},WebIM.connection=Connection,WebIM.utils={},window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,WebIM.utils.getFileUrl=function(fileInputId){var fileItems,u,path,index,uri={url:"",filename:"",filetype:"",data:""},fileObj="string"==typeof fileInputId?document.getElementById(fileInputId):fileInputId;return fileObj?(window.URL&&window.URL.createObjectURL?(fileItems=fileObj.files||fileObj.file,fileItems.length>0&&(u=fileItems.item(0),uri.data=u,uri.url=window.URL.createObjectURL(u),uri.filename=u.name||"")):(fileInputId.select(),fileInputId.blur(),path=document.selection.createRange().text,uri.url=path,uri.filename=path,uri.data={},uri.data.size=0),index=uri.filename.lastIndexOf("."),index!=-1&&(uri.filetype=uri.filename.substring(index+1).toLowerCase()),uri):uri},WebIM.utils.uploadFile=function(uploadObj){$.ajaxFileUpload({url:"https://im.liepin.com/upload/",secureuri:!1,fileElementId:uploadObj.inputElm.id,dataType:"json",data:{type:"img",imApp:"1"},onAppend:function onAppend(){uploadObj.onFileAppend()},success:function success(data,status){1===data.flag?uploadObj.onFileUploadComplete(data.data):(_Dialog2["default"].alert({parent:"chat",width:300,text:data.msg}),uploadObj.onFileUploadError(data))},error:function error(data,status,e){uploadObj.onFileUploadError(data)}})},Connection.prototype.onbeforeunload=function(){var that=this,timer=void 0;return window.onbeforeunload=function(){window.name.indexOf("webim_pageid")>-1&&LT.Cookie.get(_enums.Cookie.WEBIM_PAGEID)==window.name&&LT.Cookie.del(_enums.Cookie.WEBIM_CONNECT,"/; domain=.liepin.com")},window.addEventListener("focus",function(){timer&&clearTimeout(timer),timer=setTimeout(function(){LT.Cookie.get(_enums.Cookie.WEBIM_CONNECT)||that.init()},1e4)},!1),this},Connection.prototype.init=function(){var that=this;return this.socket.on("connect_lost",function(err){LT.Cookie.del(_enums.Cookie.WEBIM_CONNECT,"/; domain=.liepin.com"),that.count++,this.onClosed(err),this.isOpenState=!1}),this.socket.on("connect_error",function(err){this.isOpenState=!1,LT.Cookie.del(_enums.Cookie.WEBIM_CONNECT,"/; domain=.liepin.com"),that.reConnectTime<2&&(that.reConnectTime++,that.open())}),this.socket.on("error",function(err){"300330003"===err.code&&_Dialog2["default"].alert({parent:"chat",width:300,content:""+err.msg,onOk:function onOk(){window.tlog=window.tlog||[],window.tlog.push("c:C000011125"),window.location.href="https://passport.liepin.com/logout"}}),that.userQuit(err.code||"")}),this.socket.getToken(function(data){that.options.callback&&that.options.callback(Object.assign({},data,{imUserType:that.imUserType,noFuc:that.linkTime>0})),that.linkTime++,that.imClientId=data.imClientId,that.accessToken=data.accessToken,that.imId=data.imId,that.userId=data.userId,that.isOpenState=1==LT.Cookie.get(_enums.Cookie.WEBIM_CONNECT),LT.Cookie.get(_enums.Cookie.WEBIM_CONNECT)||that.open()}),this},Connection.prototype.open=function(callback){var that=this;this.socket.connect(function(){window.name=that.pageId,LT.Cookie.set(_enums.Cookie.WEBIM_PAGEID,window.name,30,"/; domain=.liepin.com"),LT.Cookie.set(_enums.Cookie.WEBIM_CONNECT,1,1,"/; domain=.liepin.com"),that.socket.on(that.imId,function(msg){that.receive(msg)}),callback&&callback(),that.onOpened(),that.isOpenState=!0,that.onReconnect(),that.beExited=!1,that.socket.getConfig(function(data){that.heartBeat(data.heartbeatInterval)})})},Connection.prototype.listen=function(opt){var that=this;return this.onClosed=function(message){opt.onClosed()},this.onTextMessage=function(message){opt.onTextMessage(message)},this.onSyncReaded=function(toImId){opt.onSyncReaded(toImId)},this.onReconnect=function(){opt.onReconnect()},this.onPictureMessage=function(message){opt.onPictureMessage(message)},this.onAudioMessage=function(message){opt.onAudioMessage(message)},this.onBreakMessge=function(message){opt.onBreakMessge(message)},this.onOpened=function(message){opt.onOpened(message)},this.onOnline=function(message){opt.onOnline(message)},this.onOffline=function(message){opt.onOffline(message)},this.onError=function(message){opt.onError(message)},this},Connection.prototype.send=function(opt,callback){var that=this;that.isOpenState&&window.name?that._sendMsg(opt,callback):that.open(function(){that._sendMsg(opt,callback)})},Connection.prototype._sendMsg=function(opt,callback){var opts,url,that=this,bodies=null;"txt"==opt.type&&(bodies={bodies:[{msg:opt.msg,type:opt.type}]}),"img"==opt.type&&(bodies={bodies:[{file_length:opt.body.file_length,filename:opt.body.filename,size:{height:opt.body.size.height,width:opt.body.size.width
},type:opt.type,thumb:opt.body.thumbUrl,url:opt.url}]}),opts=Object.assign({},opt,bodies),url=window.WebSocket&&window.WebSocket.prototype.send?"https://im.liepin.com/send.json":"https://im.liepin.com/send2.json",LT.ajax({url:url,type:"POST",data:{imClientId:that.imClientId,imId:that.imId,imUserType:that.imUserType,oppositeImId:opts.to,oppositeImUserType:opts.totype,msgTime:opts.timestamp,chatType:"0",payload:JSON.stringify({ext:opts.ext,bodies:opts.bodies}),imApp:"1",msgType:opt.type},cache:!1,dataType:"json",success:function success(data){if(1==data.flag)if(opt.success(opt.id,data.data.msgId),that.isOpenState){var message={action:"send",messageToken:data.data.msgToken};that.socket.emit(opts.to,message)}else that.open(function(){var message={action:"send",messageToken:data.data.msgToken};that.socket.emit(opts.to,message)});else opt.fail(data.msg,data.code),callback({msg:data.msg||"",code:data.code||""})}})},Connection.prototype.receive=function(message){var that=this,payload=message.action?message:JSON.parse(message.payloadString);switch(payload.action){case"beExited":window.name&&(window.name=""),that.beExited=!0,LT.Cookie.del(_enums.Cookie.WEBIM_CONNECT,"/; domain=.liepin.com"),that.onBreakMessge(payload.action),that.heartTimer&&clearTimeout(that.heartTimer),that.disconnect();break;case"receive":LT.ajax({url:"https://im.liepin.com/receive.json",type:"POST",data:{imId:that.imId,imApp:"1",msgToken:payload.messageToken},cache:!1,dataType:"json",success:function success(data){1==data.flag?LT.ajax({url:"https://im.liepin.com/signed.json",type:"POST",data:{imClientId:that.imClientId,imId:that.imId,msgToken:payload.messageToken,imApp:"1"},cache:!1,dataType:"json",success:function success(signData){if(1==signData.flag)switch(data.data.msgType){case"txt":that.onTextMessage(data.data);break;case"img":that.onPictureMessage(data.data);break;default:that.onAudioMessage(data.data)}}}):that.userQuit(data.code||"")}});break;case"readed":that.onSyncReaded(payload.toImId)}},Connection.prototype.listenNetwork=function(onlineCallback,offlineCallback){window.addEventListener?(window.addEventListener("online",onlineCallback),window.addEventListener("offline",offlineCallback)):window.attachEvent&&(document.body?(document.body.attachEvent("ononline",onlineCallback),document.body.attachEvent("onoffline",offlineCallback)):window.attachEvent("load",function(){document.body.attachEvent("ononline",onlineCallback),document.body.attachEvent("onoffline",offlineCallback)}))},Connection.prototype.isOpened=function(){return this.isOpenState},Connection.prototype.disconnect=function(){var that=this;LT.Cookie.del(_enums.Cookie.WEBIM_CONNECT,"/; domain=.liepin.com"),!that.isOpenState||window.name?that.open(function(){that.socket.disconnect()}):(that.isOpenState=!1,that.socket.disconnect()),window.name=""},Connection.prototype.reConnect=function(){LT.Cookie.get(_enums.Cookie.WEBIM_CONNECT)||that.open()},Connection.prototype.unSign=function(callback){function getUnreadContent(){LT.ajax({url:"https://im.liepin.com/unsign.json",type:"POST",data:{imUserType:that.imUserType,imClientId:that.imClientId,imApp:"1"},cache:!1,dataType:"json",success:function success(_ref){var _ret,data=_ref.data,flag=_ref.flag,msg=_ref.msg,code=_ref.code;if(flag){if(_ret=function(){var unReadCounts=0,messages=[],readflag=!0;return data.unsignMessages&&data.unsignMessages.forEach(function(v){unReadCounts+=parseInt(v.signCnt),v.messages&&v.messages.forEach(function(item){var msgPayload=item.payload&&JSON.parse(item.payload),isAudio=msgPayload&&msgPayload.bodies&&msgPayload.bodies[0].type;switch("0"===item.readflag&&(readflag=!1,messages.push(v.messages)),item.msgType){case"txt":that.onTextMessage(item);break;case"img":that.onPictureMessage(item);break;case"audio":that.onAudioMessage(item)}})}),{v:callback&&callback({unReadCounts:unReadCounts,messages:messages,readFlag:readflag})}}(),"object"===("undefined"==typeof _ret?"undefined":_typeof(_ret)))return _ret.v}else that.userQuit(code||"")}})}var that=this;that.imClientId?getUnreadContent():this.socket.getToken(function(data){that.imClientId=data.imClientId,that.accessToken=data.accessToken,that.imId=data.imId,that.userId=data.userId,getUnreadContent()})},Connection.prototype.heartBeat=function(heartbeatInterval){function heartBeatFn(){if(!that.beExited&&!that.accountQuit){switch(that.count){case 0:time=1e3*Number(heartbeatInterval);break;case 1:time=5e3;break;case 2:time=1e4;break;case 3:time=3e4;break;case 4:time=6e4;break;default:time=3e5}that.heartTimer&&clearTimeout(that.heartTimer),that.heartTimer=setTimeout(function(){LT.Cookie.get(_enums.Cookie.WEBIM_CONNECT)?(that.count=0,console.log("有长连接，只是建立心跳")):that.open(),heartBeatFn()},time)}}var that=this,heartTimer=null,time=that.heartbeatInterval;that.count=0,heartBeatFn()},Connection.prototype.userQuit=function(code){var that=this;"300330003"===code&&that.isOpenState&&(that.disconnect(),that.accountQuit=!0)},exports["default"]=WebIM},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass,_mqttws,_mqttws2,Socket;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_mqttws=__webpack_require__(115),_mqttws2=_interopRequireDefault(_mqttws),Socket=function(){function Socket(options){_classCallCheck(this,Socket),this.options=options||{},this.reConnectCount=0,this.reconnectTimeList=this.options.reconnectTimeList||[1,5,10,30,60,300],this.tokenCookie=options.token.cookie||"",this.confCookie=options.config.cookie||"",this.storage=window.lpStorage,this.events={getConfig:1,getToken:1,connect:1,connect_error:1,connect_lost:1,disconnect:1,reconnect:1,reconnect_failed:1,error:1,sendSuccess:1},this.onEventList={},this.SubscribeList={},this.emitList={},this._tools(),this.transports()}return _createClass(Socket,[{key:"_tools",value:function _tools(){Object.keys=Object.keys||function(obj){var key,i,result=[];for(key in obj)hasOwn.call(obj,key)&&result.push(key);if(DONT_ENUM&&obj)for(i=0;key=DONT_ENUM[i++];)hasOwn.call(obj,key)&&result.push(key);return result}}},{key:"transports",value:function transports(){return this.websocket=!(!window.WebSocket||!window.WebSocket.prototype.send),this.websocket}},{key:"connect",value:function connect(_connectSuccess){var that=this;this.options.beforeConnect&&this.options.beforeConnect(),that.getConfig(function(data){that.getToken(function(){that.websocket?that.link(_connectSuccess):that.polling(_connectSuccess)})})}},{key:"getConfig",value:function getConfig(callback){var that=this;try{!function(){var getConf=function getConf(config){Object.keys(config).forEach(function(v){that[v]=config[v]}),that.emitAll("getConfig",config),callback&&callback(config)},now=(new Date).getTime();that.storage.get(that.confCookie,function(conf){conf&&now-conf.time<conf.configTimeout?getConf(conf):LT.ajax({url:that.options.config.url,type:"POST",data:that.options.config.params,cache:!1,dataType:"json",success:function success(data){if(1==data.flag){var _conf={imAddress:data.data.imWssAddress,pollingInterval:data.data.pollingInterval,configTimeout:data.data.configTimeout,heartbeatInterval:data.data.heartbeatInterval,time:(new Date).getTime()};getConf(data.data),that.confCookie&&that.storage.set(that.confCookie,_conf)}else that.error(data)}})})}()}catch(err){}}},{key:"getToken",value:function getToken(fn){var that=this,token=function token(data){that.imClientId=data.imClientId,that.accessToken=data.accessToken,that.imId=data.imId,that.emitAll("getToken",data),fn&&fn(data)},now=(new Date).getTime();that.storage.get(that.tokenCookie,function(tok){tok&&now-tok.time<=6e5?token(tok):LT.ajax({url:that.options.token.url,type:"POST",data:that.options.token.params,cache:!1,dataType:"json",success:function success(data){if(1==data.flag){var _token={imClientId:data.data.imClientId,accessToken:data.data.accessToken,imId:data.data.imId,userId:data.data.userId,imUserType:that.options.token.params.imUserType,time:(new Date).getTime()};that.imClientId=data.imClientId,that.accessToken=data.accessToken,that.imId=data.imId,that.tokenCookie&&that.storage.set(that.tokenCookie,_token),token(data.data)}else that.error(data)}})})}},{key:"error",value:function error(err){this.emitAll("error",err)}},{key:"link",value:function link(connectFn){var willMessage,options,_this=this,that=this,imAddress=this.imAddress||this.imWssAddress,Client=new _mqttws2["default"].MQTT.Client(imAddress.split(":")[0],Number(imAddress.split(":")[1]),that.imClientId);that.Client=Client,Client.onConnectionLost=function(err){console.log("lost",err),that.readyState="closed",that.reconnecting=!1,that.reconnect_attempt&&(reConnectCount++,that.reconnect()),_this.emitAll("connect_lost",err)},Client.onMessageArrived=function(message){that._receive(message)},Client.onMessageDelivered=function(msg){var events=msg.destinationName;that.emitAll("sendSuccess",msg)},willMessage=new _mqttws2["default"].MQTT.Message(that.imId),willMessage.destinationName="1",that.reconnecting=!0,options={onSuccess:function onSuccess(){console.log("connect success"),that.readyState="open",that.reconnecting=!1,that.reconnect_attempt=!1,connectFn&&connectFn(that),that.emitAll("connect"),that.options.complete&&that.options.complete()},onFailure:function onFailure(err){console.log("connect fail",err),that.tokenCookie&&that.storage.set(that.tokenCookie,""),that.readyState="closed",that.reconnecting=!1,that.reconnect_attempt?(reConnectCount++,that.reconnect()):that.emitAll("connect_error",err),that.options.complete&&that.options.complete(msg)},userName:that.accessToken,mqttVersion:4,cleanSession:!0,useSSL:!0,keepAliveInterval:that.heartbeatInterval,willMessage:willMessage},Client.connect(options)}},{key:"emitAll",value:function emitAll(){var fns,args,fn;try{if(fns=this.emitList[arguments[0]]||this.onEventList[arguments[0]]||this.SubscribeList[arguments[0]],void 0!==fns){args=arguments[1]||"";for(fn in fns)fns[fn](args)}}catch(e){}}},{key:"on",value:function on(evt,options){if(this.events.hasOwnProperty(evt)){if(this.onEventList[evt]||(this.onEventList[evt]=[]),options){var nameEvt=evt.split(".")[1];nameEvt?this.onEventList[evt][nameEvt]=[options]:this.onEventList[evt]=[options]}}else this.SubscribeList[evt]||(this.SubscribeList[evt]=[]),this.SubscribeList[evt]=[options],this.websocket&&this.Client&&"open"==this.readyState&&this.Client.subscribe(evt,{qos:0})}},{key:"emit",value:function emit(evt,message,fn){var sendMsg,that=this;try{sendMsg=void 0,evt&&this.Client&&this.websocket&&(1==arguments.length?(sendMsg=new _mqttws2["default"].MQTT.Message(JSON.stringify("")),sendMsg.destinationName=evt):2==arguments.length?("function"==typeof message?(sendMsg=new _mqttws2["default"].MQTT.Message(JSON.stringify("")),sendMsg.destinationName=evt):(sendMsg=new _mqttws2["default"].MQTT.Message(JSON.stringify(message)),sendMsg.destinationName=evt),this._send(sendMsg,message)):(sendMsg=new _mqttws2["default"].MQTT.Message(JSON.stringify(message)),sendMsg.destinationName=evt,this._send(sendMsg,fn)))}catch(err){}}},{key:"send",value:function send(){try{this.options.beforeSend&&this.options.beforeSend(),this._send(arguments)}catch(err){}}},{key:"off",value:function off(ev,fn){try{if("string"!=typeof ev)return;this.onEventList.hasOwnProperty(ev)?this.onEventList[ev]=[]:this.SubscribeList.hasOwnProperty(ev)&&(this.SubscribeList[ev]=[],that.Client.unsubscribe(ev)),fn&&fn()}catch(err){}}},{key:"_send",value:function _send(msg,fn){fn&&"function"==typeof fn&&(this.emitList.hasOwnProperty(msg.destinationName)&&(this.emitList[msg.destinationName]=[]),this.emitList[msg.destinationName].push(fn)),this.Client.send(msg)}},{key:"_receive",value:function _receive(msg){var that=this,payload=msg.action||JSON.parse(msg.payloadString);switch(payload.action){case"configChanged":that.confCookie&&that.storage.set(that.confCookie,""),that.connect();break;case"reconnect":that.reconnect();break;default:that.emitAll(msg.destinationName||that.imId,msg)}}},{key:"disconnect",value:function disconnect(){var that=this;this.confCookie&&this.storage.set(this.confCookie,""),this.tokenCookie&&this.storage.set(this.tokenCookie,""),this.websocket?this.Client?this.Client.disconnect():this.connect(function(){this.Client&&this.Client.disconnect()}):that.pollingAjax.abort(),this.emitAll("disconnect"),this.readyState="closed"}},{key:"reconnect",value:function reconnect(){var circulation,timer,that=this,reCount=that.retryCount||5;try{circulation=_circultaion(),this.reconnect_attempt=!0,that.websocket?that.Client?"closed"===that.readyState?(timer=void 0,that.reConnectCount<=reCount?that.reconnecting||(timer=setTimeout(function(){that.reConnectCount++,that.link(function(){this.emitAll("reconnect")})},1e3*circulation)):(clearTimeout(timer),that.reconnecting=!1,that.reconnect_attempt=!1,that.emit("reconnect_failed"))):this.emitAll("reconnect"):that.connect():that.polling()}catch(err){}}},{key:"polling",value:function polling(callback){var that=this;this.reconnecting=!0,callback&&callback(),console.log("polling start"),that.storage.get(that.tokenCookie,function(tokens){"open"!==that.readyState&&(that.readyState="open",that.pollingAjax=$.ajax({url:"https://"+that.longPollAddress+"?imApp="+that.options.imApp+"&imId="+that.imId+"&imClientId="+that.imClientId+"&accessToken="+tokens.accessToken+"&_t="+(new Date).getTime(),type:"get",dataType:"jsonp",cache:!1,crossDomain:!0,jsonp:"callback",jsonpCallback:"handlerCallback",success:function success(data){if(that.reconnecting=!1,that.readyState="closed",1==data.flag)that.polling(),that._receive(data.data);else{switch(data.code||"null",data.code||"null"){case 1:that.polling();case"4015":case"4016":case"4022":that.tokenCookie&&that.storage.set(that.tokenCookie,""),that.getToken(function(data){that.polling()});break;case"beExtist":break;default:that.emitAll("connect_error",data)}that.reconnect_attempt&&(reConnectCount++,that.reconnect())}},error:function error(XMLHttpRequest,textStatus,errorThrown){that.readyState="closed",that.reconnecting=!1,that.reconnect_attempt&&(reConnectCount++,that.reconnect()),that.emitAll("connect_lost",errorThrown)}}),that.unSign())})}},{key:"_circultaion",value:function _circultaion(){var circulation,i,len,last,_i;try{if(circulation=void 0,"[object Array]"!==Object.prototype.toString.call(that.reconnectTimeList)){if(Number(that.reconnectTimeList))for(circulation=[],i=0;i<that.retryCount;i++)circulation.push(Number(that.reconnectTimeList))}else if(len=that.reconnectTimeList.length,last=that.reconnectTimeList[that.reconnectTimeList.length-1],circulation=that.reconnectTimeList,len<that.retryCount)for(_i=0;_i<c-len;_i++)circulation.push(last);else circulation=that.reconnectTimeList.slice(0,that.retryCount);return circulation}catch(err){}}}]),Socket}(),exports["default"]=Socket},function(module,exports){"use strict";var _typeof,Paho;Object.defineProperty(exports,"__esModule",{value:!0}),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Paho={},"undefined"==typeof Paho&&(Paho={}),Paho.MQTT=function(global){function decodeMessage(input,pos){var digit,remLength,multiplier,endPos,wireMessage,connectAcknowledgeFlags,qos,len,topicName,message,startingPos=pos,first=input[pos],type=first>>4,messageInfo=first&=15;pos+=1,remLength=0,multiplier=1;do{if(pos==input.length)return[null,startingPos];digit=input[pos++],remLength+=(127&digit)*multiplier,multiplier*=128}while(0!=(128&digit));if(endPos=pos+remLength,endPos>input.length)return[null,startingPos];switch(wireMessage=new WireMessage(type),type){case MESSAGE_TYPE.CONNACK:connectAcknowledgeFlags=input[pos++],1&connectAcknowledgeFlags&&(wireMessage.sessionPresent=!0),wireMessage.returnCode=input[pos++];break;case MESSAGE_TYPE.PUBLISH:qos=messageInfo>>1&3,len=readUint16(input,pos),pos+=2,topicName=parseUTF8(input,pos,len),pos+=len,qos>0&&(wireMessage.messageIdentifier=readUint16(input,pos),pos+=2),message=new Paho.MQTT.Message(input.subarray(pos,endPos)),1==(1&messageInfo)&&(message.retained=!0),8==(8&messageInfo)&&(message.duplicate=!0),message.qos=qos,message.destinationName=topicName,wireMessage.payloadMessage=message;break;case MESSAGE_TYPE.PUBACK:case MESSAGE_TYPE.PUBREC:case MESSAGE_TYPE.PUBREL:case MESSAGE_TYPE.PUBCOMP:case MESSAGE_TYPE.UNSUBACK:wireMessage.messageIdentifier=readUint16(input,pos);break;case MESSAGE_TYPE.SUBACK:wireMessage.messageIdentifier=readUint16(input,pos),pos+=2,wireMessage.returnCode=input.subarray(pos,endPos)}return[wireMessage,endPos]}function writeUint16(input,buffer,offset){return buffer[offset++]=input>>8,buffer[offset++]=input%256,offset}function writeString(input,utf8Length,buffer,offset){return offset=writeUint16(utf8Length,buffer,offset),stringToUTF8(input,buffer,offset),offset+utf8Length}function readUint16(buffer,offset){return 256*buffer[offset]+buffer[offset+1]}function encodeMBI(number){var digit,output=new Array(1),numBytes=0;do digit=number%128,number>>=7,number>0&&(digit|=128),output[numBytes++]=digit;while(number>0&&numBytes<4);return output}function UTF8Length(input){var i,charCode,output=0;for(i=0;i<input.length;i++)charCode=input.charCodeAt(i),charCode>2047?(55296<=charCode&&charCode<=56319&&(i++,output++),output+=3):charCode>127?output+=2:output++;return output}function stringToUTF8(input,output,start){var i,charCode,lowCharCode,pos=start;for(i=0;i<input.length;i++){if(charCode=input.charCodeAt(i),55296<=charCode&&charCode<=56319){if(lowCharCode=input.charCodeAt(++i),isNaN(lowCharCode))throw new Error(format(ERROR.MALFORMED_UNICODE,[charCode,lowCharCode]));charCode=(charCode-55296<<10)+(lowCharCode-56320)+65536}charCode<=127?output[pos++]=charCode:charCode<=2047?(output[pos++]=charCode>>6&31|192,output[pos++]=63&charCode|128):charCode<=65535?(output[pos++]=charCode>>12&15|224,output[pos++]=charCode>>6&63|128,output[pos++]=63&charCode|128):(output[pos++]=charCode>>18&7|240,output[pos++]=charCode>>12&63|128,output[pos++]=charCode>>6&63|128,output[pos++]=63&charCode|128)}return output}function parseUTF8(input,offset,length){for(var utf16,byte1,byte2,byte3,byte4,output="",pos=offset;pos<offset+length;){if(byte1=input[pos++],byte1<128)utf16=byte1;else{if(byte2=input[pos++]-128,byte2<0)throw new Error(format(ERROR.MALFORMED_UTF,[byte1.toString(16),byte2.toString(16),""]));if(byte1<224)utf16=64*(byte1-192)+byte2;else{if(byte3=input[pos++]-128,byte3<0)throw new Error(format(ERROR.MALFORMED_UTF,[byte1.toString(16),byte2.toString(16),byte3.toString(16)]));if(byte1<240)utf16=4096*(byte1-224)+64*byte2+byte3;else{if(byte4=input[pos++]-128,byte4<0)throw new Error(format(ERROR.MALFORMED_UTF,[byte1.toString(16),byte2.toString(16),byte3.toString(16),byte4.toString(16)]));if(!(byte1<248))throw new Error(format(ERROR.MALFORMED_UTF,[byte1.toString(16),byte2.toString(16),byte3.toString(16),byte4.toString(16)]));utf16=262144*(byte1-240)+4096*byte2+64*byte3+byte4}}}utf16>65535&&(utf16-=65536,output+=String.fromCharCode(55296+(utf16>>10)),utf16=56320+(1023&utf16)),output+=String.fromCharCode(utf16)}return output}var Pinger,Timeout,ClientImpl,Client,Message,version="@VERSION@",buildLevel="@BUILDLEVEL@",MESSAGE_TYPE={CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,PUBREC:5,PUBREL:6,PUBCOMP:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14},validate=function validate(obj,keys){var key,errorStr;for(key in obj)if(obj.hasOwnProperty(key)){if(!keys.hasOwnProperty(key)){errorStr="Unknown property, "+key+". Valid properties are:";for(key in keys)keys.hasOwnProperty(key)&&(errorStr=errorStr+" "+key);throw new Error(errorStr)}if(_typeof(obj[key])!==keys[key])throw new Error(format(ERROR.INVALID_TYPE,[_typeof(obj[key]),key]))}},scope=function scope(f,_scope){return function(){return f.apply(_scope,arguments)}},ERROR={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."}},CONNACK_RC={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},format=function format(error,substitutions){var field,start,i,part1,part2,text=error.text;if(substitutions)for(i=0;i<substitutions.length;i++)field="{"+i+"}",start=text.indexOf(field),start>0&&(part1=text.substring(0,start),part2=text.substring(start+field.length),text=part1+substitutions[i]+part2);return text},MqttProtoIdentifierv3=[0,6,77,81,73,115,100,112,3],MqttProtoIdentifierv4=[0,4,77,81,84,84,4],WireMessage=function WireMessage(type,options){this.type=type;for(var name in options)options.hasOwnProperty(name)&&(this[name]=options[name])};return WireMessage.prototype.encode=function(){var willMessagePayloadBytes,i,payloadBytes,mbi,pos,buffer,byteStream,connectFlags,first=(15&this.type)<<4,remLength=0,topicStrLength=new Array,destinationNameLength=0;switch(void 0!=this.messageIdentifier&&(remLength+=2),this.type){case MESSAGE_TYPE.CONNECT:switch(this.mqttVersion){case 3:remLength+=MqttProtoIdentifierv3.length+3;break;case 4:remLength+=MqttProtoIdentifierv4.length+3}remLength+=UTF8Length(this.clientId)+2,void 0!=this.willMessage&&(remLength+=UTF8Length(this.willMessage.destinationName)+2,willMessagePayloadBytes=this.willMessage.payloadBytes,willMessagePayloadBytes instanceof Uint8Array||(willMessagePayloadBytes=new Uint8Array(payloadBytes)),remLength+=willMessagePayloadBytes.byteLength+2),void 0!=this.userName&&(remLength+=UTF8Length(this.userName)+2),void 0!=this.password&&(remLength+=UTF8Length(this.password)+2);break;case MESSAGE_TYPE.SUBSCRIBE:for(first|=2,i=0;i<this.topics.length;i++)topicStrLength[i]=UTF8Length(this.topics[i]),remLength+=topicStrLength[i]+2;remLength+=this.requestedQos.length;break;case MESSAGE_TYPE.UNSUBSCRIBE:for(first|=2,i=0;i<this.topics.length;i++)topicStrLength[i]=UTF8Length(this.topics[i]),remLength+=topicStrLength[i]+2;break;case MESSAGE_TYPE.PUBREL:first|=2;break;case MESSAGE_TYPE.PUBLISH:this.payloadMessage.duplicate&&(first|=8),first=first|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(first|=1),destinationNameLength=UTF8Length(this.payloadMessage.destinationName),remLength+=destinationNameLength+2,payloadBytes=this.payloadMessage.payloadBytes,remLength+=payloadBytes.byteLength,payloadBytes instanceof ArrayBuffer?payloadBytes=new Uint8Array(payloadBytes):payloadBytes instanceof Uint8Array||(payloadBytes=new Uint8Array(payloadBytes.buffer));break;case MESSAGE_TYPE.DISCONNECT:}if(mbi=encodeMBI(remLength),pos=mbi.length+1,buffer=new ArrayBuffer(remLength+pos),byteStream=new Uint8Array(buffer),byteStream[0]=first,byteStream.set(mbi,1),this.type==MESSAGE_TYPE.PUBLISH)pos=writeString(this.payloadMessage.destinationName,destinationNameLength,byteStream,pos);else if(this.type==MESSAGE_TYPE.CONNECT){switch(this.mqttVersion){case 3:byteStream.set(MqttProtoIdentifierv3,pos),pos+=MqttProtoIdentifierv3.length;break;case 4:byteStream.set(MqttProtoIdentifierv4,pos),pos+=MqttProtoIdentifierv4.length}connectFlags=0,this.cleanSession&&(connectFlags=2),void 0!=this.willMessage&&(connectFlags|=4,connectFlags|=this.willMessage.qos<<3,this.willMessage.retained&&(connectFlags|=32)),void 0!=this.userName&&(connectFlags|=128),void 0!=this.password&&(connectFlags|=64),byteStream[pos++]=connectFlags,pos=writeUint16(this.keepAliveInterval,byteStream,pos)}switch(void 0!=this.messageIdentifier&&(pos=writeUint16(this.messageIdentifier,byteStream,pos)),this.type){case MESSAGE_TYPE.CONNECT:pos=writeString(this.clientId,UTF8Length(this.clientId),byteStream,pos),void 0!=this.willMessage&&(pos=writeString(this.willMessage.destinationName,UTF8Length(this.willMessage.destinationName),byteStream,pos),pos=writeUint16(willMessagePayloadBytes.byteLength,byteStream,pos),byteStream.set(willMessagePayloadBytes,pos),pos+=willMessagePayloadBytes.byteLength),void 0!=this.userName&&(pos=writeString(this.userName,UTF8Length(this.userName),byteStream,pos)),void 0!=this.password&&(pos=writeString(this.password,UTF8Length(this.password),byteStream,pos));break;case MESSAGE_TYPE.PUBLISH:byteStream.set(payloadBytes,pos);break;case MESSAGE_TYPE.SUBSCRIBE:for(i=0;i<this.topics.length;i++)pos=writeString(this.topics[i],topicStrLength[i],byteStream,pos),byteStream[pos++]=this.requestedQos[i];break;case MESSAGE_TYPE.UNSUBSCRIBE:for(i=0;i<this.topics.length;i++)pos=writeString(this.topics[i],topicStrLength[i],byteStream,pos)}return buffer},Pinger=function Pinger(client,window,keepAliveInterval){var pingReq,doTimeout,doPing;this._client=client,this._window=window,this._keepAliveInterval=1e3*keepAliveInterval,this.isReset=!1,pingReq=new WireMessage(MESSAGE_TYPE.PINGREQ).encode(),doTimeout=function doTimeout(pinger){return function(){return doPing.apply(pinger)}},doPing=function doPing(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(pingReq),this.timeout=this._window.setTimeout(doTimeout(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(ERROR.PING_TIMEOUT.code,format(ERROR.PING_TIMEOUT)))},this.reset=function(){this.isReset=!0,this._window.clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(doTimeout(this),this._keepAliveInterval))},this.cancel=function(){this._window.clearTimeout(this.timeout)}},Timeout=function Timeout(client,window,timeoutSeconds,action,args){this._window=window,timeoutSeconds||(timeoutSeconds=30);var doTimeout=function doTimeout(action,client,args){return function(){return action.apply(client,args)}};this.timeout=setTimeout(doTimeout(action,client,args),1e3*timeoutSeconds),this.cancel=function(){this._window.clearTimeout(this.timeout)}},ClientImpl=function ClientImpl(uri,host,port,path,clientId){if(!("WebSocket"in global&&null!==global.WebSocket))throw new Error(format(ERROR.UNSUPPORTED,["WebSocket"]));if(!("localStorage"in global&&null!==global.localStorage))throw new Error(format(ERROR.UNSUPPORTED,["localStorage"]));if(!("ArrayBuffer"in global&&null!==global.ArrayBuffer))throw new Error(format(ERROR.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.MQTT.Client",uri,host,port,path,clientId),this.host=host,this.port=port,this.path=path,this.uri=uri,this.clientId=clientId,this._localKey=host+":"+port+("/mqtt"!=path?":"+path:"")+":"+clientId+":",this._msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0;for(var key in localStorage)0!=key.indexOf("Sent:"+this._localKey)&&0!=key.indexOf("Received:"+this._localKey)||this.restore(key)},ClientImpl.prototype.host,ClientImpl.prototype.port,ClientImpl.prototype.path,ClientImpl.prototype.uri,ClientImpl.prototype.clientId,ClientImpl.prototype.socket,ClientImpl.prototype.connected=!1,ClientImpl.prototype.maxMessageIdentifier=65536,ClientImpl.prototype.connectOptions,ClientImpl.prototype.hostIndex,ClientImpl.prototype.onConnectionLost,ClientImpl.prototype.onMessageDelivered,ClientImpl.prototype.onMessageArrived,ClientImpl.prototype.traceFunction,ClientImpl.prototype._msg_queue=null,ClientImpl.prototype._connectTimeout,ClientImpl.prototype.sendPinger=null,ClientImpl.prototype.receivePinger=null,ClientImpl.prototype.receiveBuffer=null,ClientImpl.prototype._traceBuffer=null,ClientImpl.prototype._MAX_TRACE_ENTRIES=100,ClientImpl.prototype.connect=function(connectOptions){var connectOptionsMasked=this._traceMask(connectOptions,"password");if(this._trace("Client.connect",connectOptionsMasked,this.socket,this.connected),this.connected)throw new Error(format(ERROR.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(format(ERROR.INVALID_STATE,["already connected"]));this.connectOptions=connectOptions,connectOptions.uris?(this.hostIndex=0,this._doConnect(connectOptions.uris[0])):this._doConnect(this.uri)},ClientImpl.prototype.subscribe=function(filter,subscribeOptions){if(this._trace("Client.subscribe",filter,subscribeOptions),!this.connected)throw new Error(format(ERROR.INVALID_STATE,["not connected"]));var wireMessage=new WireMessage(MESSAGE_TYPE.SUBSCRIBE);wireMessage.topics=[filter],void 0!=subscribeOptions.qos?wireMessage.requestedQos=[subscribeOptions.qos]:wireMessage.requestedQos=[0],subscribeOptions.onSuccess&&(wireMessage.onSuccess=function(grantedQos){subscribeOptions.onSuccess({invocationContext:subscribeOptions.invocationContext,grantedQos:grantedQos})}),subscribeOptions.onFailure&&(wireMessage.onFailure=function(errorCode){subscribeOptions.onFailure({invocationContext:subscribeOptions.invocationContext,errorCode:errorCode})}),subscribeOptions.timeout&&(wireMessage.timeOut=new Timeout(this,window,subscribeOptions.timeout,subscribeOptions.onFailure,[{invocationContext:subscribeOptions.invocationContext,errorCode:ERROR.SUBSCRIBE_TIMEOUT.code,errorMessage:format(ERROR.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(wireMessage),this._schedule_message(wireMessage)},ClientImpl.prototype.unsubscribe=function(filter,unsubscribeOptions){if(this._trace("Client.unsubscribe",filter,unsubscribeOptions),!this.connected)throw new Error(format(ERROR.INVALID_STATE,["not connected"]));var wireMessage=new WireMessage(MESSAGE_TYPE.UNSUBSCRIBE);wireMessage.topics=[filter],unsubscribeOptions.onSuccess&&(wireMessage.callback=function(){unsubscribeOptions.onSuccess({invocationContext:unsubscribeOptions.invocationContext})}),unsubscribeOptions.timeout&&(wireMessage.timeOut=new Timeout(this,window,unsubscribeOptions.timeout,unsubscribeOptions.onFailure,[{invocationContext:unsubscribeOptions.invocationContext,errorCode:ERROR.UNSUBSCRIBE_TIMEOUT.code,errorMessage:format(ERROR.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(wireMessage),this._schedule_message(wireMessage)},ClientImpl.prototype.send=function(message){if(this._trace("Client.send",message),!this.connected)throw new Error(format(ERROR.INVALID_STATE,["not connected"]));var wireMessage=new WireMessage(MESSAGE_TYPE.PUBLISH);wireMessage.payloadMessage=message,message.qos>0?this._requires_ack(wireMessage):this.onMessageDelivered&&(this._notify_msg_sent[wireMessage]=this.onMessageDelivered(wireMessage.payloadMessage)),
this._schedule_message(wireMessage)},ClientImpl.prototype.disconnect=function(){if(this._trace("Client.disconnect"),!this.socket)throw new Error(format(ERROR.INVALID_STATE,["not connecting or connected"]));var wireMessage=new WireMessage(MESSAGE_TYPE.DISCONNECT);this._notify_msg_sent[wireMessage]=scope(this._disconnected,this),this._schedule_message(wireMessage)},ClientImpl.prototype.getTraceLog=function(){var key;if(null!==this._traceBuffer){this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(key in this._sentMessages)this._trace("_sentMessages ",key,this._sentMessages[key]);for(key in this._receivedMessages)this._trace("_receivedMessages ",key,this._receivedMessages[key]);return this._traceBuffer}},ClientImpl.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,version)},ClientImpl.prototype.stopTrace=function(){delete this._traceBuffer},ClientImpl.prototype._doConnect=function(wsurl){if(this.connectOptions.useSSL){var uriParts=wsurl.split(":");uriParts[0]="wss",wsurl=uriParts.join(":")}this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(wsurl,["mqttv3.1"]):this.socket=new WebSocket(wsurl,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=scope(this._on_socket_open,this),this.socket.onmessage=scope(this._on_socket_message,this),this.socket.onerror=scope(this._on_socket_error,this),this.socket.onclose=scope(this._on_socket_close,this),this.sendPinger=new Pinger(this,window,this.connectOptions.keepAliveInterval),this.receivePinger=new Pinger(this,window,this.connectOptions.keepAliveInterval),this._connectTimeout=new Timeout(this,window,this.connectOptions.timeout,this._disconnected,[ERROR.CONNECT_TIMEOUT.code,format(ERROR.CONNECT_TIMEOUT)])},ClientImpl.prototype._schedule_message=function(message){this._msg_queue.push(message),this.connected&&this._process_queue()},ClientImpl.prototype.store=function(prefix,wireMessage){var hex,messageBytes,i,storedMessage={type:wireMessage.type,messageIdentifier:wireMessage.messageIdentifier,version:1};switch(wireMessage.type){case MESSAGE_TYPE.PUBLISH:for(wireMessage.pubRecReceived&&(storedMessage.pubRecReceived=!0),storedMessage.payloadMessage={},hex="",messageBytes=wireMessage.payloadMessage.payloadBytes,i=0;i<messageBytes.length;i++)messageBytes[i]<=15?hex=hex+"0"+messageBytes[i].toString(16):hex+=messageBytes[i].toString(16);storedMessage.payloadMessage.payloadHex=hex,storedMessage.payloadMessage.qos=wireMessage.payloadMessage.qos,storedMessage.payloadMessage.destinationName=wireMessage.payloadMessage.destinationName,wireMessage.payloadMessage.duplicate&&(storedMessage.payloadMessage.duplicate=!0),wireMessage.payloadMessage.retained&&(storedMessage.payloadMessage.retained=!0),0==prefix.indexOf("Sent:")&&(void 0===wireMessage.sequence&&(wireMessage.sequence=++this._sequence),storedMessage.sequence=wireMessage.sequence);break;default:throw Error(format(ERROR.INVALID_STORED_DATA,[key,storedMessage]))}localStorage.setItem(prefix+this._localKey+wireMessage.messageIdentifier,JSON.stringify(storedMessage))},ClientImpl.prototype.restore=function(key){var hex,buffer,byteStream,i,x,payloadMessage,value=localStorage.getItem(key),storedMessage=JSON.parse(value),wireMessage=new WireMessage(storedMessage.type,storedMessage);switch(storedMessage.type){case MESSAGE_TYPE.PUBLISH:for(hex=storedMessage.payloadMessage.payloadHex,buffer=new ArrayBuffer(hex.length/2),byteStream=new Uint8Array(buffer),i=0;hex.length>=2;)x=parseInt(hex.substring(0,2),16),hex=hex.substring(2,hex.length),byteStream[i++]=x;payloadMessage=new Paho.MQTT.Message(byteStream),payloadMessage.qos=storedMessage.payloadMessage.qos,payloadMessage.destinationName=storedMessage.payloadMessage.destinationName,storedMessage.payloadMessage.duplicate&&(payloadMessage.duplicate=!0),storedMessage.payloadMessage.retained&&(payloadMessage.retained=!0),wireMessage.payloadMessage=payloadMessage;break;default:throw Error(format(ERROR.INVALID_STORED_DATA,[key,value]))}0==key.indexOf("Sent:"+this._localKey)?(wireMessage.payloadMessage.duplicate=!0,this._sentMessages[wireMessage.messageIdentifier]=wireMessage):0==key.indexOf("Received:"+this._localKey)&&(this._receivedMessages[wireMessage.messageIdentifier]=wireMessage)},ClientImpl.prototype._process_queue=function(){for(var message=null,fifo=this._msg_queue.reverse();message=fifo.pop();)this._socket_send(message),this._notify_msg_sent[message]&&(this._notify_msg_sent[message](),delete this._notify_msg_sent[message])},ClientImpl.prototype._requires_ack=function(wireMessage){var messageCount=Object.keys(this._sentMessages).length;if(messageCount>this.maxMessageIdentifier)throw Error("Too many messages:"+messageCount);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;wireMessage.messageIdentifier=this._message_identifier,this._sentMessages[wireMessage.messageIdentifier]=wireMessage,wireMessage.type===MESSAGE_TYPE.PUBLISH&&this.store("Sent:",wireMessage),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},ClientImpl.prototype._on_socket_open=function(){var wireMessage=new WireMessage(MESSAGE_TYPE.CONNECT,this.connectOptions);wireMessage.clientId=this.clientId,this._socket_send(wireMessage)},ClientImpl.prototype._on_socket_message=function(event){var messages,i;for(this._trace("Client._on_socket_message",event.data),messages=this._deframeMessages(event.data),i=0;i<messages.length;i+=1)this._handleMessage(messages[i])},ClientImpl.prototype._deframeMessages=function(data){var newData,offset,messages,result,wireMessage,byteArray=new Uint8Array(data);this.receiveBuffer&&(newData=new Uint8Array(this.receiveBuffer.length+byteArray.length),newData.set(this.receiveBuffer),newData.set(byteArray,this.receiveBuffer.length),byteArray=newData,delete this.receiveBuffer);try{for(offset=0,messages=[];offset<byteArray.length&&(result=decodeMessage(byteArray,offset),wireMessage=result[0],offset=result[1],null!==wireMessage);)messages.push(wireMessage);offset<byteArray.length&&(this.receiveBuffer=byteArray.subarray(offset))}catch(error){return void this._disconnected(ERROR.INTERNAL_ERROR.code,format(ERROR.INTERNAL_ERROR,[error.message,error.stack.toString()]))}return messages},ClientImpl.prototype._handleMessage=function(wireMessage){var key,sentMessage,receivedMessage,sequencedMessages,msgId,i,len,pubRelMessage,pubCompMessage;this._trace("Client._handleMessage",wireMessage);try{switch(wireMessage.type){case MESSAGE_TYPE.CONNACK:if(this._connectTimeout.cancel(),this.connectOptions.cleanSession){for(key in this._sentMessages)sentMessage=this._sentMessages[key],localStorage.removeItem("Sent:"+this._localKey+sentMessage.messageIdentifier);this._sentMessages={};for(key in this._receivedMessages)receivedMessage=this._receivedMessages[key],localStorage.removeItem("Received:"+this._localKey+receivedMessage.messageIdentifier);this._receivedMessages={}}if(0!==wireMessage.returnCode){this._disconnected(ERROR.CONNACK_RETURNCODE.code,format(ERROR.CONNACK_RETURNCODE,[wireMessage.returnCode,CONNACK_RC[wireMessage.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length),sequencedMessages=new Array;for(msgId in this._sentMessages)this._sentMessages.hasOwnProperty(msgId)&&sequencedMessages.push(this._sentMessages[msgId]);for(sequencedMessages=sequencedMessages.sort(function(a,b){return a.sequence-b.sequence}),i=0,len=sequencedMessages.length;i<len;i++)sentMessage=sequencedMessages[i],sentMessage.type==MESSAGE_TYPE.PUBLISH&&sentMessage.pubRecReceived?(pubRelMessage=new WireMessage(MESSAGE_TYPE.PUBREL,{messageIdentifier:sentMessage.messageIdentifier}),this._schedule_message(pubRelMessage)):this._schedule_message(sentMessage);this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext}),this._process_queue();break;case MESSAGE_TYPE.PUBLISH:this._receivePublish(wireMessage);break;case MESSAGE_TYPE.PUBACK:sentMessage=this._sentMessages[wireMessage.messageIdentifier],sentMessage&&(delete this._sentMessages[wireMessage.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+wireMessage.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(sentMessage.payloadMessage));break;case MESSAGE_TYPE.PUBREC:sentMessage=this._sentMessages[wireMessage.messageIdentifier],sentMessage&&(sentMessage.pubRecReceived=!0,pubRelMessage=new WireMessage(MESSAGE_TYPE.PUBREL,{messageIdentifier:wireMessage.messageIdentifier}),this.store("Sent:",sentMessage),this._schedule_message(pubRelMessage));break;case MESSAGE_TYPE.PUBREL:receivedMessage=this._receivedMessages[wireMessage.messageIdentifier],localStorage.removeItem("Received:"+this._localKey+wireMessage.messageIdentifier),receivedMessage&&(this._receiveMessage(receivedMessage),delete this._receivedMessages[wireMessage.messageIdentifier]),pubCompMessage=new WireMessage(MESSAGE_TYPE.PUBCOMP,{messageIdentifier:wireMessage.messageIdentifier}),this._schedule_message(pubCompMessage);break;case MESSAGE_TYPE.PUBCOMP:sentMessage=this._sentMessages[wireMessage.messageIdentifier],delete this._sentMessages[wireMessage.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+wireMessage.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(sentMessage.payloadMessage);break;case MESSAGE_TYPE.SUBACK:sentMessage=this._sentMessages[wireMessage.messageIdentifier],sentMessage&&(sentMessage.timeOut&&sentMessage.timeOut.cancel(),128===wireMessage.returnCode[0]?sentMessage.onFailure&&sentMessage.onFailure(wireMessage.returnCode):sentMessage.onSuccess&&sentMessage.onSuccess(wireMessage.returnCode),delete this._sentMessages[wireMessage.messageIdentifier]);break;case MESSAGE_TYPE.UNSUBACK:sentMessage=this._sentMessages[wireMessage.messageIdentifier],sentMessage&&(sentMessage.timeOut&&sentMessage.timeOut.cancel(),sentMessage.callback&&sentMessage.callback(),delete this._sentMessages[wireMessage.messageIdentifier]);break;case MESSAGE_TYPE.PINGRESP:this.sendPinger.reset();break;case MESSAGE_TYPE.DISCONNECT:this._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code,format(ERROR.INVALID_MQTT_MESSAGE_TYPE,[wireMessage.type]));break;default:this._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code,format(ERROR.INVALID_MQTT_MESSAGE_TYPE,[wireMessage.type]))}}catch(error){return void this._disconnected(ERROR.INTERNAL_ERROR.code,format(ERROR.INTERNAL_ERROR,[error.message,error.stack.toString()]))}},ClientImpl.prototype._on_socket_error=function(error){this._disconnected(ERROR.SOCKET_ERROR.code,format(ERROR.SOCKET_ERROR,[error.data]))},ClientImpl.prototype._on_socket_close=function(){this._disconnected(ERROR.SOCKET_CLOSE.code,format(ERROR.SOCKET_CLOSE))},ClientImpl.prototype._socket_send=function(wireMessage){if(1==wireMessage.type){var wireMessageMasked=this._traceMask(wireMessage,"password");this._trace("Client._socket_send",wireMessageMasked)}else this._trace("Client._socket_send",wireMessage);this.socket.send(wireMessage.encode()),this.sendPinger.reset()},ClientImpl.prototype._receivePublish=function(wireMessage){var pubAckMessage,pubRecMessage;switch(wireMessage.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(wireMessage);break;case 1:pubAckMessage=new WireMessage(MESSAGE_TYPE.PUBACK,{messageIdentifier:wireMessage.messageIdentifier}),this._schedule_message(pubAckMessage),this._receiveMessage(wireMessage);break;case 2:this._receivedMessages[wireMessage.messageIdentifier]=wireMessage,this.store("Received:",wireMessage),pubRecMessage=new WireMessage(MESSAGE_TYPE.PUBREC,{messageIdentifier:wireMessage.messageIdentifier}),this._schedule_message(pubRecMessage);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}},ClientImpl.prototype._receiveMessage=function(wireMessage){this.onMessageArrived&&this.onMessageArrived(wireMessage.payloadMessage)},ClientImpl.prototype._disconnected=function(errorCode,errorText){this._trace("Client._disconnected",errorCode,errorText),this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&this._connectTimeout.cancel(),this._msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1?(this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex])):(void 0===errorCode&&(errorCode=ERROR.OK.code,errorText=format(ERROR.OK)),this.connected?(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:errorCode,errorMessage:errorText})):4===this.connectOptions.mqttVersion&&this.connectOptions.mqttVersionExplicit===!1?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:errorCode,errorMessage:errorText}))},ClientImpl.prototype._trace=function(){var i,record,max;if(this.traceFunction){for(i in arguments)"undefined"!=typeof arguments[i]&&(arguments[i]=JSON.stringify(arguments[i]));record=Array.prototype.slice.call(arguments).join(""),this.traceFunction({severity:"Debug",message:record})}if(null!==this._traceBuffer)for(i=0,max=arguments.length;i<max;i++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===i?this._traceBuffer.push(arguments[i]):"undefined"==typeof arguments[i]?this._traceBuffer.push(arguments[i]):this._traceBuffer.push("  "+JSON.stringify(arguments[i]))},ClientImpl.prototype._traceMask=function(traceObject,masked){var attr,traceObjectMasked={};for(attr in traceObject)traceObject.hasOwnProperty(attr)&&(attr==masked?traceObjectMasked[attr]="******":traceObjectMasked[attr]=traceObject[attr]);return traceObjectMasked},Client=function Client(host,port,path,clientId){var uri,match,ipv6AddSBracket,clientIdLength,i,charCode,client;if("string"!=typeof host)throw new Error(format(ERROR.INVALID_TYPE,["undefined"==typeof host?"undefined":_typeof(host),"host"]));if(clientId=clientId,2==arguments.length){if(clientId=port,uri=host,match=uri.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/),!match)throw new Error(format(ERROR.INVALID_ARGUMENT,[host,"host"]));host=match[4]||match[2],port=parseInt(match[7]),path=match[8]}else{if(3==arguments.length&&(clientId=path,path="/mqtt"),"number"!=typeof port||port<0)throw new Error(format(ERROR.INVALID_TYPE,["undefined"==typeof port?"undefined":_typeof(port),"port"]));if("string"!=typeof path)throw new Error(format(ERROR.INVALID_TYPE,["undefined"==typeof path?"undefined":_typeof(path),"path"]));ipv6AddSBracket=host.indexOf(":")!=-1&&"["!=host.slice(0,1)&&"]"!=host.slice(-1),uri="ws://"+(ipv6AddSBracket?"["+host+"]":host)+":"+port+path}for(clientIdLength=0,i=0;i<clientId.length;i++)charCode=clientId.charCodeAt(i),55296<=charCode&&charCode<=56319&&i++,clientIdLength++;if("string"!=typeof clientId||clientIdLength>65535)throw new Error(format(ERROR.INVALID_ARGUMENT,[clientId,"clientId"]));client=new ClientImpl(uri,host,port,path,clientId),this._getHost=function(){return host},this._setHost=function(){throw new Error(format(ERROR.UNSUPPORTED_OPERATION))},this._getPort=function(){return port},this._setPort=function(){throw new Error(format(ERROR.UNSUPPORTED_OPERATION))},this._getPath=function(){return path},this._setPath=function(){throw new Error(format(ERROR.UNSUPPORTED_OPERATION))},this._getURI=function(){return uri},this._setURI=function(){throw new Error(format(ERROR.UNSUPPORTED_OPERATION))},this._getClientId=function(){return client.clientId},this._setClientId=function(){throw new Error(format(ERROR.UNSUPPORTED_OPERATION))},this._getOnConnectionLost=function(){return client.onConnectionLost},this._setOnConnectionLost=function(newOnConnectionLost){if("function"!=typeof newOnConnectionLost)throw new Error(format(ERROR.INVALID_TYPE,["undefined"==typeof newOnConnectionLost?"undefined":_typeof(newOnConnectionLost),"onConnectionLost"]));client.onConnectionLost=newOnConnectionLost},this._getOnMessageDelivered=function(){return client.onMessageDelivered},this._setOnMessageDelivered=function(newOnMessageDelivered){if("function"!=typeof newOnMessageDelivered)throw new Error(format(ERROR.INVALID_TYPE,["undefined"==typeof newOnMessageDelivered?"undefined":_typeof(newOnMessageDelivered),"onMessageDelivered"]));client.onMessageDelivered=newOnMessageDelivered},this._getOnMessageArrived=function(){return client.onMessageArrived},this._setOnMessageArrived=function(newOnMessageArrived){if("function"!=typeof newOnMessageArrived)throw new Error(format(ERROR.INVALID_TYPE,["undefined"==typeof newOnMessageArrived?"undefined":_typeof(newOnMessageArrived),"onMessageArrived"]));client.onMessageArrived=newOnMessageArrived},this._getTrace=function(){return client.traceFunction},this._setTrace=function(trace){if("function"!=typeof trace)throw new Error(format(ERROR.INVALID_TYPE,["undefined"==typeof trace?"undefined":_typeof(trace),"onTrace"]));client.traceFunction=trace},this.connect=function(connectOptions){var usingURIs,i,host,port,ipv6;if(connectOptions=connectOptions||{},validate(connectOptions,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),void 0===connectOptions.keepAliveInterval&&(connectOptions.keepAliveInterval=60),connectOptions.mqttVersion>4||connectOptions.mqttVersion<3)throw new Error(format(ERROR.INVALID_ARGUMENT,[connectOptions.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===connectOptions.mqttVersion?(connectOptions.mqttVersionExplicit=!1,connectOptions.mqttVersion=4):connectOptions.mqttVersionExplicit=!0,void 0!==connectOptions.password&&void 0===connectOptions.userName)throw new Error(format(ERROR.INVALID_ARGUMENT,[connectOptions.password,"connectOptions.password"]));if(connectOptions.willMessage){if(!(connectOptions.willMessage instanceof Message))throw new Error(format(ERROR.INVALID_TYPE,[connectOptions.willMessage,"connectOptions.willMessage"]));if(connectOptions.willMessage.stringPayload,"undefined"==typeof connectOptions.willMessage.destinationName)throw new Error(format(ERROR.INVALID_TYPE,[_typeof(connectOptions.willMessage.destinationName),"connectOptions.willMessage.destinationName"]))}if("undefined"==typeof connectOptions.cleanSession&&(connectOptions.cleanSession=!0),connectOptions.hosts){if(!(connectOptions.hosts instanceof Array))throw new Error(format(ERROR.INVALID_ARGUMENT,[connectOptions.hosts,"connectOptions.hosts"]));if(connectOptions.hosts.length<1)throw new Error(format(ERROR.INVALID_ARGUMENT,[connectOptions.hosts,"connectOptions.hosts"]));for(usingURIs=!1,i=0;i<connectOptions.hosts.length;i++){if("string"!=typeof connectOptions.hosts[i])throw new Error(format(ERROR.INVALID_TYPE,[_typeof(connectOptions.hosts[i]),"connectOptions.hosts["+i+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(connectOptions.hosts[i])){if(0==i)usingURIs=!0;else if(!usingURIs)throw new Error(format(ERROR.INVALID_ARGUMENT,[connectOptions.hosts[i],"connectOptions.hosts["+i+"]"]))}else if(usingURIs)throw new Error(format(ERROR.INVALID_ARGUMENT,[connectOptions.hosts[i],"connectOptions.hosts["+i+"]"]))}if(usingURIs)connectOptions.uris=connectOptions.hosts;else{if(!connectOptions.ports)throw new Error(format(ERROR.INVALID_ARGUMENT,[connectOptions.ports,"connectOptions.ports"]));if(!(connectOptions.ports instanceof Array))throw new Error(format(ERROR.INVALID_ARGUMENT,[connectOptions.ports,"connectOptions.ports"]));if(connectOptions.hosts.length!=connectOptions.ports.length)throw new Error(format(ERROR.INVALID_ARGUMENT,[connectOptions.ports,"connectOptions.ports"]));for(connectOptions.uris=[],i=0;i<connectOptions.hosts.length;i++){if("number"!=typeof connectOptions.ports[i]||connectOptions.ports[i]<0)throw new Error(format(ERROR.INVALID_TYPE,[_typeof(connectOptions.ports[i]),"connectOptions.ports["+i+"]"]));host=connectOptions.hosts[i],port=connectOptions.ports[i],ipv6=host.indexOf(":")!=-1,uri="ws://"+(ipv6?"["+host+"]":host)+":"+port+path,connectOptions.uris.push(uri)}}}client.connect(connectOptions)},this.subscribe=function(filter,subscribeOptions){if("string"!=typeof filter)throw new Error("Invalid argument:"+filter);if(subscribeOptions=subscribeOptions||{},validate(subscribeOptions,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),subscribeOptions.timeout&&!subscribeOptions.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if("undefined"!=typeof subscribeOptions.qos&&0!==subscribeOptions.qos&&1!==subscribeOptions.qos&&2!==subscribeOptions.qos)throw new Error(format(ERROR.INVALID_ARGUMENT,[subscribeOptions.qos,"subscribeOptions.qos"]));client.subscribe(filter,subscribeOptions)},this.unsubscribe=function(filter,unsubscribeOptions){if("string"!=typeof filter)throw new Error("Invalid argument:"+filter);if(unsubscribeOptions=unsubscribeOptions||{},validate(unsubscribeOptions,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),unsubscribeOptions.timeout&&!unsubscribeOptions.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");client.unsubscribe(filter,unsubscribeOptions)},this.send=function(topic,payload,qos,retained){var message;if(0==arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(topic instanceof Message)&&"string"!=typeof topic)throw new Error("Invalid argument:"+("undefined"==typeof topic?"undefined":_typeof(topic)));if(message=topic,"undefined"==typeof message.destinationName)throw new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,"Message.destinationName"]));client.send(message)}else message=new Message(payload),message.destinationName=topic,arguments.length>=3&&(message.qos=qos),arguments.length>=4&&(message.retained=retained),client.send(message)},this.disconnect=function(){client.disconnect()},this.getTraceLog=function(){return client.getTraceLog()},this.startTrace=function(){client.startTrace()},this.stopTrace=function(){client.stopTrace()},this.isConnected=function(){return client.connected}},Client.prototype={get host(){return this._getHost()},set host(newHost){this._setHost(newHost)},get port(){return this._getPort()},set port(newPort){this._setPort(newPort)},get path(){return this._getPath()},set path(newPath){this._setPath(newPath)},get clientId(){return this._getClientId()},set clientId(newClientId){this._setClientId(newClientId)},get onConnectionLost(){return this._getOnConnectionLost()},set onConnectionLost(newOnConnectionLost){this._setOnConnectionLost(newOnConnectionLost)},get onMessageDelivered(){return this._getOnMessageDelivered()},set onMessageDelivered(newOnMessageDelivered){this._setOnMessageDelivered(newOnMessageDelivered)},get onMessageArrived(){return this._getOnMessageArrived()},set onMessageArrived(newOnMessageArrived){this._setOnMessageArrived(newOnMessageArrived)},get trace(){return this._getTrace()},set trace(newTraceFunction){this._setTrace(newTraceFunction)}},Message=function Message(newPayload){var payload,destinationName,qos,retained,duplicate;if(!("string"==typeof newPayload||newPayload instanceof ArrayBuffer||newPayload instanceof Int8Array||newPayload instanceof Uint8Array||newPayload instanceof Int16Array||newPayload instanceof Uint16Array||newPayload instanceof Int32Array||newPayload instanceof Uint32Array||newPayload instanceof Float32Array||newPayload instanceof Float64Array))throw format(ERROR.INVALID_ARGUMENT,[newPayload,"newPayload"]);payload=newPayload,this._getPayloadString=function(){return"string"==typeof payload?payload:parseUTF8(payload,0,payload.length)},this._getPayloadBytes=function(){var buffer,byteStream;return"string"==typeof payload?(buffer=new ArrayBuffer(UTF8Length(payload)),byteStream=new Uint8Array(buffer),stringToUTF8(payload,byteStream,0),byteStream):payload},destinationName=void 0,this._getDestinationName=function(){return destinationName},this._setDestinationName=function(newDestinationName){if("string"!=typeof newDestinationName)throw new Error(format(ERROR.INVALID_ARGUMENT,[newDestinationName,"newDestinationName"]));destinationName=newDestinationName},qos=0,this._getQos=function(){return qos},this._setQos=function(newQos){if(0!==newQos&&1!==newQos&&2!==newQos)throw new Error("Invalid argument:"+newQos);qos=newQos},retained=!1,this._getRetained=function(){return retained},this._setRetained=function(newRetained){if("boolean"!=typeof newRetained)throw new Error(format(ERROR.INVALID_ARGUMENT,[newRetained,"newRetained"]));retained=newRetained},duplicate=!1,this._getDuplicate=function(){return duplicate},this._setDuplicate=function(newDuplicate){duplicate=newDuplicate}},Message.prototype={get payloadString(){return this._getPayloadString()},get payloadBytes(){return this._getPayloadBytes()},get destinationName(){return this._getDestinationName()},set destinationName(newDestinationName){this._setDestinationName(newDestinationName)},get qos(){return this._getQos()},set qos(newQos){this._setQos(newQos)},get retained(){return this._getRetained()},set retained(newRetained){this._setRetained(newRetained)},get duplicate(){return this._getDuplicate()},set duplicate(newDuplicate){this._setDuplicate(newDuplicate)}},{Client:Client,Message:Message}}(window),exports["default"]=Paho},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _Cookie2,_Cookie;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cookie=void 0,_Cookie2=__webpack_require__(117),_Cookie=_interopRequireWildcard(_Cookie2),exports.Cookie=_Cookie},function(module,exports){"use strict";var WEBIM_WEBIMPOLLING,WEBIM_CONF,WEBIM_TOKEN,WEBIM_PAGEID,WEBIM_CONNECT;Object.defineProperty(exports,"__esModule",{value:!0}),WEBIM_WEBIMPOLLING=exports.WEBIM_WEBIMPOLLING="WebIMPolling",WEBIM_CONF=exports.WEBIM_CONF="WebIMConf",WEBIM_TOKEN=exports.WEBIM_TOKEN="WebIMToken",WEBIM_PAGEID=exports.WEBIM_PAGEID="WebImPageId",WEBIM_CONNECT=exports.WEBIM_CONNECT="WebImConnect"},function(module,exports){"use strict";jQuery.extend({createUploadIframe:function createUploadIframe(id,uri){var frameId="jUploadFrame"+id,iframeHtml='<iframe id="'+frameId+'" name="'+frameId+'" style="position:absolute; top:-9999px; left:-9999px"';return window.ActiveXObject&&("boolean"==typeof uri?iframeHtml+=' src="javascript:false"':"string"==typeof uri&&(iframeHtml+=' src="'+uri+'"')),iframeHtml+="></iframe>",jQuery(iframeHtml).appendTo(document.body),jQuery("#"+frameId).get(0)},createUploadForm:function createUploadForm(id,fileElementId,data,crossDomain,onAppend){var i,oldElement,formId="jUploadForm"+id,fileId="jUploadFile"+id,form=jQuery('<form action="" method="POST" name="'+formId+'" id="'+formId+'" enctype="multipart/form-data"></form>');if(data)if("[object Array]"===Object.prototype.toString.call(data))for(i=0;i<data.length;i++)jQuery('<input type="hidden" name="'+data[i].name+'" />').val(data[i].value).appendTo(form);else for(i in data)jQuery('<input type="hidden" name="'+i+'" />').val(data[i]).appendTo(form);return crossDomain&&jQuery('<input type="hidden" name="callback" />').val("<script type='text/javascript'>try{document.domain=window.location.hostname.split('.').reverse().slice(0,2).reverse().join('.');}catch(e){}</script>").appendTo(form),oldElement=jQuery("#"+fileElementId),jQuery(oldElement).appendTo(form),jQuery(form).css("position","absolute"),jQuery(form).css("top","-1200px"),jQuery(form).css("left","-1200px"),jQuery(form).appendTo("body"),onAppend&&onAppend(),form},ajaxFileUpload:function ajaxFileUpload(s){var id,form,io,frameId,formId,requestDone,xml,uploadCallback,handleError=function handleError(s,xhr,status,e){s.error&&s.error(xhr,status,e),s.global&&jQuery.event.trigger("ajaxError",[xhr,s,e])};s=jQuery.extend({},jQuery.ajaxSettings,s),id=(new Date).getTime(),form=jQuery.createUploadForm(id,s.fileElementId,"undefined"!=typeof s.data&&s.data,s.crossDomain,s.onAppend),io=jQuery.createUploadIframe(id,s.secureuri),frameId="jUploadFrame"+id,formId="jUploadForm"+id,s.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart"),requestDone=!1,xml={},s.global&&jQuery.event.trigger("ajaxSend",[xml,s]),uploadCallback=function uploadCallback(isTimeout){var timer,io=document.getElementById(frameId),execontent=function execontent(){var status,data;try{io.contentWindow?(xml.responseText=io.contentWindow.document.body?io.contentWindow.document.body.innerHTML:null,xml.responseXML=io.contentWindow.document.XMLDocument?io.contentWindow.document.XMLDocument:io.contentWindow.document):io.contentDocument&&(xml.responseText=io.contentDocument.document.body?io.contentDocument.document.body.innerHTML:null,xml.responseXML=io.contentDocument.document.XMLDocument?io.contentDocument.document.XMLDocument:io.contentDocument.document)}catch(e){handleError(s,xml,null,e)}if(xml||"timeout"==isTimeout){requestDone=!0;try{status="timeout"!=isTimeout?"success":"error","error"!=status?(data=jQuery.uploadHttpData(xml,s.dataType),s.success&&s.success(data,status),s.global&&jQuery.event.trigger("ajaxSuccess",[xml,s])):handleError(s,xml,status)}catch(e){status="error",handleError(s,xml,status,e)}s.global&&jQuery.event.trigger("ajaxComplete",[xml,s]),s.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),s.complete&&s.complete(xml,status),jQuery(io).unbind(),setTimeout(function(){try{jQuery(io).remove(),jQuery(form).remove()}catch(e){handleError(s,xml,null,e)}},100),xml=null}};s.crossDomain?timer=window.setTimeout(function(){try{execontent()}catch(e){}},1e3):execontent()},s.timeout>0&&setTimeout(function(){requestDone||uploadCallback("timeout")},s.timeout);try{form=jQuery("#"+formId),jQuery(form).attr("action",s.url),jQuery(form).attr("method","POST"),jQuery(form).attr("target",frameId),form.encoding?jQuery(form).attr("encoding","multipart/form-data"):jQuery(form).attr("enctype","multipart/form-data"),jQuery(form).submit()}catch(e){handleError(s,xml,null,e)}return jQuery("#"+frameId).load(uploadCallback),{abort:function abort(){}}},uploadHttpData:function uploadHttpData(r,type){var data=!type;return data="xml"==type||data?r.responseXML:r.responseText,data=data.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gim,"").replace(/<[^>]+>/g,""),"script"==type&&jQuery.globalEval(data),"json"==type&&eval("data = "+data),"html"==type&&jQuery("<div>").html(data).evalScripts(),data}})},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _objectWithoutProperties(obj,keys){var i,target={};for(i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){
if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function ChatDialog(props){var children=props.children,rest=_objectWithoutProperties(props,["children"]);return _react2["default"].createElement(Dialog,_extends({},rest,{parent:"chat"}),children)}function PanelDialog(props){var children=props.children,rest=_objectWithoutProperties(props,["children"]);return _react2["default"].createElement(Dialog,_extends({},rest,{parent:"panel"}),children)}function MainDialog(props){var children=props.children,rest=_objectWithoutProperties(props,["children"]);return _react2["default"].createElement(Dialog,_extends({},rest,{parent:"main"}),children)}function confirm(props){var onClose,_props$outerClose,outerClose,text,time,rest,onConfirmClose,_props$parent=props.parent,parent=void 0===_props$parent?"panel":_props$parent,$confirm=$("#"+parent+"-dialog-container-confirm");0===$confirm.length&&($("#"+parent+"-dialog-container").after('<div id="'+parent+'-dialog-container-confirm"></div>'),$confirm=$("#"+parent+"-dialog-container-confirm")),onClose=props.onClose,_props$outerClose=props.outerClose,outerClose=void 0===_props$outerClose?emptyFn:_props$outerClose,text=props.text,time=props.time,rest=_objectWithoutProperties(props,["onClose","outerClose","text","time"]),onConfirmClose=function onConfirmClose(){$confirm.length&&_reactDom2["default"].unmountComponentAtNode($confirm[0])},time&&setTimeout(function(){onConfirmClose()},time),outerClose(onConfirmClose),_reactDom2["default"].render(_react2["default"].createElement(DialogContent,_extends({onClose:function onClose(){return onConfirmClose()},content:_react2["default"].createElement("p",{className:"confirm-msg"},text)},rest)),$confirm[0])}var _extends,_createClass,_react,_react2,_reactDom,_reactDom2,_redux,_reactRedux,_ActionType,ActionType,_classnames7,_classnames8,emptyFn,DialogContent,Dialog,alertFooter;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PanelDialog=exports.MainDialog=exports.ChatDialog=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(111),_reactDom2=_interopRequireDefault(_reactDom),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_classnames7=__webpack_require__(144),_classnames8=_interopRequireDefault(_classnames7),__webpack_require__(145),emptyFn=function emptyFn(){},DialogContent=function(_Component){function DialogContent(props){return _classCallCheck(this,DialogContent),_possibleConstructorReturn(this,(DialogContent.__proto__||Object.getPrototypeOf(DialogContent)).call(this,props))}return _inherits(DialogContent,_Component),_createClass(DialogContent,[{key:"renderFooter",value:function renderFooter(){var _props=this.props,footer=_props.footer,_props$onCancel=_props.onCancel,onCancel=void 0===_props$onCancel?emptyFn:_props$onCancel,_props$onOk=_props.onOk,onOk=void 0===_props$onOk?emptyFn:_props$onOk,_props$onClose=_props.onClose,onClose=void 0===_props$onClose?emptyFn:_props$onClose,footerCls=_props.cls.footerCls,_props$okVal=_props.okVal,okVal=void 0===_props$okVal?"确定":_props$okVal,_props$cancelVal=_props.cancelVal,cancelVal=void 0===_props$cancelVal?"取消":_props$cancelVal;return footer?"boolean"==typeof footer?_react2["default"].createElement("div",{className:(0,_classnames8["default"])("im-dialog-footer",_defineProperty({},""+footerCls,!!footerCls))},_react2["default"].createElement("a",{className:"btn-ok",href:"javascript:;",onClick:function onClick(){onOk(),onClose()}},okVal),_react2["default"].createElement("a",{className:"btn-cancel",href:"javascript:;",onClick:function onClick(){onCancel(),onClose()}},cancelVal)):footer(this.props):null}},{key:"render",value:function render(){var _props2=this.props,_props2$cls=_props2.cls,_props2$cls$dialogCls=_props2$cls.dialogCls,dialogCls=void 0===_props2$cls$dialogCls?"":_props2$cls$dialogCls,_props2$cls$headerCls=_props2$cls.headerCls,headerCls=void 0===_props2$cls$headerCls?"":_props2$cls$headerCls,_props2$cls$maskCls=_props2$cls.maskCls,maskCls=void 0===_props2$cls$maskCls?"":_props2$cls$maskCls,_props2$cls$mainCls=_props2$cls.mainCls,mainCls=void 0===_props2$cls$mainCls?"":_props2$cls$mainCls,_props2$cls$contentCl=_props2$cls.contentCls,contentCls=void 0===_props2$cls$contentCl?"":_props2$cls$contentCl,_props2$cls$footerCls=_props2$cls.footerCls,footerCls=void 0===_props2$cls$footerCls?"":_props2$cls$footerCls,_props2$width=_props2.width,width=void 0===_props2$width?200:_props2$width,_props2$position=_props2.position,position=void 0===_props2$position?"center":_props2$position,title=_props2.title,_props2$closeBtn=_props2.closeBtn,closeBtn=void 0===_props2$closeBtn||_props2$closeBtn,backBtn=_props2.backBtn,footer=_props2.footer,children=_props2.children,visible=_props2.visible,_props2$onCancel=_props2.onCancel,onCancel=void 0===_props2$onCancel?emptyFn:_props2$onCancel,_props2$onOk=_props2.onOk,onOk=void 0===_props2$onOk?emptyFn:_props2$onOk,_props2$onClose=_props2.onClose,onClose=void 0===_props2$onClose?emptyFn:_props2$onClose,_props2$onBack=_props2.onBack,onBack=void 0===_props2$onBack?emptyFn:_props2$onBack,content=_props2.content,style={};return"100%"===width?style={width:width,marginLeft:0,left:0,borderRadius:0}:(width-=0,style={width:width,marginLeft:-(width/2)}),_react2["default"].createElement("div",{className:(0,_classnames8["default"])("im-dialog","im-dialog-"+position,_defineProperty({hide:!visible},""+dialogCls,!!dialogCls))},_react2["default"].createElement("div",{className:(0,_classnames8["default"])("im-dialog-mask",_defineProperty({},""+maskCls,!!maskCls))}),_react2["default"].createElement("div",{className:(0,_classnames8["default"])("im-dialog-main",_defineProperty({},""+maskCls,!!maskCls)),style:style},closeBtn&&_react2["default"].createElement("a",{href:"javascript:;",className:"btn-close",onClick:function onClick(){onCancel(),onClose()}},"×"),title&&_react2["default"].createElement("div",{className:(0,_classnames8["default"])("im-dialog-header",_defineProperty({},""+headerCls,!!headerCls))},backBtn&&_react2["default"].createElement("a",{href:"javascript:;",className:"btn-back",onClick:function onClick(){onBack(),onClose()}},_react2["default"].createElement("em",{className:"webim-icons24 icons24-back "})),_react2["default"].createElement("span",{className:"title"},"string"==typeof title?title:"")),_react2["default"].createElement("div",{className:(0,_classnames8["default"])("im-dialog-content",_defineProperty({},""+contentCls,!!contentCls))},children||content),this.renderFooter()))}}]),DialogContent}(_react.Component),DialogContent.defaultProps={cls:{}},Dialog=function(_Component2){function Dialog(props){return _classCallCheck(this,Dialog),_possibleConstructorReturn(this,(Dialog.__proto__||Object.getPrototypeOf(Dialog)).call(this,props))}return _inherits(Dialog,_Component2),_createClass(Dialog,[{key:"componentDidMount",value:function componentDidMount(){this.appendDialog()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.appendDialog()}},{key:"appendDialog",value:function appendDialog(){var _props3=this.props,id=_props3.id,_props3$parent=_props3.parent,parent=void 0===_props3$parent?"panel":_props3$parent,dialogOrigin=$("#"+parent+"-dialog-container"),dialog=dialogOrigin;id&&(dialog=$("#"+parent+"-dialog-container-"+id),dialog.length||(dialog=$(dialogOrigin).after('<div id="'+parent+"-dialog-container-"+id+'"></div>'))),dialog.length&&_reactDom2["default"].unstable_renderSubtreeIntoContainer(this,_react2["default"].createElement(DialogContent,this.props),dialog[0])}},{key:"render",value:function render(){return null}}]),Dialog}(_react.Component),Dialog.propTypes={parent:_react.PropTypes.string,cls:_react.PropTypes.object,title:_react.PropTypes.oneOfType([_react.PropTypes.bool,_react.PropTypes.string]),footer:_react.PropTypes.oneOfType([_react.PropTypes.bool,_react.PropTypes.element]),backBtn:_react.PropTypes.bool,onCancel:_react.PropTypes.func,onOk:_react.PropTypes.func,onBack:_react.PropTypes.func,okVal:_react.PropTypes.string,cancelVal:_react.PropTypes.string,width:_react.PropTypes.oneOfType([_react.PropTypes.number,_react.PropTypes.string]),content:_react.PropTypes.oneOfType([_react.PropTypes.element,_react.PropTypes.string]),closeBtn:_react.PropTypes.bool,position:_react.PropTypes.oneOf(["bottom","center"])},Dialog.closeAllConfirm=function(props){var _props$parent2=props.parent,parent=void 0===_props$parent2?"panel":_props$parent2,$confirm=$("#"+parent+"-dialog-container-confirm");$confirm.length&&_reactDom2["default"].unmountComponentAtNode($confirm[0])},Dialog.confirm=function(props){var config=Object.assign({footer:!0,width:200,position:"center",visible:!0},props);return confirm(config)},Dialog.info=function(props){var config=Object.assign({footer:!1,width:200,position:"center",visible:!0,closeBtn:!1},props);return confirm(config)},alertFooter=function alertFooter(props){var _props$onOk2=props.onOk,onOk=void 0===_props$onOk2?function(){}:_props$onOk2,_props$onClose2=props.onClose,onClose=void 0===_props$onClose2?function(){}:_props$onClose2;return _react2["default"].createElement("div",{className:"im-dialog-footer im-dialog-alert-footer"},_react2["default"].createElement("a",{className:"btn-ok",href:"javascript:;",onClick:function onClick(){onOk(),onClose()}},"确 定"))},Dialog.alert=function(props){var config=Object.assign({footer:alertFooter,width:200,position:"center",visible:!0},props);return confirm(config)},exports["default"]=Dialog,exports.ChatDialog=ChatDialog,exports.MainDialog=MainDialog,exports.PanelDialog=PanelDialog},function(module,exports,__webpack_require__){(function(process){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function isCrushed(){}var _createStore,_createStore2,_combineReducers,_combineReducers2,_bindActionCreators,_bindActionCreators2,_applyMiddleware,_applyMiddleware2,_compose,_compose2,_warning,_warning2;exports.__esModule=!0,exports.compose=exports.applyMiddleware=exports.bindActionCreators=exports.combineReducers=exports.createStore=void 0,_createStore=__webpack_require__(121),_createStore2=_interopRequireDefault(_createStore),_combineReducers=__webpack_require__(129),_combineReducers2=_interopRequireDefault(_combineReducers),_bindActionCreators=__webpack_require__(131),_bindActionCreators2=_interopRequireDefault(_bindActionCreators),_applyMiddleware=__webpack_require__(132),_applyMiddleware2=_interopRequireDefault(_applyMiddleware),_compose=__webpack_require__(133),_compose2=_interopRequireDefault(_compose),_warning=__webpack_require__(130),_warning2=_interopRequireDefault(_warning),"production"!==process.env.NODE_ENV&&"string"==typeof isCrushed.name&&"isCrushed"!==isCrushed.name&&(0,_warning2["default"])("You are currently using minified code outside of NODE_ENV === 'production'. This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) to ensure you have the correct code for your production build."),exports.createStore=_createStore2["default"],exports.combineReducers=_combineReducers2["default"],exports.bindActionCreators=_bindActionCreators2["default"],exports.applyMiddleware=_applyMiddleware2["default"],exports.compose=_compose2["default"]}).call(exports,__webpack_require__(8))},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function createStore(reducer,initialState,enhancer){function ensureCanMutateNextListeners(){nextListeners===currentListeners&&(nextListeners=currentListeners.slice())}function getState(){return currentState}function subscribe(listener){if("function"!=typeof listener)throw new Error("Expected listener to be a function.");var isSubscribed=!0;return ensureCanMutateNextListeners(),nextListeners.push(listener),function unsubscribe(){if(isSubscribed){isSubscribed=!1,ensureCanMutateNextListeners();var index=nextListeners.indexOf(listener);nextListeners.splice(index,1)}}}function dispatch(action){var listeners,i;if(!(0,_isPlainObject2["default"])(action))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"==typeof action.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(isDispatching)throw new Error("Reducers may not dispatch actions.");try{isDispatching=!0,currentState=currentReducer(currentState,action)}finally{isDispatching=!1}for(listeners=currentListeners=nextListeners,i=0;i<listeners.length;i++)listeners[i]();return action}function replaceReducer(nextReducer){if("function"!=typeof nextReducer)throw new Error("Expected the nextReducer to be a function.");currentReducer=nextReducer,dispatch({type:ActionTypes.INIT})}function observable(){var _ref,outerSubscribe=subscribe;return _ref={subscribe:function subscribe(observer){function observeState(){observer.next&&observer.next(getState())}if("object"!==("undefined"==typeof observer?"undefined":_typeof(observer)))throw new TypeError("Expected the observer to be an object.");observeState();var unsubscribe=outerSubscribe(observeState);return{unsubscribe:unsubscribe}}},_ref[_symbolObservable2["default"]]=function(){return this},_ref}var _ref2,currentReducer,currentState,currentListeners,nextListeners,isDispatching;if("function"==typeof initialState&&"undefined"==typeof enhancer&&(enhancer=initialState,initialState=void 0),"undefined"!=typeof enhancer){if("function"!=typeof enhancer)throw new Error("Expected the enhancer to be a function.");return enhancer(createStore)(reducer,initialState)}if("function"!=typeof reducer)throw new Error("Expected the reducer to be a function.");return currentReducer=reducer,currentState=initialState,currentListeners=[],nextListeners=currentListeners,isDispatching=!1,dispatch({type:ActionTypes.INIT}),_ref2={dispatch:dispatch,subscribe:subscribe,getState:getState,replaceReducer:replaceReducer},_ref2[_symbolObservable2["default"]]=observable,_ref2}var _isPlainObject,_isPlainObject2,_symbolObservable,_symbolObservable2,ActionTypes,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.__esModule=!0,exports.ActionTypes=void 0,exports["default"]=createStore,_isPlainObject=__webpack_require__(122),_isPlainObject2=_interopRequireDefault(_isPlainObject),_symbolObservable=__webpack_require__(127),_symbolObservable2=_interopRequireDefault(_symbolObservable),ActionTypes=exports.ActionTypes={INIT:"@@redux/INIT"}},function(module,exports,__webpack_require__){"use strict";function isPlainObject(value){var proto,Ctor;return!(!isObjectLike(value)||objectToString.call(value)!=objectTag||isHostObject(value))&&(proto=getPrototype(value),null===proto||(Ctor=hasOwnProperty.call(proto,"constructor")&&proto.constructor,"function"==typeof Ctor&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString))}var getPrototype=__webpack_require__(123),isHostObject=__webpack_require__(125),isObjectLike=__webpack_require__(126),objectTag="[object Object]",funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object),objectToString=objectProto.toString;module.exports=isPlainObject},function(module,exports,__webpack_require__){"use strict";var overArg=__webpack_require__(124),getPrototype=overArg(Object.getPrototypeOf,Object);module.exports=getPrototype},function(module,exports){"use strict";function overArg(func,transform){return function(arg){return func(transform(arg))}}module.exports=overArg},function(module,exports){"use strict";function isHostObject(value){var result=!1;if(null!=value&&"function"!=typeof value.toString)try{result=!!(value+"")}catch(e){}return result}module.exports=isHostObject},function(module,exports){"use strict";function isObjectLike(value){return!!value&&"object"==("undefined"==typeof value?"undefined":_typeof(value))}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};module.exports=isObjectLike},function(module,exports,__webpack_require__){(function(global){"use strict";module.exports=__webpack_require__(128)(global||window||void 0)}).call(exports,function(){return this}())},function(module,exports){"use strict";module.exports=function symbolObservablePonyfill(root){var result,_Symbol=root.Symbol;return"function"==typeof _Symbol?_Symbol.observable?result=_Symbol.observable:(result=_Symbol("observable"),_Symbol.observable=result):result="@@observable",result}},function(module,exports,__webpack_require__){(function(process){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function getUndefinedStateErrorMessage(key,action){var actionType=action&&action.type,actionName=actionType&&'"'+actionType.toString()+'"'||"an action";return"Given action "+actionName+', reducer "'+key+'" returned undefined. To ignore an action, you must explicitly return the previous state.'}function getUnexpectedStateShapeWarningMessage(inputState,reducers,action){var unexpectedKeys,reducerKeys=Object.keys(reducers),argumentName=action&&action.type===_createStore.ActionTypes.INIT?"initialState argument passed to createStore":"previous state received by the reducer";return 0===reducerKeys.length?"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.":(0,_isPlainObject2["default"])(inputState)?(unexpectedKeys=Object.keys(inputState).filter(function(key){return!reducers.hasOwnProperty(key)}),unexpectedKeys.length>0?"Unexpected "+(unexpectedKeys.length>1?"keys":"key")+" "+('"'+unexpectedKeys.join('", "')+'" found in '+argumentName+". ")+"Expected to find one of the known reducer keys instead: "+('"'+reducerKeys.join('", "')+'". Unexpected keys will be ignored.'):void 0):"The "+argumentName+' has unexpected type of "'+{}.toString.call(inputState).match(/\s([a-z|A-Z]+)/)[1]+'". Expected argument to be an object with the following '+('keys: "'+reducerKeys.join('", "')+'"')}function assertReducerSanity(reducers){Object.keys(reducers).forEach(function(key){var type,reducer=reducers[key],initialState=reducer(void 0,{type:_createStore.ActionTypes.INIT});if("undefined"==typeof initialState)throw new Error('Reducer "'+key+'" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined.');if(type="@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join("."),"undefined"==typeof reducer(void 0,{type:type}))throw new Error('Reducer "'+key+'" returned undefined when probed with a random type. '+("Don't try to handle "+_createStore.ActionTypes.INIT+' or other actions in "redux/*" ')+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined.")})}function combineReducers(reducers){var i,key,finalReducerKeys,sanityError,reducerKeys=Object.keys(reducers),finalReducers={};for(i=0;i<reducerKeys.length;i++)key=reducerKeys[i],"function"==typeof reducers[key]&&(finalReducers[key]=reducers[key]);finalReducerKeys=Object.keys(finalReducers);try{assertReducerSanity(finalReducers)}catch(e){sanityError=e}return function combination(){var warningMessage,hasChanged,nextState,i,key,reducer,previousStateForKey,nextStateForKey,errorMessage,state=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],action=arguments[1];if(sanityError)throw sanityError;for("production"!==process.env.NODE_ENV&&(warningMessage=getUnexpectedStateShapeWarningMessage(state,finalReducers,action),warningMessage&&(0,_warning2["default"])(warningMessage)),hasChanged=!1,nextState={},i=0;i<finalReducerKeys.length;i++){if(key=finalReducerKeys[i],reducer=finalReducers[key],previousStateForKey=state[key],nextStateForKey=reducer(previousStateForKey,action),"undefined"==typeof nextStateForKey)throw errorMessage=getUndefinedStateErrorMessage(key,action),new Error(errorMessage);nextState[key]=nextStateForKey,hasChanged=hasChanged||nextStateForKey!==previousStateForKey}return hasChanged?nextState:state}}var _createStore,_isPlainObject,_isPlainObject2,_warning,_warning2;exports.__esModule=!0,exports["default"]=combineReducers,_createStore=__webpack_require__(121),_isPlainObject=__webpack_require__(122),_isPlainObject2=_interopRequireDefault(_isPlainObject),_warning=__webpack_require__(130),_warning2=_interopRequireDefault(_warning)}).call(exports,__webpack_require__(8))},function(module,exports){"use strict";function warning(message){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(message);try{throw new Error(message)}catch(e){}}exports.__esModule=!0,exports["default"]=warning},function(module,exports){"use strict";function bindActionCreator(actionCreator,dispatch){return function(){return dispatch(actionCreator.apply(void 0,arguments))}}function bindActionCreators(actionCreators,dispatch){var keys,boundActionCreators,i,key,actionCreator;if("function"==typeof actionCreators)return bindActionCreator(actionCreators,dispatch);if("object"!==("undefined"==typeof actionCreators?"undefined":_typeof(actionCreators))||null===actionCreators)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===actionCreators?"null":"undefined"==typeof actionCreators?"undefined":_typeof(actionCreators))+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(keys=Object.keys(actionCreators),boundActionCreators={},i=0;i<keys.length;i++)key=keys[i],actionCreator=actionCreators[key],"function"==typeof actionCreator&&(boundActionCreators[key]=bindActionCreator(actionCreator,dispatch));return boundActionCreators}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.__esModule=!0,exports["default"]=bindActionCreators},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function applyMiddleware(){for(var _len=arguments.length,middlewares=Array(_len),_key=0;_key<_len;_key++)middlewares[_key]=arguments[_key];return function(createStore){return function(reducer,initialState,enhancer){var store=createStore(reducer,initialState,enhancer),_dispatch=store.dispatch,chain=[],middlewareAPI={getState:store.getState,dispatch:function dispatch(action){return _dispatch(action)}};return chain=middlewares.map(function(middleware){return middleware(middlewareAPI)}),_dispatch=_compose2["default"].apply(void 0,chain)(store.dispatch),_extends({},store,{dispatch:_dispatch})}}}var _extends,_compose,_compose2;exports.__esModule=!0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports["default"]=applyMiddleware,_compose=__webpack_require__(133),_compose2=_interopRequireDefault(_compose)},function(module,exports){"use strict";function compose(){var _len,funcs,_key,_ret;for(_len=arguments.length,funcs=Array(_len),_key=0;_key<_len;_key++)funcs[_key]=arguments[_key];return 0===funcs.length?function(arg){return arg}:(_ret=function(){var last=funcs[funcs.length-1],rest=funcs.slice(0,-1);return{v:function v(){return rest.reduceRight(function(composed,f){return f(composed)},last.apply(void 0,arguments))}}}(),"object"===("undefined"==typeof _ret?"undefined":_typeof(_ret))?_ret.v:void 0)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.__esModule=!0,exports["default"]=compose},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _Provider,_Provider2,_connect,_connect2;exports.__esModule=!0,exports.connect=exports.Provider=void 0,_Provider=__webpack_require__(135),_Provider2=_interopRequireDefault(_Provider),_connect=__webpack_require__(138),_connect2=_interopRequireDefault(_connect),exports.Provider=_Provider2["default"],exports.connect=_connect2["default"]},function(module,exports,__webpack_require__){(function(process){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!==("undefined"==typeof call?"undefined":_typeof(call))&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof superClass?"undefined":_typeof(superClass)));subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function warnAboutReceivingStore(){didWarnAboutReceivingStore||(didWarnAboutReceivingStore=!0,(0,_warning2["default"])("<Provider> does not support changing `store` on the fly. It is most likely that you see this error because you updated to Redux 2.x and React Redux 2.x which no longer hot reload reducers automatically. See https://github.com/reactjs/react-redux/releases/tag/v2.0.0 for the migration instructions."))}var _react,_storeShape,_storeShape2,_warning,_warning2,didWarnAboutReceivingStore,Provider,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.__esModule=!0,exports["default"]=void 0,_react=__webpack_require__(110),_storeShape=__webpack_require__(136),_storeShape2=_interopRequireDefault(_storeShape),_warning=__webpack_require__(137),_warning2=_interopRequireDefault(_warning),didWarnAboutReceivingStore=!1,Provider=function(_Component){function Provider(props,context){_classCallCheck(this,Provider);var _this=_possibleConstructorReturn(this,_Component.call(this,props,context));return _this.store=props.store,_this}return _inherits(Provider,_Component),Provider.prototype.getChildContext=function getChildContext(){return{store:this.store}},Provider.prototype.render=function render(){var children=this.props.children;return _react.Children.only(children)},Provider}(_react.Component),exports["default"]=Provider,"production"!==process.env.NODE_ENV&&(Provider.prototype.componentWillReceiveProps=function(nextProps){var store=this.store,nextStore=nextProps.store;store!==nextStore&&warnAboutReceivingStore()}),Provider.propTypes={store:_storeShape2["default"].isRequired,children:_react.PropTypes.element.isRequired},Provider.childContextTypes={store:_storeShape2["default"].isRequired}}).call(exports,__webpack_require__(8))},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _react=__webpack_require__(110);exports["default"]=_react.PropTypes.shape({subscribe:_react.PropTypes.func.isRequired,dispatch:_react.PropTypes.func.isRequired,getState:_react.PropTypes.func.isRequired})},function(module,exports){"use strict";function warning(message){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(message);try{throw new Error(message)}catch(e){}}exports.__esModule=!0,exports["default"]=warning},function(module,exports,__webpack_require__){(function(process){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!==("undefined"==typeof call?"undefined":_typeof(call))&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof superClass?"undefined":_typeof(superClass)));subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function getDisplayName(WrappedComponent){return WrappedComponent.displayName||WrappedComponent.name||"Component"}function tryCatch(fn,ctx){try{return fn.apply(ctx)}catch(e){return errorObject.value=e,errorObject}}function connect(mapStateToProps,mapDispatchToProps,mergeProps){var finalMergeProps,_options$pure,pure,_options$withRef,withRef,checkMergedEquals,version,options=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],shouldSubscribe=Boolean(mapStateToProps),mapState=mapStateToProps||defaultMapStateToProps,mapDispatch=void 0;return mapDispatch="function"==typeof mapDispatchToProps?mapDispatchToProps:mapDispatchToProps?(0,_wrapActionCreators2["default"])(mapDispatchToProps):defaultMapDispatchToProps,finalMergeProps=mergeProps||defaultMergeProps,_options$pure=options.pure,pure=void 0===_options$pure||_options$pure,_options$withRef=options.withRef,withRef=void 0!==_options$withRef&&_options$withRef,checkMergedEquals=pure&&finalMergeProps!==defaultMergeProps,version=nextVersion++,function wrapWithConnect(WrappedComponent){function checkStateShape(props,methodName){(0,_isPlainObject2["default"])(props)||(0,
_warning2["default"])(methodName+"() in "+connectDisplayName+" must return a plain object. "+("Instead received "+props+"."))}function computeMergedProps(stateProps,dispatchProps,parentProps){var mergedProps=finalMergeProps(stateProps,dispatchProps,parentProps);return"production"!==process.env.NODE_ENV&&checkStateShape(mergedProps,"mergeProps"),mergedProps}var connectDisplayName="Connect("+getDisplayName(WrappedComponent)+")",Connect=function(_Component){function Connect(props,context){var _this,storeState;return _classCallCheck(this,Connect),_this=_possibleConstructorReturn(this,_Component.call(this,props,context)),_this.version=version,_this.store=props.store||context.store,(0,_invariant2["default"])(_this.store,'Could not find "store" in either the context or '+('props of "'+connectDisplayName+'". ')+"Either wrap the root component in a <Provider>, "+('or explicitly pass "store" as a prop to "'+connectDisplayName+'".')),storeState=_this.store.getState(),_this.state={storeState:storeState},_this.clearCache(),_this}return _inherits(Connect,_Component),Connect.prototype.shouldComponentUpdate=function shouldComponentUpdate(){return!pure||this.haveOwnPropsChanged||this.hasStoreStateChanged},Connect.prototype.computeStateProps=function computeStateProps(store,props){var state,stateProps;return this.finalMapStateToProps?(state=store.getState(),stateProps=this.doStatePropsDependOnOwnProps?this.finalMapStateToProps(state,props):this.finalMapStateToProps(state),"production"!==process.env.NODE_ENV&&checkStateShape(stateProps,"mapStateToProps"),stateProps):this.configureFinalMapState(store,props)},Connect.prototype.configureFinalMapState=function configureFinalMapState(store,props){var mappedState=mapState(store.getState(),props),isFactory="function"==typeof mappedState;return this.finalMapStateToProps=isFactory?mappedState:mapState,this.doStatePropsDependOnOwnProps=1!==this.finalMapStateToProps.length,isFactory?this.computeStateProps(store,props):("production"!==process.env.NODE_ENV&&checkStateShape(mappedState,"mapStateToProps"),mappedState)},Connect.prototype.computeDispatchProps=function computeDispatchProps(store,props){var dispatch,dispatchProps;return this.finalMapDispatchToProps?(dispatch=store.dispatch,dispatchProps=this.doDispatchPropsDependOnOwnProps?this.finalMapDispatchToProps(dispatch,props):this.finalMapDispatchToProps(dispatch),"production"!==process.env.NODE_ENV&&checkStateShape(dispatchProps,"mapDispatchToProps"),dispatchProps):this.configureFinalMapDispatch(store,props)},Connect.prototype.configureFinalMapDispatch=function configureFinalMapDispatch(store,props){var mappedDispatch=mapDispatch(store.dispatch,props),isFactory="function"==typeof mappedDispatch;return this.finalMapDispatchToProps=isFactory?mappedDispatch:mapDispatch,this.doDispatchPropsDependOnOwnProps=1!==this.finalMapDispatchToProps.length,isFactory?this.computeDispatchProps(store,props):("production"!==process.env.NODE_ENV&&checkStateShape(mappedDispatch,"mapDispatchToProps"),mappedDispatch)},Connect.prototype.updateStatePropsIfNeeded=function updateStatePropsIfNeeded(){var nextStateProps=this.computeStateProps(this.store,this.props);return(!this.stateProps||!(0,_shallowEqual2["default"])(nextStateProps,this.stateProps))&&(this.stateProps=nextStateProps,!0)},Connect.prototype.updateDispatchPropsIfNeeded=function updateDispatchPropsIfNeeded(){var nextDispatchProps=this.computeDispatchProps(this.store,this.props);return(!this.dispatchProps||!(0,_shallowEqual2["default"])(nextDispatchProps,this.dispatchProps))&&(this.dispatchProps=nextDispatchProps,!0)},Connect.prototype.updateMergedPropsIfNeeded=function updateMergedPropsIfNeeded(){var nextMergedProps=computeMergedProps(this.stateProps,this.dispatchProps,this.props);return!(this.mergedProps&&checkMergedEquals&&(0,_shallowEqual2["default"])(nextMergedProps,this.mergedProps))&&(this.mergedProps=nextMergedProps,!0)},Connect.prototype.isSubscribed=function isSubscribed(){return"function"==typeof this.unsubscribe},Connect.prototype.trySubscribe=function trySubscribe(){shouldSubscribe&&!this.unsubscribe&&(this.unsubscribe=this.store.subscribe(this.handleChange.bind(this)),this.handleChange())},Connect.prototype.tryUnsubscribe=function tryUnsubscribe(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)},Connect.prototype.componentDidMount=function componentDidMount(){this.trySubscribe()},Connect.prototype.componentWillReceiveProps=function componentWillReceiveProps(nextProps){pure&&(0,_shallowEqual2["default"])(nextProps,this.props)||(this.haveOwnPropsChanged=!0)},Connect.prototype.componentWillUnmount=function componentWillUnmount(){this.tryUnsubscribe(),this.clearCache()},Connect.prototype.clearCache=function clearCache(){this.dispatchProps=null,this.stateProps=null,this.mergedProps=null,this.haveOwnPropsChanged=!0,this.hasStoreStateChanged=!0,this.haveStatePropsBeenPrecalculated=!1,this.statePropsPrecalculationError=null,this.renderedElement=null,this.finalMapDispatchToProps=null,this.finalMapStateToProps=null},Connect.prototype.handleChange=function handleChange(){var storeState,prevStoreState,haveStatePropsChanged;if(this.unsubscribe&&(storeState=this.store.getState(),prevStoreState=this.state.storeState,!pure||prevStoreState!==storeState)){if(pure&&!this.doStatePropsDependOnOwnProps){if(haveStatePropsChanged=tryCatch(this.updateStatePropsIfNeeded,this),!haveStatePropsChanged)return;haveStatePropsChanged===errorObject&&(this.statePropsPrecalculationError=errorObject.value),this.haveStatePropsBeenPrecalculated=!0}this.hasStoreStateChanged=!0,this.setState({storeState:storeState})}},Connect.prototype.getWrappedInstance=function getWrappedInstance(){return(0,_invariant2["default"])(withRef,"To access the wrapped instance, you need to specify { withRef: true } as the fourth argument of the connect() call."),this.refs.wrappedInstance},Connect.prototype.render=function render(){var shouldUpdateStateProps,shouldUpdateDispatchProps,haveStatePropsChanged,haveDispatchPropsChanged,haveMergedPropsChanged,haveOwnPropsChanged=this.haveOwnPropsChanged,hasStoreStateChanged=this.hasStoreStateChanged,haveStatePropsBeenPrecalculated=this.haveStatePropsBeenPrecalculated,statePropsPrecalculationError=this.statePropsPrecalculationError,renderedElement=this.renderedElement;if(this.haveOwnPropsChanged=!1,this.hasStoreStateChanged=!1,this.haveStatePropsBeenPrecalculated=!1,this.statePropsPrecalculationError=null,statePropsPrecalculationError)throw statePropsPrecalculationError;return shouldUpdateStateProps=!0,shouldUpdateDispatchProps=!0,pure&&renderedElement&&(shouldUpdateStateProps=hasStoreStateChanged||haveOwnPropsChanged&&this.doStatePropsDependOnOwnProps,shouldUpdateDispatchProps=haveOwnPropsChanged&&this.doDispatchPropsDependOnOwnProps),haveStatePropsChanged=!1,haveDispatchPropsChanged=!1,haveStatePropsBeenPrecalculated?haveStatePropsChanged=!0:shouldUpdateStateProps&&(haveStatePropsChanged=this.updateStatePropsIfNeeded()),shouldUpdateDispatchProps&&(haveDispatchPropsChanged=this.updateDispatchPropsIfNeeded()),haveMergedPropsChanged=!0,haveMergedPropsChanged=!!(haveStatePropsChanged||haveDispatchPropsChanged||haveOwnPropsChanged)&&this.updateMergedPropsIfNeeded(),!haveMergedPropsChanged&&renderedElement?renderedElement:(withRef?this.renderedElement=(0,_react.createElement)(WrappedComponent,_extends({},this.mergedProps,{ref:"wrappedInstance"})):this.renderedElement=(0,_react.createElement)(WrappedComponent,this.mergedProps),this.renderedElement)},Connect}(_react.Component);return Connect.displayName=connectDisplayName,Connect.WrappedComponent=WrappedComponent,Connect.contextTypes={store:_storeShape2["default"]},Connect.propTypes={store:_storeShape2["default"]},"production"!==process.env.NODE_ENV&&(Connect.prototype.componentWillUpdate=function componentWillUpdate(){this.version!==version&&(this.version=version,this.trySubscribe(),this.clearCache())}),(0,_hoistNonReactStatics2["default"])(Connect,WrappedComponent)}}var _react,_storeShape,_storeShape2,_shallowEqual,_shallowEqual2,_wrapActionCreators,_wrapActionCreators2,_warning,_warning2,_isPlainObject,_isPlainObject2,_hoistNonReactStatics,_hoistNonReactStatics2,_invariant,_invariant2,defaultMapStateToProps,defaultMapDispatchToProps,defaultMergeProps,errorObject,nextVersion,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};exports.__esModule=!0,exports["default"]=connect,_react=__webpack_require__(110),_storeShape=__webpack_require__(136),_storeShape2=_interopRequireDefault(_storeShape),_shallowEqual=__webpack_require__(139),_shallowEqual2=_interopRequireDefault(_shallowEqual),_wrapActionCreators=__webpack_require__(140),_wrapActionCreators2=_interopRequireDefault(_wrapActionCreators),_warning=__webpack_require__(137),_warning2=_interopRequireDefault(_warning),_isPlainObject=__webpack_require__(122),_isPlainObject2=_interopRequireDefault(_isPlainObject),_hoistNonReactStatics=__webpack_require__(141),_hoistNonReactStatics2=_interopRequireDefault(_hoistNonReactStatics),_invariant=__webpack_require__(142),_invariant2=_interopRequireDefault(_invariant),defaultMapStateToProps=function defaultMapStateToProps(state){return{}},defaultMapDispatchToProps=function defaultMapDispatchToProps(dispatch){return{dispatch:dispatch}},defaultMergeProps=function defaultMergeProps(stateProps,dispatchProps,parentProps){return _extends({},parentProps,stateProps,dispatchProps)},errorObject={value:null},nextVersion=0}).call(exports,__webpack_require__(8))},function(module,exports){"use strict";function shallowEqual(objA,objB){var keysA,keysB,hasOwn,i;if(objA===objB)return!0;if(keysA=Object.keys(objA),keysB=Object.keys(objB),keysA.length!==keysB.length)return!1;for(hasOwn=Object.prototype.hasOwnProperty,i=0;i<keysA.length;i++)if(!hasOwn.call(objB,keysA[i])||objA[keysA[i]]!==objB[keysA[i]])return!1;return!0}exports.__esModule=!0,exports["default"]=shallowEqual},function(module,exports,__webpack_require__){"use strict";function wrapActionCreators(actionCreators){return function(dispatch){return(0,_redux.bindActionCreators)(actionCreators,dispatch)}}exports.__esModule=!0,exports["default"]=wrapActionCreators;var _redux=__webpack_require__(120)},function(module,exports){"use strict";var REACT_STATICS={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,mixins:!0,propTypes:!0,type:!0},KNOWN_STATICS={name:!0,length:!0,prototype:!0,caller:!0,arguments:!0,arity:!0},isGetOwnPropertySymbolsAvailable="function"==typeof Object.getOwnPropertySymbols;module.exports=function hoistNonReactStatics(targetComponent,sourceComponent,customStatics){var keys,i;if("string"!=typeof sourceComponent)for(keys=Object.getOwnPropertyNames(sourceComponent),isGetOwnPropertySymbolsAvailable&&(keys=keys.concat(Object.getOwnPropertySymbols(sourceComponent))),i=0;i<keys.length;++i)if(!(REACT_STATICS[keys[i]]||KNOWN_STATICS[keys[i]]||customStatics&&customStatics[keys[i]]))try{targetComponent[keys[i]]=sourceComponent[keys[i]]}catch(error){}return targetComponent}},function(module,exports,__webpack_require__){(function(process){"use strict";var invariant=function invariant(condition,format,a,b,c,d,e,f){var error,args,argIndex;if("production"!==process.env.NODE_ENV&&void 0===format)throw new Error("invariant requires an error message argument");if(!condition)throw void 0===format?error=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings."):(args=[a,b,c,d,e,f],argIndex=0,error=new Error(format.replace(/%s/g,function(){return args[argIndex++]})),error.name="Invariant Violation"),error.framesToPop=1,error};module.exports=invariant}).call(exports,__webpack_require__(8))},function(module,exports){"use strict";var PANEL_RECEIVE_MSG,PANEL_SEND_MSG,PANEL_UPDATE_MSG,PANEL_CONN_MSG,OPEN_PANEL,CLOSE_PANEL,INIT_TAB,SELECT_TAB,SELECT_CONTACT,UNSELECT_ACTIVE_CONTACT,SET_PANEL_UNREAD,SET_TABS_UNREAD,SET_CONTACTS_UNREAD,SELECT_CONTACT_CANSEND_ERR,SELECT_CONTACT_START,UPDATE_MSGLIST,SELECT_SNS,GET_CONTACTS_START,GET_CONTACTS_SUCC,GET_CONTACTS_FAIL,DELETE_CONTACT,UPDATE_CONTACTS_BY_SEND_MSG,UPDATE_CONTACTS_BY_RECEIVE_MSG,UPDATE_READED_MSG,UPDATE_CONTACT_READED_MSG,GET_NOTICELIST_START,GET_NOTICELIST_SUCC,GET_NOTICELIST_FAIL,DELETE_NOTICEITEM,HASREAD_NOTICE,UNSELECT_NOTICE,READ_NOTICE,DRAG_DISTANCE,DRAG_DONE,GET_INITIAL_SERVER_HISTORY,CLEAR_INITIAL_SERVER_HISTORY,SHOW_HISTORY,HIDE_HISTORY,GET_SERVER_HISTORY_STARTED,GET_SERVER_HISTORY_SUCCESS,GET_SERVER_HISTORY_FAILED,GET_INITIAL_SERVER_HISTORY_START,GET_INITIAL_SERVER_HISTORY_FAIL,UPDATE_INITIAL_SERVER_HISTORY,GET_HISTORYCONTACTS_START,GET_HISTORYCONTACTS_SUCC,GET_HISTORYCONTACTS_FAIL,UPDATE_HISTORYCONTACTS_BY_SEND_MSG,UPDATE_HISTORYCONTACTS_BY_RECEIVE_MSG,UPDATE_HISTORYCONTACT_READED_MSG,OPEN_SETTING,SELECT_SETTING,OPEN_SETGREETING,SETGREETING_LIST,SELECT_GREETING,OPEN_TOAST,CLOSE_TOAST,GET_ISATTENTION,UPDATE_ATTENTION,USERSETTING_DIALOG,INBLACK_STATUS,INBLACK_DIALOG,REPORT_CODE,REPORT_DIALOG,REFUSEJOB_CODE,REFUSEJOB_DIALOG,SEND_IMG_FAIL,SEND_IMG_SUCC,SEND_IMG_START;Object.defineProperty(exports,"__esModule",{value:!0}),PANEL_RECEIVE_MSG=exports.PANEL_RECEIVE_MSG="PANEL_RECEIVE_MSG",PANEL_SEND_MSG=exports.PANEL_SEND_MSG="PANEL_SEND_MSG",PANEL_UPDATE_MSG=exports.PANEL_UPDATE_MSG="PANEL_UPDATE_MSG",PANEL_CONN_MSG=exports.PANEL_CONN_MSG="PANEL_CONN_MSG",OPEN_PANEL=exports.OPEN_PANEL="OPEN_PANEL",CLOSE_PANEL=exports.CLOSE_PANEL="CLOSE_PANEL",INIT_TAB=exports.INIT_TAB="INIT_TAB",SELECT_TAB=exports.SELECT_TAB="SELECT_TAB",SELECT_CONTACT=exports.SELECT_CONTACT="SELECT_CONTACT",UNSELECT_ACTIVE_CONTACT=exports.UNSELECT_ACTIVE_CONTACT="UNSELECT_ACTIVE_CONTACT",SET_PANEL_UNREAD=exports.SET_PANEL_UNREAD="SET_PANEL_UNREAD",SET_TABS_UNREAD=exports.SET_TABS_UNREAD="SET_TABS_UNREAD",SET_CONTACTS_UNREAD=exports.SET_CONTACTS_UNREAD="SET_CONTACTS_UNREAD",SELECT_CONTACT_CANSEND_ERR=exports.SELECT_CONTACT_CANSEND_ERR="SELECT_CONTACT_CANSEND_ERR",SELECT_CONTACT_START=exports.SELECT_CONTACT_START="SELECT_CONTACT_START",UPDATE_MSGLIST=exports.UPDATE_MSGLIST="UPDATE_MSGLIST",SELECT_SNS=exports.SELECT_SNS="SELECT_SNS",GET_CONTACTS_START=exports.GET_CONTACTS_START="GET_CONTACTS_START",GET_CONTACTS_SUCC=exports.GET_CONTACTS_SUCC="GET_CONTACTS_SUCC",GET_CONTACTS_FAIL=exports.GET_CONTACTS_FAIL="GET_CONTACTS_FAIL",DELETE_CONTACT=exports.DELETE_CONTACT="DELETE_CONTACT",UPDATE_CONTACTS_BY_SEND_MSG=exports.UPDATE_CONTACTS_BY_SEND_MSG="UPDATE_CONTACTS_BY_SEND_MSG",UPDATE_CONTACTS_BY_RECEIVE_MSG=exports.UPDATE_CONTACTS_BY_RECEIVE_MSG="UPDATE_CONTACTS_BY_RECEIVE_MSG",UPDATE_READED_MSG=exports.UPDATE_READED_MSG="UPDATE_READED_MSG",UPDATE_CONTACT_READED_MSG=exports.UPDATE_CONTACT_READED_MSG="UPDATE_CONTACT_READED_MSG",GET_NOTICELIST_START=exports.GET_NOTICELIST_START="GET_NOTICELIST_START",GET_NOTICELIST_SUCC=exports.GET_NOTICELIST_SUCC="GET_NOTICELIST_SUCC",GET_NOTICELIST_FAIL=exports.GET_NOTICELIST_FAIL="GET_NOTICELIST_FAIL",DELETE_NOTICEITEM=exports.DELETE_NOTICEITEM="DELETE_NOTICEITEM",HASREAD_NOTICE=exports.HASREAD_NOTICE="HASREAD_NOTICE",UNSELECT_NOTICE=exports.UNSELECT_NOTICE="UNSELECT_NOTICE",READ_NOTICE=exports.READ_NOTICE="READ_NOTICE",DRAG_DISTANCE=exports.DRAG_DISTANCE="DRAG_DISTANCE",DRAG_DONE=exports.DRAG_DONE="DRAG_DONE",GET_INITIAL_SERVER_HISTORY=exports.GET_INITIAL_SERVER_HISTORY="GET_INITIAL_SERVER_HISTORY",CLEAR_INITIAL_SERVER_HISTORY=exports.CLEAR_INITIAL_SERVER_HISTORY="CLEAR_INITIAL_SERVER_HISTORY",SHOW_HISTORY=exports.SHOW_HISTORY="SHOW_HISTORY",HIDE_HISTORY=exports.HIDE_HISTORY="HIDE_HISTORY",GET_SERVER_HISTORY_STARTED=exports.GET_SERVER_HISTORY_STARTED="GET_SERVER_HISTORY_STARTED",GET_SERVER_HISTORY_SUCCESS=exports.GET_SERVER_HISTORY_SUCCESS="GET_SERVER_HISTORY_SUCCESS",GET_SERVER_HISTORY_FAILED=exports.GET_SERVER_HISTORY_FAILED="GET_SERVER_HISTORY_FAILED",GET_INITIAL_SERVER_HISTORY_START=exports.GET_INITIAL_SERVER_HISTORY_START="GET_INITIAL_SERVER_HISTORY_START",GET_INITIAL_SERVER_HISTORY_FAIL=exports.GET_INITIAL_SERVER_HISTORY_FAIL="GET_INITIAL_SERVER_HISTORY_FAIL",UPDATE_INITIAL_SERVER_HISTORY=exports.UPDATE_INITIAL_SERVER_HISTORY="UPDATE_INITIAL_SERVER_HISTORY",GET_HISTORYCONTACTS_START=exports.GET_HISTORYCONTACTS_START="GET_HISTORYCONTACTS_START",GET_HISTORYCONTACTS_SUCC=exports.GET_HISTORYCONTACTS_SUCC="GET_HISTORYCONTACTS_SUCC",GET_HISTORYCONTACTS_FAIL=exports.GET_HISTORYCONTACTS_FAIL="GET_HISTORYCONTACTS_FAIL",UPDATE_HISTORYCONTACTS_BY_SEND_MSG=exports.UPDATE_HISTORYCONTACTS_BY_SEND_MSG="UPDATE_HISTORYCONTACTS_BY_SEND_MSG",UPDATE_HISTORYCONTACTS_BY_RECEIVE_MSG=exports.UPDATE_HISTORYCONTACTS_BY_RECEIVE_MSG="UPDATE_HISTORYCONTACTS_BY_RECEIVE_MSG",UPDATE_HISTORYCONTACT_READED_MSG=exports.UPDATE_HISTORYCONTACT_READED_MSG="UPDATE_HISTORYCONTACT_READED_MSG",OPEN_SETTING=exports.OPEN_SETTING="OPEN_SETTING",SELECT_SETTING=exports.SELECT_SETTING="SELECT_SETTING",OPEN_SETGREETING=exports.OPEN_SETGREETING="OPEN_SETGREETING",SETGREETING_LIST=exports.SETGREETING_LIST="SETGREETING_LIST",SELECT_GREETING=exports.SELECT_GREETING="SELECT_GREETING",OPEN_TOAST=exports.OPEN_TOAST="OPEN_TOAST",CLOSE_TOAST=exports.CLOSE_TOAST="CLOSE_TOAST",GET_ISATTENTION=exports.GET_ISATTENTION="GET_ISATTENTION",UPDATE_ATTENTION=exports.UPDATE_ATTENTION="UPDATE_ATTENTION",USERSETTING_DIALOG=exports.USERSETTING_DIALOG="USER_SETTING",INBLACK_STATUS=exports.INBLACK_STATUS="INBLACK_STATUS",INBLACK_DIALOG=exports.INBLACK_DIALOG="INBLACK_DIALOG",REPORT_CODE=exports.REPORT_CODE="REPORT_CODE",REPORT_DIALOG=exports.REPORT_DIALOG="REPORT_DIALOG",REFUSEJOB_CODE=exports.REFUSEJOB_CODE="REFUSEJOB_CODE",REFUSEJOB_DIALOG=exports.REFUSEJOB_DIALOG="REFUSEJOB_DIALOG",SEND_IMG_FAIL=exports.SEND_IMG_FAIL="SEND_IMG_FAIL",SEND_IMG_SUCC=exports.SEND_IMG_SUCC="SEND_IMG_SUCC",SEND_IMG_START=exports.SEND_IMG_START="SEND_IMG_START"},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,_typeof;_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},function(){"use strict";function classNames(){var i,arg,argType,key,classes=[];for(i=0;i<arguments.length;i++)if(arg=arguments[i])if(argType="undefined"==typeof arg?"undefined":_typeof(arg),"string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg))classes.push(classNames.apply(null,arg));else if("object"===argType)for(key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key);return classes.join(" ")}var hasOwn={}.hasOwnProperty;"undefined"!=typeof module&&module.exports?module.exports=classNames:"object"===_typeof(__webpack_require__(6))&&__webpack_require__(6)?(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))):window.classNames=classNames}()},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function setImConfig(){var env=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"c";switch(env.toLowerCase()){case"c":return _c.config;case"b":return _b.config;case"h":return _h.config}}var _c,_b,_h;Object.defineProperty(exports,"__esModule",{value:!0}),exports.setImConfig=setImConfig,_c=__webpack_require__(147),_b=__webpack_require__(148),_h=__webpack_require__(149)},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var config=exports.config={domain:LT.Env.cRoot,ajaxUrl:{getcurrentuserinfo:LT.Env.cRoot+"user/getcurrentuserinfo.json",handlesend:LT.Env.cRoot+"msg/handlesend.json",handlereceive:LT.Env.cRoot+"msg/handlereceive.json",loadjobinfo:LT.Env.wwwRoot+"job/loadjobinfo.json"}}},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var config=exports.config={domain:LT.Env.lptRoot,ajaxUrl:{getcurrentuserinfo:LT.Env.lptRoot+"user/getcurrentuserinfo.json",handlesend:LT.Env.lptRoot+"msg/handlesend.json",handlereceive:LT.Env.lptRoot+"msg/handlereceive.json",loadresumeinfo:LT.Env.lptRoot+"im/loadresumeinfo.json",loadjobinfo:LT.Env.lptRoot+"ejob/loadjobinfo.json",saveemmessage:LT.Env.lptRoot+"/message/saveemmessage.json"}}},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var config=exports.config={domain:LT.Env.hRoot,ajaxUrl:{getcurrentuserinfo:LT.Env.hRoot+"user/getcurrentuserinfo.json",handlesend:LT.Env.hRoot+"message/handlesend.json",handlereceive:LT.Env.hRoot+"message/handlereceive.json",loadresumeinfo:LT.Env.hRoot+"im/loadresumeinfo.json",loadjobinfo:LT.Env.hRoot+"message/loadjobinfo.json",saveemmessage:LT.Env.hRoot+"message/saveemmessage.json"}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _ImError,_ImError2,_Queue,_Queue2,_EventEmitter,_EventEmitter2,pajax,emptyFn;Object.defineProperty(exports,"__esModule",{value:!0}),exports.EventEmitter=exports.Queue=exports.ImError=exports.emptyFn=exports.pajax=void 0,_ImError=__webpack_require__(151),_ImError2=_interopRequireDefault(_ImError),_Queue=__webpack_require__(152),_Queue2=_interopRequireDefault(_Queue),_EventEmitter=__webpack_require__(153),_EventEmitter2=_interopRequireDefault(_EventEmitter),pajax=exports.pajax=function pajax(options){return new Promise(function(resolve,reject){options.url||reject(new Error("url is necessary!")),LT.ajax(Object.assign(options,{success:function success(data){resolve(data)},error:function error(err){reject(err)},timeout:15e3}))})},emptyFn=exports.emptyFn=function emptyFn(){},exports.ImError=_ImError2["default"],exports.Queue=_Queue2["default"],exports.EventEmitter=_EventEmitter2["default"]},function(module,exports){"use strict";function ImError(errorCode){this.name="ImError",this.message=errorCode||"10000",this.stack=(new Error).stack}Object.defineProperty(exports,"__esModule",{value:!0}),ImError.prototype=Object.create(Error.prototype),ImError.prototype.constructor=ImError,exports["default"]=ImError},function(module,exports){"use strict";function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass,Queue;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Queue=function(){function Queue(){_classCallCheck(this,Queue),this.queue=[],this.started=!1}return _createClass(Queue,[{key:"push",value:function push(){var _len,args,_key,_this=this;for(_len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];args.forEach(function(func){"function"==typeof func&&_this.queue.push(func)}),this.started||this.start()}},{key:"start",value:function(){function start(){return _ref.apply(this,arguments)}var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:this.started=!0;case 1:if(0===this.queue.length){_context.next=13;break}return _context.prev=2,_context.next=5,this.runFunc();case 5:this.queue.shift(),_context.next=11;break;case 8:_context.prev=8,_context.t0=_context["catch"](2),this.queue.shift();case 11:_context.next=1;break;case 13:this.started=!1;case 14:case"end":return _context.stop()}},_callee,this,[[2,8]])}));return start}()},{key:"runFunc",value:function runFunc(){var pTimeout=new Promise(function(resolve,reject){setTimeout(function(){return resolve("queue timeout")},5e4)});return Promise.race([this.queue[0](),pTimeout])}}]),Queue}(),exports["default"]=Queue},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__,_typeof;_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},function(exports){"use strict";function EventEmitter(){}function indexOfListener(listeners,listener){for(var i=listeners.length;i--;)if(listeners[i].listener===listener)return i;return-1}function alias(name){return function aliasClosure(){return this[name].apply(this,arguments)}}function isValidListener(listener){return"function"==typeof listener||listener instanceof RegExp||!(!listener||"object"!==("undefined"==typeof listener?"undefined":_typeof(listener)))&&isValidListener(listener.listener)}var proto=EventEmitter.prototype,originalGlobalValue=exports.EventEmitter;proto.getListeners=function getListeners(evt){var response,key,events=this._getEvents();if(evt instanceof RegExp){response={};for(key in events)events.hasOwnProperty(key)&&evt.test(key)&&(response[key]=events[key])}else response=events[evt]||(events[evt]=[]);return response},proto.flattenListeners=function flattenListeners(listeners){var i,flatListeners=[];for(i=0;i<listeners.length;i+=1)flatListeners.push(listeners[i].listener);return flatListeners},proto.getListenersAsObject=function getListenersAsObject(evt){var response,listeners=this.getListeners(evt);return listeners instanceof Array&&(response={},response[evt]=listeners),response||listeners},proto.addListener=function addListener(evt,listener){var listeners,listenerIsWrapped,key;if(!isValidListener(listener))throw new TypeError("listener must be a function");listeners=this.getListenersAsObject(evt),listenerIsWrapped="object"===("undefined"==typeof listener?"undefined":_typeof(listener));for(key in listeners)listeners.hasOwnProperty(key)&&indexOfListener(listeners[key],listener)===-1&&listeners[key].push(listenerIsWrapped?listener:{listener:listener,once:!1});return this},proto.on=alias("addListener"),proto.addOnceListener=function addOnceListener(evt,listener){return this.addListener(evt,{listener:listener,once:!0})},proto.once=alias("addOnceListener"),proto.defineEvent=function defineEvent(evt){return this.getListeners(evt),this},proto.defineEvents=function defineEvents(evts){for(var i=0;i<evts.length;i+=1)this.defineEvent(evts[i]);return this},proto.removeListener=function removeListener(evt,listener){var index,key,listeners=this.getListenersAsObject(evt);for(key in listeners)listeners.hasOwnProperty(key)&&(index=indexOfListener(listeners[key],listener),index!==-1&&listeners[key].splice(index,1));return this},proto.off=alias("removeListener"),proto.addListeners=function addListeners(evt,listeners){return this.manipulateListeners(!1,evt,listeners)},proto.removeListeners=function removeListeners(evt,listeners){return this.manipulateListeners(!0,evt,listeners)},proto.manipulateListeners=function manipulateListeners(remove,evt,listeners){var i,value,single=remove?this.removeListener:this.addListener,multiple=remove?this.removeListeners:this.addListeners;if("object"!==("undefined"==typeof evt?"undefined":_typeof(evt))||evt instanceof RegExp)for(i=listeners.length;i--;)single.call(this,evt,listeners[i]);else for(i in evt)evt.hasOwnProperty(i)&&(value=evt[i])&&("function"==typeof value?single.call(this,i,value):multiple.call(this,i,value));return this},proto.removeEvent=function removeEvent(evt){var key,type="undefined"==typeof evt?"undefined":_typeof(evt),events=this._getEvents();if("string"===type)delete events[evt];else if(evt instanceof RegExp)for(key in events)events.hasOwnProperty(key)&&evt.test(key)&&delete events[key];else delete this._events;return this},proto.removeAllListeners=alias("removeEvent"),proto.emitEvent=function emitEvent(evt,args){var listeners,listener,i,key,response,listenersMap=this.getListenersAsObject(evt);for(key in listenersMap)if(listenersMap.hasOwnProperty(key))for(listeners=listenersMap[key].slice(0),i=0;i<listeners.length;i++)listener=listeners[i],listener.once===!0&&this.removeListener(evt,listener.listener),response=listener.listener.apply(this,args||[]),response===this._getOnceReturnValue()&&this.removeListener(evt,listener.listener);return this},proto.trigger=alias("emitEvent"),proto.emit=function emit(evt){var args=Array.prototype.slice.call(arguments,1);return this.emitEvent(evt,args)},proto.setOnceReturnValue=function setOnceReturnValue(value){return this._onceReturnValue=value,this},proto._getOnceReturnValue=function _getOnceReturnValue(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},proto._getEvents=function _getEvents(){return this._events||(this._events={})},EventEmitter.noConflict=function noConflict(){return exports.EventEmitter=originalGlobalValue,EventEmitter},__WEBPACK_AMD_DEFINE_RESULT__=function(){return EventEmitter}.call(exports,__webpack_require__,exports,module),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}({})},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass,_utils,LPStorage;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_utils=__webpack_require__(150),LPStorage=function(){function LPStorage(origin,path){_classCallCheck(this,LPStorage),this.origin=origin,this.path=path,this._iframe=null,this._iframeReady=!1,this._queue=[],this._subscribeFunc={},this._requests={},this._id=0,this.op={PUBLISH:"PUBLISH",SET:"SET",GET:"GET",SUBSCRIBE:"SUBSCRIBE"},this.init()}return _createClass(LPStorage,[{key:"init",value:function init(){var that=this,frame=this.checkIframeExisted();if(frame&&(this._iframe||(this._iframe=frame,this.initIframeEvent())),!this._iframe){if(!(window.postMessage&&window.JSON&&window.localStorage))throw new Error("Unsupported browser.");this._iframe=document.createElement("iframe"),this._iframe.name="storage",this._iframe.style.cssText="position:absolute;width:1px;height:1px;left:-9999px;",document.body.appendChild(this._iframe),this._iframe.src=""+this.origin+this.path,this.initIframeEvent()}}},{key:"initIframeEvent",value:function initIframeEvent(){var that=this;window.addEventListener?(this._iframe.addEventListener("load",function(){that._iframeLoaded()},!1),window.addEventListener("message",function(event){that._handleMessage(event)},!1)):this._iframe.attachEvent&&(this._iframe.attachEvent("onload",function(){that._iframeLoaded();
}),window.attachEvent("onmessage",function(event){that._handleMessage(event)}))}},{key:"checkIframeExisted",value:function checkIframeExisted(){var _iterator,_step,frame,frames=document.querySelectorAll("iframe"),reg=new RegExp(this.path+"$"),_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(_iterator=frames[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)if(frame=_step.value,reg.test(frame.attributes.src))return frame}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator["return"]&&_iterator["return"]()}finally{if(_didIteratorError)throw _iteratorError}}return!1}},{key:"get",value:function get(key){var callback=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_utils.emptyFn;this._toSend({op:this.op.GET,key:key},function(key,value){callback(value)})}},{key:"set",value:function set(key,value){var callback=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_utils.emptyFn;this._toSend({key:key,op:this.op.SET,value:value},callback)}},{key:"publish",value:function publish(key,value){var callback=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_utils.emptyFn;this._toSend({key:key,op:this.op.PUBLISH,value:value},callback)}},{key:"subscribe",value:function subscribe(key,func){var that=this;return this._toSend({key:key,op:this.op.SUBSCRIBE},function(){"function"==typeof func&&(that._subscribeFunc[key]=that._subscribeFunc[key]||[],that._subscribeFunc[key].push(func))}),function(){var index=that._subscribeFunc[key].indexOf(func);index>=0&&that._subscribeFunc[key].splice(index,1)}}},{key:"_toSend",value:function _toSend(params,callback){var data={request:{key:params.key,id:++this._id,op:params.op,value:params.value},callback:callback};this._iframeReady?this._sendRequest(data):this._queue.push(data),this._iframe||this.init()}},{key:"_sendRequest",value:function _sendRequest(data){this._requests[data.request.id]=data,this._iframe.contentWindow.postMessage(JSON.stringify(data.request),this.origin)}},{key:"_iframeLoaded",value:function _iframeLoaded(){if(this._iframeReady=!0,this._queue.length){for(var i=0,len=this._queue.length;i<len;i++)this._sendRequest(this._queue[i]);this._queue=[]}}},{key:"_handleMessage",value:function _handleMessage(event){var data;try{if("[object String]"===Object.prototype.toString.call(event.data)?data=JSON.parse(event.data):"[object Object]"===Object.prototype.toString.call(event.data)&&(data=event.data),data.action===this.op.SUBSCRIBE)return void this._subscribeFunc[data.key].forEach(function(func){func(data.key,data.value)});this._requests[data.id]&&this._requests[data.id].callback&&this._requests[data.id].callback(data.key,data.value),delete this._requests[data.id]}catch(e){console.log(e)}}}]),LPStorage}(),exports["default"]=LPStorage},function(module,exports){"use strict";function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function checkFileType(_ref){var file=_ref.file,fileInputId=_ref.fileInputId,fileType=_ref.fileType;if(!fileType){if(file||(file=WebIM.utils.getFileUrl(fileInputId)),!file)return!1;fileType=file.filetype}return AVAILABLE_TYPES.indexOf(fileType.toLowerCase())!==-1}function checkFileSize(_ref2){var file=_ref2.file,fileInputId=_ref2.fileInputId,fileSize=_ref2.fileSize;if(!fileSize){if(file||(file=WebIM.utils.getFileUrl(fileInputId)),!file)return!1;fileSize=file.data.size}return 10485760>fileSize}var checkFileWH,AVAILABLE_TYPES;Object.defineProperty(exports,"__esModule",{value:!0}),checkFileWH=exports.checkFileWH=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee(_ref4){var newImage,file=_ref4.file,fileInputId=_ref4.fileInputId;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(file||(file=WebIM.utils.getFileUrl(fileInputId)),!window.URL||!window.URL.createObjectURL){_context.next=8;break}return _context.next=4,new Promise(function(resolve,reject){var image=new Image;image.onload=function(){resolve(image)},image.onerror=function(){reject(new Error("Could not load image at "+file.url))},image.src=file.url});case 4:return newImage=_context.sent,_context.abrupt("return",newImage.width<1e3&&newImage.height<800);case 8:return _context.abrupt("return",!0);case 9:case"end":return _context.stop()}},_callee,this)}));return function checkFileWH(_x){return _ref3.apply(this,arguments)}}(),exports.checkFileType=checkFileType,exports.checkFileSize=checkFileSize,AVAILABLE_TYPES=["jpg","jpeg","gif","png","bmp"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _LocalStorageKey,_MsgEvent2,_MsgEvent,_UserType2,_UserType,_ErrorType2,_ErrorType,MESSAGE_SOURCE,MSG_DEAL_TIMEOUT,FOCUS_TO_LOGIN_TIMEOUT,HX_LOGIN_TIMEOUT,HX_SEND_MSG_TIMEOUT,HX_SEND_IMG_MSG_TIMEOUT,MAX_STORAGE_MSG_PER_USER;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MAX_STORAGE_MSG_PER_USER=exports.HX_SEND_IMG_MSG_TIMEOUT=exports.HX_SEND_MSG_TIMEOUT=exports.HX_LOGIN_TIMEOUT=exports.FOCUS_TO_LOGIN_TIMEOUT=exports.MSG_DEAL_TIMEOUT=exports.MESSAGE_SOURCE=exports.getLocalStorageKey=exports.ErrorType=exports.UserType=exports.MsgEvent=void 0,_LocalStorageKey=__webpack_require__(157),Object.defineProperty(exports,"getLocalStorageKey",{enumerable:!0,get:function get(){return _LocalStorageKey.getLocalStorageKey}}),_MsgEvent2=__webpack_require__(158),_MsgEvent=_interopRequireWildcard(_MsgEvent2),_UserType2=__webpack_require__(159),_UserType=_interopRequireWildcard(_UserType2),_ErrorType2=__webpack_require__(160),_ErrorType=_interopRequireWildcard(_ErrorType2),exports.MsgEvent=_MsgEvent,exports.UserType=_UserType,exports.ErrorType=_ErrorType,MESSAGE_SOURCE=exports.MESSAGE_SOURCE=0,MSG_DEAL_TIMEOUT=exports.MSG_DEAL_TIMEOUT=5e3,FOCUS_TO_LOGIN_TIMEOUT=exports.FOCUS_TO_LOGIN_TIMEOUT=1e4,HX_LOGIN_TIMEOUT=exports.HX_LOGIN_TIMEOUT=5e3,HX_SEND_MSG_TIMEOUT=exports.HX_SEND_MSG_TIMEOUT=5e3,HX_SEND_IMG_MSG_TIMEOUT=exports.HX_SEND_IMG_MSG_TIMEOUT=6e6,MAX_STORAGE_MSG_PER_USER=exports.MAX_STORAGE_MSG_PER_USER=20},function(module,exports){"use strict";function getLocalStorageKey(userId){return{PANEL_IS_READ_KEY:userId+"_contact_panel_is_read",ALL_MSG_KEY:userId+"_im_msg",TABS_UNREAD:userId+"_tabs_unread_cnt",CONTACTS_UNREAD:userId+"_contacts_unread"}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLocalStorageKey=getLocalStorageKey},function(module,exports){"use strict";var SEND_MSG,RECEIVE_MSG,UPDATE_MSG,CONN_MSG,UPDATE_READED_MSG,UPDATE_LIST_MSG;Object.defineProperty(exports,"__esModule",{value:!0}),SEND_MSG=exports.SEND_MSG="SEND_MSG",RECEIVE_MSG=exports.RECEIVE_MSG="RECEIVE_MSG",UPDATE_MSG=exports.UPDATE_MSG="UPDATE_MSG",CONN_MSG=exports.CONN_MSG="CONN_MSG",UPDATE_READED_MSG=exports.UPDATE_READED_MSG="UPDATE_READED_MSG",UPDATE_LIST_MSG=exports.UPDATE_LIST_MSG="UPDATE_LIST_MSG"},function(module,exports){"use strict";var USER_TYPE_C,USER_TYPE_B,USER_TYPE_H;Object.defineProperty(exports,"__esModule",{value:!0}),USER_TYPE_C=exports.USER_TYPE_C=0,USER_TYPE_B=exports.USER_TYPE_B=1,USER_TYPE_H=exports.USER_TYPE_H=2},function(module,exports){"use strict";var LOGIN_FAILED,HX_ONERROR,NETWORK_ONERROR,SENDSIGN_ONERROR,UNSUPPORTED_MSG_TYPE,HX_OFFLINE,HX_ONLINE,HX_UPLOAD_CANT_ASYNC,UPLOAD_URL_EMPTY,UPLOAD_FILE_ERROR,UPLOAD_FILE_TYPE_ERROR,UPLOAD_FILE_OVERSIZE,UPLOAD_FILE_WH,RESUME_NOT_COMPLETED,SERVER_CANSEND_ERR_MSG,beExited;Object.defineProperty(exports,"__esModule",{value:!0}),LOGIN_FAILED=exports.LOGIN_FAILED="服务器连接异常，可尝试重新登录解决问题",HX_ONERROR=exports.HX_ONERROR="服务器连接异常，可尝试重新登录解决问题",NETWORK_ONERROR=exports.NETWORK_ONERROR="网络连接超时",SENDSIGN_ONERROR=exports.SENDSIGN_ONERROR="职聊消息平台连接异常",UNSUPPORTED_MSG_TYPE=exports.UNSUPPORTED_MSG_TYPE="接收到不支持的消息类型",HX_OFFLINE=exports.HX_OFFLINE="您已与职聊服务器断开连接",HX_ONLINE=exports.HX_ONLINE="您已与职聊服务器恢复连接",HX_UPLOAD_CANT_ASYNC=exports.HX_UPLOAD_CANT_ASYNC="浏览器不支持上传图片操作",UPLOAD_URL_EMPTY=exports.UPLOAD_URL_EMPTY="请选择图片",UPLOAD_FILE_ERROR=exports.UPLOAD_FILE_ERROR="上传图片发生错误，请刷新重试",UPLOAD_FILE_TYPE_ERROR=exports.UPLOAD_FILE_TYPE_ERROR="只支持以下格式：jpg, png, bmp, gif",UPLOAD_FILE_OVERSIZE=exports.UPLOAD_FILE_OVERSIZE="文件大小超过限制！请上传大小不超过10M的文件",UPLOAD_FILE_WH=exports.UPLOAD_FILE_WH="图片尺寸过大！请上传小于1000*800的图片",RESUME_NOT_COMPLETED=exports.RESUME_NOT_COMPLETED='您的简历尚未完善，为了保证双方沟通效率，请先<a href="https://c.liepin.com/resume/getdefaultresume/" target="_blank">完善您的简历</a>',SERVER_CANSEND_ERR_MSG=exports.SERVER_CANSEND_ERR_MSG="",beExited=exports.beExited="您在其他设备已登录"},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function messageReceiveFilter(){var receiveMessage=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},receiveType=arguments[1],payload=JSON.parse(receiveMessage.payload),extType=payload.ext&&payload.ext.extType,extBody=payload.ext&&payload.ext.extBody;switch(receiveType){case"Text":case"Emoji":if((1!=extBody.messageSource||0!=extBody.receiverKind||0!=extBody.senderKind||extType!==_enums.ExtType.MESSAGE_RESUME)&&_enums.CompatibleExtType.TXT_EXT_TYPES_ARR.includes(extType))return!0;break;case"Picture":if(_enums.CompatibleExtType.IMG_EXT_TYPES_ARR.includes(extType))return!0}return!1}function createReceiveMsg(message,receiveType){var msg=new ReceiveMsg;switch(receiveType){case"Text":case"Emoji":return msg.set(message,"txt");case"Picture":return msg.set(message,"img");case"Audio":return msg.set(message,"audio")}}function createReceiveMsgByPlainMsg(message){var msg=new ReceiveMsg;return msg.setByPlainMsg(message)}var _extends,_createClass,_enums,_api,api,ReceiveMsg;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReceiveMsg=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),exports.messageReceiveFilter=messageReceiveFilter,exports.createReceiveMsg=createReceiveMsg,exports.createReceiveMsgByPlainMsg=createReceiveMsgByPlainMsg,_enums=__webpack_require__(162),_api=__webpack_require__(166),api=_interopRequireWildcard(_api),ReceiveMsg=exports.ReceiveMsg=function(){function ReceiveMsg(){_classCallCheck(this,ReceiveMsg)}return _createClass(ReceiveMsg,[{key:"set",value:function set(message){var payload,dataType=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"txt";return this.type=dataType,this.message=message,payload=JSON.parse(message.payload),this.msgBody={id:payload.ext.id||message.msgId,ext:payload.ext,timestamp:message.msgTime?new Date(message.msgTime).getTime():Date.now(),read:message.readflag,type:dataType,extType:payload.ext.extType,bodies:payload.bodies[0],sign:payload.ext.extBody.sign},"0"===message.direction?Object.assign(this.msgBody,{from:message.imId,fromtype:message.imUserType,to:message.oppositeImId,totype:message.oppositeImUserType}):"1"===message.direction&&Object.assign(this.msgBody,{from:message.oppositeImId,fromtype:message.oppositeImUserType,to:message.imId,totype:message.imUserType}),"img"===dataType?(this.value=this.msgBody.bodies.url,this.msgBody.filename=this.msgBody.bodies.filename,this.msgBody.data=this.msgBody.bodies.url||""):(this.initByExtType(payload.ext.extType,payload.ext.extBody,this.msgBody.bodies.msg),this.msgBody.data=this.msgBody.bodies.msg||""),this}},{key:"initByExtType",value:function initByExtType(extType,extBody,data){switch(extType){case _enums.ExtType.MESSAGE_SEND_JOB:this.msgBody.jobKind=extBody.jobKind,this.msgBody.jobId=extBody.jobId,this.msgBody.senderKind=extBody.senderKind;break;case _enums.ExtType.MESSAGE_RESUME:this.msgBody.userId=extBody.userInfo?extBody.userInfo.userId:this.msgBody.from;break;case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:this.msgBody.jobId=extBody.jobId;break;case _enums.ExtType.MESSAGE_SEND_RATINGBAR:break;case _enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK:this.msgBody.reason=extBody.reason,this.msgBody.jobKind=extBody.jobKind,this.msgBody.jobId=extBody.jobId,this.msgBody.senderKind=extBody.senderKind;break;case _enums.ExtType.MESSAGE_SEND_APPLYSUCFEEDBACK:this.msgBody.jobKind=extBody.jobKind,this.msgBody.jobId=extBody.jobId,this.msgBody.senderKind=extBody.senderKind;break;case _enums.ExtType.MESSAGE_TEXT:case _enums.ExtType.MESSAGE_SEND_TOOLTIP:if("string"==typeof data)this.value=data;else if(Array.isArray(data)){var html=data.map(function(item){return"emotion"===item.type?'<img src="'+item.data+'">':item.data});this.value=html.join("")}break;case _enums.ExtType.MESSAGE_SEND_NAMECARD:this.msgBody.jobKind=extBody.jobKind,this.msgBody.jobId=extBody.jobId;break;case _enums.ExtType.MESSAGE_ASK_RESUME:this.msgBody.jobId=extBody.jobId,this.msgBody.jobKind=extBody.jobKind}}},{key:"setByPlainMsg",value:function setByPlainMsg(message){return Object.assign(this,message)}},{key:"getId",value:function getId(){return this.msgBody.id}},{key:"setRead",value:function setRead(){return this.msgBody.read=!0,this}},{key:"getExtType",value:function getExtType(){return this.msgBody.extType}},{key:"getType",value:function getType(){return this.msgBody.type}},{key:"getTimestamp",value:function getTimestamp(){return this.msgBody.timestamp}},{key:"getTo",value:function getTo(){return this.msgBody.to}},{key:"getFrom",value:function getFrom(){return this.msgBody.from}},{key:"getOppositeUserInfo",value:function getOppositeUserInfo(imcore){var oppositeUserKind=this.msgBody.ext.extBody.senderKind,oppositeImUserType=this.msgBody.fromtype,oppositeImId=this.msgBody.from;return imcore.userInfo.oppositeImId===this.msgBody.from&&(oppositeUserKind=this.msgBody.ext.extBody.receiverKind,oppositeImUserType=this.msgBody.totype,oppositeImId=this.msgBody.to),{oppositeImId:oppositeImId,oppositeImUserType:oppositeImUserType,oppositeUserId:this.msgBody.ext.extBody.senderUserId||this.message.oppositeUserId,oppositeUserKind:oppositeUserKind}}},{key:"getBody",value:function getBody(){return this.msgBody}},{key:"getSign",value:function getSign(){return this.msgBody.ext.extBody.sign}},{key:"getLastMsgFormat",value:function getLastMsgFormat(){var content={ext:{extType:this.msgBody.ext.extType,extBody:this.msgBody.ext.extBody},bodies:[{msg:this.value,type:this.type}]};return{latestMsgId:"",lastPayload:JSON.stringify(content),latestMsgTime:this.getTimestamp()}}},{key:"fillInfo",value:function(){function fillInfo(_x3){return _ref.apply(this,arguments)}var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(imcore){var receiverKind,senderKind,info;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.prev=0,receiverKind=this.msgBody&&this.msgBody.ext&&this.msgBody.ext.extBody&&this.msgBody.ext.extBody.receiverKind,senderKind=this.msgBody&&this.msgBody.ext&&this.msgBody.ext.extBody&&this.msgBody.ext.extBody.senderKind,receiverKind==senderKind){_context.next=11;break}return _context.next=6,imcore.fillInfo(imcore,this.msgBody,this.msgBody.ext.extBody);case 6:if(_context.t0=_context.sent,_context.t0){_context.next=9;break}_context.t0={};case 9:info=_context.t0,Object.assign(this.msgBody,_extends({},info));case 11:return _context.abrupt("return",this);case 14:throw _context.prev=14,_context.t1=_context["catch"](0),imcore.handleErr(_context.t1),_context.t1;case 18:case"end":return _context.stop()}},_callee,this,[[0,14]])}));return fillInfo}()}]),ReceiveMsg}()},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _ExtType2,_ExtType,_MsgState2,_MsgState,_CompatibleExtType2,_CompatibleExtType;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CompatibleExtType=exports.MsgState=exports.ExtType=void 0,_ExtType2=__webpack_require__(163),_ExtType=_interopRequireWildcard(_ExtType2),_MsgState2=__webpack_require__(164),_MsgState=_interopRequireWildcard(_MsgState2),_CompatibleExtType2=__webpack_require__(165),_CompatibleExtType=_interopRequireWildcard(_CompatibleExtType2),exports.ExtType=_ExtType,exports.MsgState=_MsgState,exports.CompatibleExtType=_CompatibleExtType},function(module,exports){"use strict";var MESSAGE_TEXT,MESSAGE_CONVEY,MESSAGE_ACCEPT,MESSAGE_POSITION_INVITE,MESSAGE_SAY_HELLO,MESSAGE_RESUME,MESSAGE_SHARE_POSITION,MESSAGE_SEND_POSITION_LINK,MESSAGE_CERTIFICATE_HER,MESSAGE_TOPIC_SHARE,MESSAGE_CARD_SHARE,MESSAGE_ACTIVITY_SHARE,MESSAGE_SEND_JOB,MESSAGE_SEND_TOOLTIP,MESSAGE_SEND_APPLYRESUME,MESSAGE_SEND_RATINGBAR,MESSAGE_SEND_APPLYFAILDFEEDBACK,MESSAGE_SEND_APPLYSUCFEEDBACK,MESSAGE_SEND_NAMECARD,MESSAGE_ASK_RESUME,MESSAGE_IMAGE,MESSAGE_LOCATION,MESSAGE_VOICE;Object.defineProperty(exports,"__esModule",{value:!0}),MESSAGE_TEXT=exports.MESSAGE_TEXT=1,MESSAGE_CONVEY=exports.MESSAGE_CONVEY=2,MESSAGE_ACCEPT=exports.MESSAGE_ACCEPT=3,MESSAGE_POSITION_INVITE=exports.MESSAGE_POSITION_INVITE=4,MESSAGE_SAY_HELLO=exports.MESSAGE_SAY_HELLO=5,MESSAGE_RESUME=exports.MESSAGE_RESUME=6,MESSAGE_SHARE_POSITION=exports.MESSAGE_SHARE_POSITION=7,MESSAGE_SEND_POSITION_LINK=exports.MESSAGE_SEND_POSITION_LINK=8,MESSAGE_CERTIFICATE_HER=exports.MESSAGE_CERTIFICATE_HER=9,MESSAGE_TOPIC_SHARE=exports.MESSAGE_TOPIC_SHARE=10,MESSAGE_CARD_SHARE=exports.MESSAGE_CARD_SHARE=11,MESSAGE_ACTIVITY_SHARE=exports.MESSAGE_ACTIVITY_SHARE=12,MESSAGE_SEND_JOB=exports.MESSAGE_SEND_JOB=13,MESSAGE_SEND_TOOLTIP=exports.MESSAGE_SEND_TOOLTIP=17,MESSAGE_SEND_APPLYRESUME=exports.MESSAGE_SEND_APPLYRESUME=18,MESSAGE_SEND_RATINGBAR=exports.MESSAGE_SEND_RATINGBAR=19,MESSAGE_SEND_APPLYFAILDFEEDBACK=exports.MESSAGE_SEND_APPLYFAILDFEEDBACK=20,MESSAGE_SEND_APPLYSUCFEEDBACK=exports.MESSAGE_SEND_APPLYSUCFEEDBACK=21,MESSAGE_SEND_NAMECARD=exports.MESSAGE_SEND_NAMECARD=23,MESSAGE_ASK_RESUME=exports.MESSAGE_ASK_RESUME=24,MESSAGE_IMAGE=exports.MESSAGE_IMAGE=1,MESSAGE_LOCATION=exports.MESSAGE_LOCATION=1,MESSAGE_VOICE=exports.MESSAGE_VOICE=1},function(module,exports){"use strict";var INITIAL,PREPROCESS_SUCCESS,SEND_SUCCESS,RESEND,PREPROCESS_FAILED,SEND_FAILED;Object.defineProperty(exports,"__esModule",{value:!0}),INITIAL=exports.INITIAL=0,PREPROCESS_SUCCESS=exports.PREPROCESS_SUCCESS=1,SEND_SUCCESS=exports.SEND_SUCCESS=2,RESEND=exports.RESEND=3,PREPROCESS_FAILED=exports.PREPROCESS_FAILED=4,SEND_FAILED=exports.SEND_FAILED=5},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _ExtType,ExtType,TXT_EXT_TYPES_ARR,IMG_EXT_TYPES_ARR,CANNOT_SHOW_CIMG,CANNOT_SHOW_BIMG,CANNOT_SHOW_HIMG;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CANNOT_SHOW_HIMG=exports.CANNOT_SHOW_BIMG=exports.CANNOT_SHOW_CIMG=exports.IMG_EXT_TYPES_ARR=exports.TXT_EXT_TYPES_ARR=void 0,_ExtType=__webpack_require__(163),ExtType=_interopRequireWildcard(_ExtType),TXT_EXT_TYPES_ARR=exports.TXT_EXT_TYPES_ARR=[ExtType.MESSAGE_SEND_JOB,ExtType.MESSAGE_RESUME,ExtType.MESSAGE_TEXT,ExtType.MESSAGE_SEND_TOOLTIP,ExtType.MESSAGE_SEND_APPLYRESUME,ExtType.MESSAGE_SEND_RATINGBAR,ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK,ExtType.MESSAGE_SEND_APPLYSUCFEEDBACK,ExtType.MESSAGE_SEND_NAMECARD,ExtType.MESSAGE_ASK_RESUME],IMG_EXT_TYPES_ARR=exports.IMG_EXT_TYPES_ARR=[ExtType.MESSAGE_IMAGE],CANNOT_SHOW_CIMG=exports.CANNOT_SHOW_CIMG="不支持此消息查看，请登录“猎聘同道APP”查看消息内容！",CANNOT_SHOW_BIMG=exports.CANNOT_SHOW_BIMG="不支持此消息查看，请登录“猎聘BOSS”查看消息内容！",CANNOT_SHOW_HIMG=exports.CANNOT_SHOW_HIMG="不支持此消息查看，请登录“猎聘猎头版”查看消息内容！"},function(module,exports,__webpack_require__){"use strict";function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}var initResumeMessage,initJobMessage,_utils,_config;Object.defineProperty(exports,"__esModule",{value:!0}),exports.initJobMessage=exports.initResumeMessage=void 0,initResumeMessage=exports.initResumeMessage=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(env,from){var config,data;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,config=(0,_config.setImConfig)(env),_context.next=4,(0,_utils.pajax)({url:config.ajaxUrl.loadresumeinfo+"?oppositeEmUserName="+from});case 4:if(data=_context.sent,!data.flag){_context.next=9;break}return _context.abrupt("return",data.data);case 9:throw new Error(data.msg);case 10:_context.next=15;break;case 12:throw _context.prev=12,_context.t0=_context["catch"](0),new Error(_context.t0);case 15:case"end":return _context.stop()}},_callee,this,[[0,12]])}));return function initResumeMessage(_x,_x2){return _ref.apply(this,arguments)}}(),initJobMessage=exports.initJobMessage=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(env,jobId,jobKind,senderKind){var config,data;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,config=(0,_config.setImConfig)(env),_context2.next=4,(0,_utils.pajax)({url:config.ajaxUrl.loadjobinfo,data:{jobId:jobId,jobKind:jobKind,fromUK:senderKind}});case 4:if(data=_context2.sent,!data.flag){_context2.next=9;break}return _context2.abrupt("return",data.data);case 9:return _context2.abrupt("return",{exist:!1});case 10:_context2.next=15;break;case 12:throw _context2.prev=12,_context2.t0=_context2["catch"](0),new Error(_context2.t0);case 15:case"end":return _context2.stop()}},_callee2,this,[[0,12]])}));return function initJobMessage(_x3,_x4,_x5,_x6){return _ref2.apply(this,arguments)}}(),_utils=__webpack_require__(150),_config=__webpack_require__(146)},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function uuid(){var cdate=new Date,offdate=new Date(2010,1,1),offset=cdate.getTime()-offdate.getTime(),hexd=parseInt(offset).toString(16),random=(""+Math.random()).replace(/\./,"_");return"ERROR_"+hexd+"_"+random}Object.defineProperty(exports,"__esModule",{value:!0});var ErrorMsg=exports.ErrorMsg=function ErrorMsg(_ref){var type=_ref.type,desc=_ref.desc;_classCallCheck(this,ErrorMsg),this.type="err",this.id=uuid(),this.errorType=type,this.timestamp=Date.now(),this.data=desc}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function Root(props){return _react2["default"].createElement(_reactRedux.Provider,{store:(0,_store.configureStore)({})},_react2["default"].createElement(_Panel2["default"],props))}var _react,_react2,_reactRedux,_store,_Panel,_Panel2,_config,_config2;Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Root,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_reactRedux=__webpack_require__(134),_store=__webpack_require__(169),_Panel=__webpack_require__(248),_Panel2=_interopRequireDefault(_Panel),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _redux,_reduxThunk,_reduxThunk2,_reducers,_reducers2,configureStore;Object.defineProperty(exports,"__esModule",{value:!0}),exports.configureStore=void 0,_redux=__webpack_require__(120),_reduxThunk=__webpack_require__(170),_reduxThunk2=_interopRequireDefault(_reduxThunk),_reducers=__webpack_require__(171),_reducers2=_interopRequireDefault(_reducers),configureStore=exports.configureStore=function configureStore(initialState){var middleware=(0,_redux.applyMiddleware)(_reduxThunk2["default"]),store=(0,_redux.createStore)(_reducers2["default"],initialState,middleware);return store}},function(module,exports){"use strict";function createThunkMiddleware(extraArgument){return function(_ref){var dispatch=_ref.dispatch,getState=_ref.getState;return function(next){return function(action){return"function"==typeof action?action(dispatch,getState,extraArgument):next(action)}}}}exports.__esModule=!0;var thunk=createThunkMiddleware();thunk.withExtraArgument=createThunkMiddleware,exports["default"]=thunk},function(module,exports,__webpack_require__){"use strict";var _redux,_contacts,_drag,_history,_historyContacts,_notice,_panel,_sns,_dialog,_setting,_setGreeting,_toast,_userSetting,_shield,_report,_sendMsg;Object.defineProperty(exports,"__esModule",{value:!0}),_redux=__webpack_require__(120),_contacts=__webpack_require__(172),_drag=__webpack_require__(234),_history=__webpack_require__(235),_historyContacts=__webpack_require__(236),_notice=__webpack_require__(237),_panel=__webpack_require__(238),_sns=__webpack_require__(239),_dialog=__webpack_require__(240),_setting=__webpack_require__(241),_setGreeting=__webpack_require__(242),_toast=__webpack_require__(243),_userSetting=__webpack_require__(244),_shield=__webpack_require__(245),_report=__webpack_require__(246),_sendMsg=__webpack_require__(247),exports["default"]=(0,_redux.combineReducers)({contacts:_contacts.contactsReducer,drag:_drag.dragReducer,history:_history.historyReducer,notice:_notice.noticeReducer,panel:_panel.panelReducer,sns:_sns.snsReducer,dialog:_dialog.dialogReducer,historyContacts:_historyContacts.historyContactsReducer,setting:_setting.settingReducer,setGreeting:_setGreeting.setGreetingReducer,toast:_toast.toastReducer,userSetting:_userSetting.userSettingReducer,shield:_shield.shieldReducer,report:_report.reportReducer,sendMsg:_sendMsg.sendMsgReducer})},function(module,exports,__webpack_require__){"use strict";function addToTop(list,item,condition){if("[object Array]"===Object.prototype.toString.call(list)){var i=list.findIndex(function(v,i,arr){return condition(v,i,arr)});return i===-1?[item].concat(list):[_extends({},list[i],item)].concat(list.slice(0,i)).concat(list.slice(i+1))}}function updateList(list,item,condition){if("[object Array]"===Object.prototype.toString.call(list)){var i=list.findIndex(function(v,i,arr){return condition(v,i,arr)});return i===-1?list:list.slice(0,i).concat([_extends({},list[i],item)]).concat(list.slice(i+1))}}function contactsReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:contactsInitialState,action=arguments[1],i=void 0,contact=void 0,firstContact=void 0,newcontacts=void 0;switch(action.type){case _actions.ActionType.GET_CONTACTS_START:case _actions.ActionType.GET_CONTACTS_FAIL:case _actions.ActionType.GET_CONTACTS_SUCC:return Object.assign({},state,action.payload);case _actions.ActionType.DELETE_CONTACT:return contact=action.payload,i=state.contacts.findIndex(function(v){return v.oppositeImId===contact.oppositeImId}),Object.assign({},state,{contacts:state.contacts.slice(0,i).concat(state.contacts.slice(i+1))});case _actions.ActionType.SELECT_CONTACT:return newcontacts=updateList(state.contacts,{unReadCnt:0},function(v){return action.payload.contact.oppositeImId===v.oppositeImId}),Object.assign({},state,{contacts:newcontacts});case _actions.ActionType.UPDATE_CONTACTS_BY_RECEIVE_MSG:return newcontacts=addToTop(state.contacts,action.payload,function(v){return v.oppositeImId===action.payload.oppositeImId}),Object.assign({},state,{contacts:newcontacts});case _actions.ActionType.UPDATE_CONTACTS_BY_SEND_MSG:return Object.assign({},state,{contacts:addToTop(state.contacts,_extends({},action.payload.contact,action.payload.lastMsg),function(v){return v.oppositeImId===action.payload.contact.oppositeImId})});case _actions.ActionType.UPDATE_CONTACT_READED_MSG:return imcore.handleLog("msgReaded--- UPDATE_CONTACT_READED_MSG ----->",action.payload),Object.assign({},state,{contacts:action.payload});default:return state}}var _extends,_actions,contactsInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.contactsInitialState=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports.contactsReducer=contactsReducer,_actions=__webpack_require__(173),contactsInitialState=exports.contactsInitialState={firstLoaded:!1,contacts:[],loading:!1,curPage:0,nomore:!1}},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _panel,_panelActions,_contacts,_contactsActions,_notice,_noticeActions,_sns,_snsActions,_drag,_dragActions,_history,_historyActions,_ActionType2,_ActionType,_dialog,_imDialogActions,_message,_messageActions,_setting,_settingActions,_historyContacts,_historyContactsActions,_setGreeting,_setGreetingActions,_toast,_toastActions,_userSetting,_userSettingActions,_shield,_shieldActions,_report,_reportActions;Object.defineProperty(exports,"__esModule",{value:!0}),exports.reportActions=exports.shieldActions=exports.userSettingActions=exports.toastActions=exports.setGreetingActions=exports.historyContactsActions=exports.settingActions=exports.messageActions=exports.imDialogActions=exports.ActionType=exports.historyActions=exports.dragActions=exports.snsActions=exports.noticeActions=exports.contactsActions=exports.panelActions=void 0,_panel=__webpack_require__(174),_panelActions=_interopRequireWildcard(_panel),_contacts=__webpack_require__(175),_contactsActions=_interopRequireWildcard(_contacts),_notice=__webpack_require__(223),_noticeActions=_interopRequireWildcard(_notice),_sns=__webpack_require__(224),_snsActions=_interopRequireWildcard(_sns),_drag=__webpack_require__(228),_dragActions=_interopRequireWildcard(_drag),_history=__webpack_require__(210),_historyActions=_interopRequireWildcard(_history),
_ActionType2=__webpack_require__(143),_ActionType=_interopRequireWildcard(_ActionType2),_dialog=__webpack_require__(229),_imDialogActions=_interopRequireWildcard(_dialog),_message=__webpack_require__(230),_messageActions=_interopRequireWildcard(_message),_setting=__webpack_require__(231),_settingActions=_interopRequireWildcard(_setting),_historyContacts=__webpack_require__(222),_historyContactsActions=_interopRequireWildcard(_historyContacts),_setGreeting=__webpack_require__(227),_setGreetingActions=_interopRequireWildcard(_setGreeting),_toast=__webpack_require__(232),_toastActions=_interopRequireWildcard(_toast),_userSetting=__webpack_require__(233),_userSettingActions=_interopRequireWildcard(_userSetting),_shield=__webpack_require__(225),_shieldActions=_interopRequireWildcard(_shield),_report=__webpack_require__(226),_reportActions=_interopRequireWildcard(_report),exports.panelActions=_panelActions,exports.contactsActions=_contactsActions,exports.noticeActions=_noticeActions,exports.snsActions=_snsActions,exports.dragActions=_dragActions,exports.historyActions=_historyActions,exports.ActionType=_ActionType,exports.imDialogActions=_imDialogActions,exports.messageActions=_messageActions,exports.settingActions=_settingActions,exports.historyContactsActions=_historyContactsActions,exports.setGreetingActions=_setGreetingActions,exports.toastActions=_toastActions,exports.userSettingActions=_userSettingActions,exports.shieldActions=_shieldActions,exports.reportActions=_reportActions},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function panelReceiveMsg(imcore,msg){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){var formattedMsg;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:formattedMsg=(0,_receive.createReceiveMsgByPlainMsg)(msg),(0,_utils.publish)(imcore,dispatch,{type:ActionType.PANEL_RECEIVE_MSG,payload:formattedMsg.getBody()}),dispatch(contactsActions.changeContactsByReceiveMsg(imcore,msg)),dispatch(historyContactsActions.changeContactsByReceiveMsg(imcore,msg));case 4:case"end":return _context.stop()}},_callee,_this)}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}function panelSendMsg(imcore,msg){return function(dispatch,getState){(0,_utils.publish)(imcore,dispatch,{type:ActionType.PANEL_SEND_MSG,payload:msg.getPublish()})}}function panelUpdateMsg(imcore,msg){return function(dispatch,getState){getState().panel.activeContact&&(0,_utils.publish)(imcore,dispatch,{type:ActionType.PANEL_UPDATE_MSG,payload:msg})}}function panelUpdateListMsg(imcore,msg){return function(dispatch,getState){dispatch(contactsActions.changeContactsBySendMsg(imcore,msg)),dispatch(historyContactsActions.changeContactsBySendMsg(imcore,msg))}}function panelUpdateReadedMsg(imcore,toImId){var _this2=this;return function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(dispatch,getState){var newList,newCurList,newEarlyList,LSKey,tabsUnReadJson,state,unreadCount;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,newList=[],newCurList=[],newEarlyList=[],LSKey=(0,_constants.getLocalStorageKey)(imcore.userInfo.oppositeImId),_context2.next=5,imcore.getLocalDataPromise(LSKey.TABS_UNREAD);case 5:return tabsUnReadJson=_context2.sent,state=getState(),imcore.handleLog("msgReaded--- panelUpdateReadedMsg ----->",toImId),state.contacts.contacts.length>0&&(newList=state.contacts.contacts.map(function(v){return v.oppositeImId===toImId&&(v.unReadCnt=0),v})),state.historyContacts.curMonthContacts.length>0&&(newCurList=state.historyContacts.curMonthContacts.map(function(v){return v.oppositeImId===toImId&&(v.unReadCnt=0),v})),state.historyContacts.earlierContacts.length>0&&(newEarlyList=state.historyContacts.earlierContacts.map(function(v){return v.oppositeImId===toImId&&(v.unReadCnt=0),v})),imcore.handleLog("msgReaded--- get newList ----->",newList),_context2.next=14,_api.contactsApi.getTotalUnread(imcore);case 14:unreadCount=_context2.sent,1===unreadCount.flag&&dispatch(setUnReadTabsToLocal(imcore,"contacts",unreadCount.data.count)),!state.panel.opened&&state.setting.setting.message&&dispatch(setPanelUnReadToLocal(imcore,unreadCount>0)),(0,_utils.publish)(imcore,dispatch,{type:ActionType.UPDATE_CONTACT_READED_MSG,payload:newList}),(0,_utils.publish)(imcore,dispatch,{type:ActionType.UPDATE_HISTORYCONTACT_READED_MSG,payload:{curMonthContacts:newCurList,earlierContacts:newEarlyList}}),_context2.next=24;break;case 21:_context2.prev=21,_context2.t0=_context2["catch"](0),imcore.handleErr(_context2.t0);case 24:case"end":return _context2.stop()}},_callee2,_this2,[[0,21]])}));return function(_x3,_x4){return _ref2.apply(this,arguments)}}()}function panelConnMsg(imcore,msg){return function(dispatch,getState){(0,_utils.publish)(imcore,dispatch,{type:ActionType.PANEL_CONN_MSG,payload:msg})}}function initPanel(imcore,hasConnect){var _this3=this;return function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(dispatch,getState){return regeneratorRuntime.wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:try{!function(){var config=(0,_config2["default"])(imcore.env),selectedTabKey=LT.Cookie.get(_constants2.enums.COOKIE_KEY_CUR_TAB)||"contacts",index=config.tabs.findIndex(function(v){return v.key===selectedTabKey});index===-1&&(index=0),dispatch(initTab(imcore,config.tabs[index])),imcore.unReadMsg(function(data){data.readFlag||data.unReadCounts>0&&!getState().panel.opened&&dispatch(setPanelUnReadToLocal(imcore,!0)),hasConnect&&(dispatch(contactsActions.getContacts(imcore,hasConnect)),dispatch(historyContactsActions.getHistoryContactsList(imcore,hasConnect))),getState().contacts.firstLoaded||(dispatch(contactsActions.getContacts(imcore)),dispatch(getUnReadFromLocal(imcore))),getState().historyContacts.firstLoaded||dispatch(historyContactsActions.getHistoryContactsList(imcore))}),dispatch(setGreetingActions.greetingStatus(imcore)),dispatch(setGreetingActions.greetingList(imcore))}()}catch(e){imcore.handleErr(e)}case 1:case"end":return _context3.stop()}},_callee3,_this3)}));return function(_x5,_x6){return _ref3.apply(this,arguments)}}()}function reConnect(imcore,tab){}function initTab(imcore,tab){return{type:ActionType.INIT_TAB,payload:tab}}function selectTab(imcore,tab){var _this4=this;return function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(dispatch,getState){return regeneratorRuntime.wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:"contacts"===tab.key?(getState().contacts.firstLoaded||dispatch(contactsActions.getContacts(imcore)),window.tlog=window.tlog||[],tlog.push((0,_config2["default"])(imcore.env).tlogs.OPEN_CONTACTS)):(dispatch(setUnReadTabsToLocal(imcore,tab.key,!1)),"historycontacts"===tab.key?(!getState().historyContacts.firstLoaded&&dispatch(historyContactsActions.getHistoryContactsList(imcore)),window.tlog=window.tlog||[],tlog.push((0,_config2["default"])(imcore.env).tlogs.OPEN_HISTORYLIST)):"notice"===tab.key?(!getState().notice.firstLoaded&&dispatch(noticeActions.getNoticeList(imcore)),window.tlog=window.tlog||[],tlog.push((0,_config2["default"])(imcore.env).tlogs.OPEN_NOTICE)):"sns"===tab.key&&(dispatch(snsActions.getSnsList(imcore)),window.tlog=window.tlog||[],tlog.push((0,_config2["default"])(imcore.env).tlogs.OPEN_SNS))),LT.Cookie.set(_constants2.enums.COOKIE_KEY_CUR_TAB,tab.key,360,"/"),(0,_utils.publish)(imcore,dispatch,{type:ActionType.SELECT_TAB,payload:tab});case 3:case"end":return _context4.stop()}},_callee4,_this4)}));return function(_x7,_x8){return _ref4.apply(this,arguments)}}()}function selectTabByKey(imcore,tabkey){var _this5=this;return function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(dispatch,getState){var tabs,index;return regeneratorRuntime.wrap(function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:tabs=(0,_config2["default"])(imcore.env).tabs,index=tabs.findIndex(function(v){return v.key===tabkey}),index>-1&&dispatch(selectTab(imcore,tabs[index]));case 3:case"end":return _context5.stop()}},_callee5,_this5)}));return function(_x9,_x10){return _ref5.apply(this,arguments)}}()}function getUnReadFromLocal(imcore){var _this6=this;return function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark(function _callee6(dispatch,getState){var config,LSKey,unRead,tabsUnReadJson,unreadCount;return regeneratorRuntime.wrap(function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return config=(0,_config2["default"])(imcore.env),LSKey=(0,_constants.getLocalStorageKey)(imcore.userInfo.oppositeImId),_context6.next=4,imcore.getLocalDataPromise(LSKey.PANEL_IS_READ_KEY);case 4:return unRead=_context6.sent,(0,_utils.publish)(imcore,dispatch,{type:ActionType.SET_PANEL_UNREAD,payload:unRead}),_context6.next=8,imcore.getLocalDataPromise(LSKey.TABS_UNREAD);case 8:return tabsUnReadJson=_context6.sent,Array.isArray(tabsUnReadJson)&&tabsUnReadJson.length===config.tabs.length||(tabsUnReadJson=[0,!1,!1]),_context6.next=12,_api.contactsApi.getTotalUnread(imcore);case 12:unreadCount=_context6.sent,1===unreadCount.flag&&dispatch(setUnReadTabsToLocal(imcore,"contacts",unreadCount.data.count)),(0,_utils.publish)(imcore,dispatch,{type:ActionType.SET_TABS_UNREAD,payload:tabsUnReadJson});case 15:case"end":return _context6.stop()}},_callee6,_this6)}));return function(_x11,_x12){return _ref6.apply(this,arguments)}}()}function openPanel(imcore){var _this7=this;return function(){var _ref7=_asyncToGenerator(regeneratorRuntime.mark(function _callee7(dispatch,getState){var config;return regeneratorRuntime.wrap(function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:try{config=(0,_config2["default"])(imcore.env),dispatch(setPanelUnReadToLocal(imcore,!1)),setTimeout(function(){return dispatch(selectTab(imcore,getState().panel.activeTab))},500),(0,_utils.publish)(imcore,dispatch,{type:ActionType.OPEN_PANEL,payload:!0})}catch(e){imcore.handleErr(e)}case 1:case"end":return _context7.stop()}},_callee7,_this7)}));return function(_x13,_x14){return _ref7.apply(this,arguments)}}()}function closePanel(imcore){return function(dispatch,getState){(0,_utils.publish)(imcore,dispatch,{type:ActionType.CLOSE_PANEL,payload:{opened:!1}})}}function setUnReadTabsToLocal(imcore,tabkey,unRead){var _this8=this;return function(){var _ref8=_asyncToGenerator(regeneratorRuntime.mark(function _callee8(dispatch,getState){var config,LSKey,tabsUnReadArr,newTabsUnRead;return regeneratorRuntime.wrap(function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return config=(0,_config2["default"])(imcore.env),LSKey=(0,_constants.getLocalStorageKey)(imcore.userInfo.oppositeImId),_context8.next=4,imcore.getLocalDataPromise(LSKey.TABS_UNREAD);case 4:tabsUnReadArr=_context8.sent,Array.isArray(tabsUnReadArr)&&tabsUnReadArr.length===config.tabs.length||(tabsUnReadArr=[0,!1,!1]),newTabsUnRead=config.tabs.map(function(v,i){return config.tabs[i].key===tabkey?unRead:tabsUnReadArr[i]}),imcore.setLocalData(LSKey.TABS_UNREAD,newTabsUnRead),(0,_utils.publish)(imcore,dispatch,{type:ActionType.SET_TABS_UNREAD,payload:newTabsUnRead});case 9:case"end":return _context8.stop()}},_callee8,_this8)}));return function(_x15,_x16){return _ref8.apply(this,arguments)}}()}function setPanelUnReadToLocal(imcore,unRead){return function(dispatch,getState){if(getState().setting.setting.message){var LSKey=(0,_constants.getLocalStorageKey)(imcore.userInfo.oppositeImId);imcore.setLocalData(LSKey.PANEL_IS_READ_KEY,unRead),(0,_utils.publish)(imcore,dispatch,{type:ActionType.SET_PANEL_UNREAD,payload:unRead})}}}function selectContact(imcore,contactList,callback){var _this9=this;return function(){var _ref9=_asyncToGenerator(regeneratorRuntime.mark(function _callee9(dispatch,getState){var contact,readed,setTlog,contactTlog,inBlackData,attentionData,inBlack,activeContact,unreadCount;return regeneratorRuntime.wrap(function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(_context9.prev=0,contact=void 0,!contactList.isNotPanel){_context9.next=8;break}return _context9.next=5,_api.contactsApi.getOneContact(imcore,contactList);case 5:contact=_context9.sent,_context9.next=9;break;case 8:contact=contactList;case 9:if(!(void 0==contact.unReadCnt||contact.unReadCnt>0)){_context9.next=15;break}return _context9.next=12,_api.contactsApi.readed(imcore,contact.oppositeImId);case 12:if(readed=_context9.sent){_context9.next=15;break}return _context9.abrupt("return");case 15:if(setTlog=(0,_config2["default"])(imcore.env).tlogs,contactTlog=void 0,"c"===imcore.env&&(contact.oppositeUserKind==_constants.UserType.USER_TYPE_C?contactTlog=setTlog.OPEN_DIALOG_C:contact.oppositeUserKind==_constants.UserType.USER_TYPE_B?contactTlog=setTlog.OPEN_DIALOG_B:contact.oppositeUserKind==_constants.UserType.USER_TYPE_H&&(contactTlog=setTlog.OPEN_DIALOG_H),window.tlog=window.tlog||[],tlog.push(contactTlog)),inBlackData=void 0,attentionData=void 0,inBlack=getState().shield.inBlack,activeContact=getState().panel.activeContact,activeContact&&activeContact.oppositeImId===contact.oppositeImId){_context9.next=46;break}if((0,_utils.publish)(imcore,dispatch,{type:ActionType.SELECT_CONTACT_START,payload:{loadingActiveContact:!0}}),_Dialog2["default"].closeAllConfirm({parent:"chat"}),"b"!==imcore.env&&"c"!==imcore.env){_context9.next=29;break}return _context9.next=27,shieldActions.inBlackStatusAjax(imcore,contact);case 27:inBlackData=_context9.sent,inBlackData.flag&&("b"===imcore.env?inBlack=0!==inBlackData.data.rejectStatus&&2!==inBlackData.data.rejectStatus:"c"===imcore.env&&(inBlack=inBlackData.data.inBlack),(0,_utils.publish)(imcore,dispatch,{type:ActionType.INBLACK_STATUS,payload:inBlack}));case 29:if("h"!==imcore.env.toLowerCase()){_context9.next=35;break}return _context9.next=32,_api.hcoreApi.isAttention(imcore,contact.oppositeImId);case 32:attentionData=_context9.sent,contact.isAttention=attentionData.isAttention,contact.usercEncodeId=attentionData.usercEncodeId;case 35:return imcore.event.trigger("selectContact",[contact]),(0,_utils.publish)(imcore,dispatch,{type:ActionType.SELECT_CONTACT,payload:{contact:contact,loadingActiveContact:!1}}),_context9.next=39,_api.contactsApi.getTotalUnread(imcore);case 39:unreadCount=_context9.sent,1===unreadCount.flag&&dispatch(setUnReadTabsToLocal(imcore,"contacts",unreadCount.data.count)),dispatch(historyActions.getInitialServerHistory(imcore,contact)),dispatch(historyActions.hideHistory(imcore)),callback&&callback(contact,inBlack),_context9.next=47;break;case 46:callback&&callback(contact,inBlack);case 47:_context9.next=52;break;case 49:_context9.prev=49,_context9.t0=_context9["catch"](0),imcore.handleErr(_context9.t0);case 52:case"end":return _context9.stop()}},_callee9,_this9,[[0,49]])}));return function(_x17,_x18){return _ref9.apply(this,arguments)}}()}function unselectActiveContact(imcore){return function(dispatch,getState){dispatch(historyActions.clearInitialServerHistory(imcore)),(0,_utils.publish)(imcore,dispatch,{type:ActionType.UNSELECT_ACTIVE_CONTACT,payload:null})}}function updateMsgList(imcore,updateFunc){return function(dispatch,getState){(0,_utils.publish)(imcore,dispatch,{type:ActionType.UPDATE_MSGLIST,payload:updateFunc(getState().panel.msgList)})}}function updateHattention(imcore,isAttention){return function(dispatch,getState){var contact=_extends({},getState().panel.activeContact);contact.isAttention=isAttention,(0,_utils.publish)(imcore,dispatch,{type:ActionType.UPDATE_ATTENTION,payload:{contact:contact}})}}var _extends,_constants,_receive,_ActionType,ActionType,_enums,_contacts,contactsActions,_history,historyActions,_historyContacts,historyContactsActions,_notice,noticeActions,_sns,snsActions,_shield,shieldActions,_report,reportActions,_setGreeting,setGreetingActions,_send,_api,_constants2,_config,_config2,_utils,_Dialog,_Dialog2;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports.panelReceiveMsg=panelReceiveMsg,exports.panelSendMsg=panelSendMsg,exports.panelUpdateMsg=panelUpdateMsg,exports.panelUpdateListMsg=panelUpdateListMsg,exports.panelUpdateReadedMsg=panelUpdateReadedMsg,exports.panelConnMsg=panelConnMsg,exports.initPanel=initPanel,exports.reConnect=reConnect,exports.initTab=initTab,exports.selectTab=selectTab,exports.selectTabByKey=selectTabByKey,exports.getUnReadFromLocal=getUnReadFromLocal,exports.openPanel=openPanel,exports.closePanel=closePanel,exports.setUnReadTabsToLocal=setUnReadTabsToLocal,exports.setPanelUnReadToLocal=setPanelUnReadToLocal,exports.selectContact=selectContact,exports.unselectActiveContact=unselectActiveContact,exports.updateMsgList=updateMsgList,exports.updateHattention=updateHattention,_constants=__webpack_require__(156),_receive=__webpack_require__(161),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_enums=__webpack_require__(162),_contacts=__webpack_require__(175),contactsActions=_interopRequireWildcard(_contacts),_history=__webpack_require__(210),historyActions=_interopRequireWildcard(_history),_historyContacts=__webpack_require__(222),historyContactsActions=_interopRequireWildcard(_historyContacts),_notice=__webpack_require__(223),noticeActions=_interopRequireWildcard(_notice),_sns=__webpack_require__(224),snsActions=_interopRequireWildcard(_sns),_shield=__webpack_require__(225),shieldActions=_interopRequireWildcard(_shield),_report=__webpack_require__(226),reportActions=_interopRequireWildcard(_report),_setGreeting=__webpack_require__(227),setGreetingActions=_interopRequireWildcard(_setGreeting),_send=__webpack_require__(221),_api=__webpack_require__(215),_constants2=__webpack_require__(212),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils=__webpack_require__(180),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function getContacts(imcore,hasConnect,fristLoad){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){var state,newContacts,curPage,pageContacts,unreadNum;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.prev=0,state=getState().contacts,!(state.loading||state.firstLoaded&&state.nomore)){_context.next=4;break}return _context.abrupt("return");case 4:return dispatch({type:ActionType.GET_CONTACTS_START,payload:{loading:!0}}),newContacts=[],curPage=0,hasConnect||(curPage=state.curPage),_context.next=10,_api.contactsApi.getContactList(imcore,curPage);case 10:if(pageContacts=_context.sent){_context.next=13;break}return _context.abrupt("return");case 13:if(newContacts=hasConnect?pageContacts:state.contacts.concat(pageContacts),newContacts.length>0&&(unreadNum=0,newContacts.forEach(function(v){unreadNum+=v.unReadCnt}),dispatch(panelActions.setUnReadTabsToLocal(imcore,"contacts",unreadNum))),(0,_utils2.publish)(imcore,dispatch,{type:ActionType.GET_CONTACTS_SUCC,payload:{contacts:newContacts,curPage:curPage+1,loading:!1,nomore:0===pageContacts.length,firstLoaded:!0}}),!fristLoad){_context.next=18;break}return _context.abrupt("return",{contacts:newContacts,curPage:curPage+1,loading:!1,nomore:0===pageContacts.length,firstLoaded:!0});case 18:_context.next=24;break;case 20:_context.prev=20,_context.t0=_context["catch"](0),dispatch({type:ActionType.GET_CONTACTS_FAIL,payload:{loading:!1}}),imcore.handleErr(_context.t0);case 24:case"end":return _context.stop()}},_callee,_this,[[0,20]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}function deleteContact(imcore,contact){var _this2=this;return function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(dispatch,getState){var imUserType,data,readed,unreadCount;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:imUserType=void 0,_context2.t0=imcore.env,_context2.next="c"===_context2.t0?4:"h"===_context2.t0?6:"b"===_context2.t0?8:10;break;case 4:return imUserType="0",_context2.abrupt("break",10);case 6:return imUserType="2",_context2.abrupt("break",10);case 8:return imUserType="3",_context2.abrupt("break",10);case 10:return _context2.next=12,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.delmycontact,type:"post",data:{imUserType:imUserType,oppositeImId:contact.oppositeImId,imApp:"1"}});case 12:if(data=_context2.sent,!data.flag){_context2.next=26;break}return _context2.next=16,_api.contactsApi.readed(imcore,contact.oppositeImId);case 16:if(readed=_context2.sent){_context2.next=19;break}return _context2.abrupt("return");case 19:return _context2.next=21,_api.contactsApi.getTotalUnread(imcore);case 21:unreadCount=_context2.sent,1===unreadCount.flag&&dispatch(panelActions.setUnReadTabsToLocal(imcore,"contacts",unreadCount.data.count)),(0,_utils2.publish)(imcore,dispatch,{type:ActionType.DELETE_CONTACT,payload:contact}),_context2.next=27;break;case 26:Dialog.alert({parent:"chat",width:300,content:React.createElement("p",{className:"text-center"},data.msg)});case 27:case"end":return _context2.stop()}},_callee2,_this2)}));return function(_x3,_x4){return _ref2.apply(this,arguments)}}()}function changeContactsByReceiveMsg(imcore,msg){var _this3=this;return function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(dispatch,getState){var _ret;return regeneratorRuntime.wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return imcore.handleLog("changeContactsByReceiveMsg----->",msg),_context4.prev=1,_context4.delegateYield(regeneratorRuntime.mark(function _callee3(){var state,sender,senderInfo,receiver,unReadCnt,unReadTab,isfirstLost,newcontact,LSKey,tabsUnReadJson,readed,recordUnRead=function recordUnRead(unReadCnt){dispatch(panelActions.setUnReadTabsToLocal(imcore,"contacts",unReadTab)),getState().setting.setting.message&&(imcore.handleLog("change tab and list unread ----->"),!state.panel.opened&&msg.msgBody&&"0"===msg.msgBody.read&&dispatch(panelActions.setPanelUnReadToLocal(imcore,!0)))};return regeneratorRuntime.wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return state=getState(),sender=msg.getFrom(),senderInfo=msg.getOppositeUserInfo(imcore),receiver=msg.getTo(),unReadCnt=0,unReadTab=0,isfirstLost=!0,newcontact=void 0,LSKey=(0,_constants.getLocalStorageKey)(imcore.userInfo.oppositeImId),_context3.next=11,imcore.getLocalDataPromise(LSKey.TABS_UNREAD);case 11:if(tabsUnReadJson=_context3.sent,state.contacts.contacts.length>0&&state.contacts.contacts.map(function(v){unReadTab+=v.unReadCnt}),isfirstLost&&(unReadTab+=1),!state.panel.activeContact||state.panel.activeContact.oppositeImId!==sender){_context3.next=21;break}return _context3.next=17,_api.contactsApi.readed(imcore,state.panel.activeContact.oppositeImId);case 17:if(readed=_context3.sent){_context3.next=20;break}return _context3.abrupt("return",{v:void 0});case 20:imcore.handleLog("readed has finished-----> state",state);case 21:if(state.contacts.firstLoaded){_context3.next=29;break}if(imcore.handleLog("has not contacts list ----->"),sender!==imcore.userInfo.oppositeImId){_context3.next=25;break}return _context3.abrupt("return",{v:void 0});case 25:if(!state.panel.activeContact||state.panel.activeContact.oppositeImId!==sender){_context3.next=27;break}return _context3.abrupt("return",{v:void 0});case 27:return recordUnRead(1),_context3.abrupt("return",{v:void 0});case 29:if(sender===imcore.userInfo.oppositeImId&&(sender=receiver),!state.panel.activeContact||state.panel.activeContact.oppositeImId!==sender){_context3.next=34;break}return imcore.handleLog("current activeContact ----->"),setTimeout(function(){(0,_utils2.publish)(imcore,dispatch,{type:ActionType.UPDATE_CONTACTS_BY_RECEIVE_MSG,payload:Object.assign(state.panel.activeContact,msg.getLastMsgFormat(),{unReadCnt:unReadCnt})}),(0,_utils2.publish)(imcore,dispatch,{type:ActionType.UPDATE_HISTORYCONTACTS_BY_RECEIVE_MSG,payload:Object.assign(state.panel.activeContact,msg.getLastMsgFormat(),{unReadCnt:unReadCnt})})},500),_context3.abrupt("return",{v:void 0});case 34:if(newcontact=state.contacts.contacts.filter(function(v){return v.oppositeImId===sender}),0!==newcontact.length){_context3.next=44;break}return imcore.handleLog("has newContact ----->"),_context3.next=39,_api.contactsApi.getOneContact(imcore,senderInfo);case 39:newcontact=_context3.sent,unReadCnt=msg.getFrom()===imcore.userInfo.oppositeImId?0:null===state.panel.activeContact?1:state.panel.activeContact.oppositeImId===sender?0:1,(0,_utils2.publish)(imcore,dispatch,{type:ActionType.UPDATE_CONTACTS_BY_RECEIVE_MSG,payload:Object.assign(newcontact,msg.getLastMsgFormat(),{unReadCnt:unReadCnt})}),_context3.next=47;break;case 44:imcore.handleLog("oldContact ----->"),msg.getFrom()===imcore.userInfo.oppositeImId?(imcore.handleLog("is owner app send ----->",unReadTab),unReadCnt=0,dispatch(panelActions.setUnReadTabsToLocal(imcore,"contacts",unReadTab-1-newcontact[0].unReadCnt))):(imcore.handleLog("is not nowner app send ----->"),unReadCnt=newcontact[0].unReadCnt+1),(0,_utils2.publish)(imcore,dispatch,{type:ActionType.UPDATE_CONTACTS_BY_RECEIVE_MSG,payload:Object.assign(newcontact[0],msg.getLastMsgFormat(),{unReadCnt:unReadCnt})});case 47:sender!==receiver&&recordUnRead(1);case 48:case"end":return _context3.stop()}},_callee3,_this3)})(),"t0",3);case 3:if(_ret=_context4.t0,"object"!==("undefined"==typeof _ret?"undefined":_typeof(_ret))){_context4.next=6;break}return _context4.abrupt("return",_ret.v);case 6:_context4.next=11;break;case 8:_context4.prev=8,_context4.t1=_context4["catch"](1),imcore.handleErr(_context4.t1);case 11:case"end":return _context4.stop()}},_callee4,_this3,[[1,8]])}));return function(_x5,_x6){return _ref3.apply(this,arguments)}}()}function changeContactsBySendMsg(imcore,msg){var _this4=this;return function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee6(dispatch,getState){var state,contact;return regeneratorRuntime.wrap(function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(state=getState(),contact=[],getState().contacts.firstLoaded&&msg.state!==_enums.MsgState.SEND_FAILED){_context6.next=3;break}return _context6.abrupt("return");case 3:if(imcore.handleLog("changeContactsBySendMsg ----->",msg),state.panel.activeContact){_context6.next=8;break}return _context6.delegateYield(regeneratorRuntime.mark(function _callee5(){var receiver,senderInfo;return regeneratorRuntime.wrap(function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(receiver=msg.msgBody.to,senderInfo={oppositeUserId:msg.msgBody.ext.extBody.receiverUserId,oppositeUserKind:msg.msgBody.ext.extBody.receiverKind},contact=state.contacts.contacts.filter(function(v){return v.oppositeImId===receiver}),imcore.handleLog("not activeContactwin ----->",contact),0!==contact.length){_context5.next=13;break}return _context5.next=7,_api.contactsApi.getOneContact(imcore,senderInfo);case 7:contact=_context5.sent,imcore.handleLog("get new contact ----->",contact),msg.oppositeImId=msg.msgBody.to,contact=_extends({},msg,contact,{unReadCnt:0}),_context5.next=15;break;case 13:contact=_extends({},msg,contact[0],{unReadCnt:0}),imcore.handleLog("get old contact ----->",contact);case 15:case"end":return _context5.stop()}},_callee5,_this4)})(),"t0",6);case 6:_context6.next=12;break;case 8:contact=getState().panel.activeContact,state.history.initialServerHistory.length>0&&state.history.initialServerHistory.some(function(v){return v.from!==imcore.userInfo.oppositeImId})&&(contact.contact=!0),contact=_extends({},msg,contact,{unReadCnt:0}),imcore.handleLog("has activeContactwin ----->",contact);case 12:(0,_utils2.publish)(imcore,dispatch,{type:ActionType.UPDATE_CONTACTS_BY_SEND_MSG,payload:{lastMsg:msg.getLastMsgFormat(),contact:contact}});case 13:case"end":return _context6.stop()}},_callee6,_this4)}));return function(_x7,_x8){return _ref4.apply(this,arguments)}}()}function setUnReadContactsToLocal(imcore,oppositeImId,unRead){var _this5=this;return function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee7(dispatch,getState){var config,LSKey,unReadArr,i;return regeneratorRuntime.wrap(function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return config=(0,_config2["default"])(imcore.env),LSKey=(0,_constants.getLocalStorageKey)(imcore.userInfo.oppositeImId),_context7.next=4,imcore.getLocalDataPromise(LSKey.CONTACTS_UNREAD);case 4:unReadArr=_context7.sent,unReadArr=Array.isArray(unReadArr)?unReadArr.filter(function(v){if(v)return v}):[],i=unReadArr.indexOf(oppositeImId),i>-1?0===unReadCnt&&unReadArr.splice(i,1):unRead&&unReadArr.push(oppositeImId),imcore.setLocalData(LSKey.CONTACTS_UNREAD,unReadArr);case 9:case"end":return _context7.stop()}},_callee7,_this5)}));return function(_x9,_x10){return _ref5.apply(this,arguments)}}()}var _extends,_typeof,_constants,_utils,_enums,_config,_config2,_ActionType,ActionType,_history,historyActions,_panel,panelActions,_api,_constants2,_send,_utils2;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},exports.getContacts=getContacts,exports.deleteContact=deleteContact,exports.changeContactsByReceiveMsg=changeContactsByReceiveMsg,exports.changeContactsBySendMsg=changeContactsBySendMsg,exports.setUnReadContactsToLocal=setUnReadContactsToLocal,_constants=__webpack_require__(156),_utils=__webpack_require__(150),_enums=__webpack_require__(162),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_history=__webpack_require__(210),historyActions=_interopRequireWildcard(_history),_panel=__webpack_require__(174),
panelActions=_interopRequireWildcard(_panel),_api=__webpack_require__(215),_constants2=__webpack_require__(212),_send=__webpack_require__(221),_utils2=__webpack_require__(180)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function getConfig(){var env=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"c";switch(env.toLowerCase()){case"c":return cConfig;case"b":return bConfig;case"h":return hConfig}}var _c,cConfig,_b,bConfig,_h,hConfig;Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=getConfig,_c=__webpack_require__(177),cConfig=_interopRequireWildcard(_c),_b=__webpack_require__(200),bConfig=_interopRequireWildcard(_b),_h=__webpack_require__(206),hConfig=_interopRequireWildcard(_h)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _tabs,_tlogs2,_tlogs,_urls2,_urls;Object.defineProperty(exports,"__esModule",{value:!0}),exports.urls=exports.tlogs=exports.tabs=void 0,_tabs=__webpack_require__(178),Object.defineProperty(exports,"tabs",{enumerable:!0,get:function get(){return _tabs.tabs}}),_tlogs2=__webpack_require__(198),_tlogs=_interopRequireWildcard(_tlogs2),_urls2=__webpack_require__(199),_urls=_interopRequireWildcard(_urls2),exports.tlogs=_tlogs,exports.urls=_urls},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _Contacts,_Contacts2,_Sns,_Sns2,_Notice,_Notice2,tabs;Object.defineProperty(exports,"__esModule",{value:!0}),exports.tabs=void 0,_Contacts=__webpack_require__(179),_Contacts2=_interopRequireDefault(_Contacts),_Sns=__webpack_require__(190),_Sns2=_interopRequireDefault(_Sns),_Notice=__webpack_require__(192),_Notice2=_interopRequireDefault(_Notice),tabs=exports.tabs=[{key:"contacts",name:"消息",comp:_Contacts2["default"]},{key:"sns",name:"人脉",comp:_Sns2["default"]},{key:"notice",name:"通知",comp:_Notice2["default"]}]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_config,_config2,_utils,_addTlog,_ContactInfo,_ContactInfo2,_ContactCard,_ContactCard2,_actions,_Dialog,_Dialog2,Contacts,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils=__webpack_require__(180),_addTlog=__webpack_require__(182),_ContactInfo=__webpack_require__(183),_ContactInfo2=_interopRequireDefault(_ContactInfo),_ContactCard=__webpack_require__(187),_ContactCard2=_interopRequireDefault(_ContactCard),_actions=__webpack_require__(173),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog),__webpack_require__(189),Contacts=function(_Component){function Contacts(props){_classCallCheck(this,Contacts);var _this=_possibleConstructorReturn(this,(Contacts.__proto__||Object.getPrototypeOf(Contacts)).call(this,props));return _this.config=(0,_config2["default"])(props.imcore.env),_this.containerDom=null,_this}return _inherits(Contacts,_Component),_createClass(Contacts,[{key:"componentDidMount",value:function componentDidMount(){var _props=this.props,imcore=_props.imcore,actions=_props.actions,contacts=_props.contacts,loading=_props.loading,nomore=_props.nomore,firstLoaded=_props.firstLoaded,that=this,$container=$(this.containerDom),containerHeight=$container.height();$container.on("scroll",function(){var scrollTop=this.scrollTop,listHeight=$container.find("ul").height();scrollTop+containerHeight+20>listHeight&&that.props.firstLoaded&&setTimeout(function(){return that.getContacts()},100)}),$container.hover(function(){$(this).addClass("lihover")},function(){$(this).removeClass("lihover")})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){var _props2=this.props,actions=_props2.actions,activeTab=_props2.activeTab;nextProps.activeTab.key!==activeTab.key&&nextProps.firstLoaded===!1&&"contacts"===nextProps.activeTab.key&&actions.selectTab(imcore,nextProps.activeTab),nextProps.activeTab.key!==activeTab.key&&"contacts"===activeTab.key&&_Dialog2["default"].closeAllConfirm({parent:"main"})}},{key:"getContacts",value:function getContacts(){var _props3=this.props,imcore=_props3.imcore,actions=_props3.actions,loading=_props3.loading,nomore=_props3.nomore;nomore||loading||actions.getContacts(imcore)}},{key:"delContact",value:function delContact(v,e){var _props4=this.props,actions=_props4.actions,imcore=_props4.imcore;window.tlog=window.tlog||[],tlog.push(this.config.tlogs.DEL_CURRENT_MESSAGE),_Dialog2["default"].confirm({parent:"main",onOk:function onOk(){actions.deleteContact(imcore,v)},text:"确定删除该聊天？"}),e.stopPropagation()}},{key:"openHistoryContacts",value:function openHistoryContacts(){this.props.actions.selectTabByKey(this.props.imcore,"historycontacts")}},{key:"renderList",value:function renderList(){var _this2=this,_props5=this.props,activeTab=_props5.activeTab,contacts=_props5.contacts,imcore=_props5.imcore,actions=_props5.actions,firstLoaded=_props5.firstLoaded,loading=_props5.loading,setting=_props5.setting;return firstLoaded?_react2["default"].createElement("div",{ref:function ref(dom){return _this2.containerDom=dom},className:(0,_classnames2["default"])({"contact-list":!0,"contactlist-with-recent-contacts":"c"!==imcore.env})},"c"!==imcore.env.toLowerCase()?_react2["default"].createElement(_addTlog.Atlog,{href:"javascript:;",pushStr:this.config.tlogs.CLICK_HISTORYCONTACTS,className:"btn-recent-contacts",onClick:function onClick(){return _this2.openHistoryContacts()}},_react2["default"].createElement("i",{className:"recent-contacts"}),"最近联系人"):null,_react2["default"].createElement("ul",null,contacts.map(function(v,i){return _react2["default"].createElement("li",{key:i,className:"clearfix"},_react2["default"].createElement("a",{className:"close",href:"javascript:;",onClick:function onClick(e){return _this2.delContact(v,e)}},"×"),_react2["default"].createElement(_ContactInfo2["default"],{imcore:imcore,contacts:v,actions:actions,isHistory:!0}),_react2["default"].createElement(_ContactCard2["default"],{imcore:imcore,contacts:v}))})),0===contacts.length?_react2["default"].createElement("div",{className:"no-contacts"},_react2["default"].createElement("span",null,"没有新的消息")):null):_react2["default"].createElement("div",{className:"contact-list",ref:function ref(dom){return _this2.containerDom=dom}},_react2["default"].createElement("div",{className:"list-loading"},_react2["default"].createElement("em",null)))}},{key:"render",value:function render(){var _props6=this.props,activeTab=_props6.activeTab,contacts=_props6.contacts,imcore=_props6.imcore,actions=_props6.actions;return _react2["default"].createElement("div",{className:(0,_classnames2["default"])("contacts",{hide:"contacts"!==activeTab.key})},this.renderList())}}]),Contacts}(_react.Component),mapStateToProps=function mapStateToProps(state){return{activeTab:state.panel.activeTab,contacts:state.contacts.contacts,firstLoaded:state.contacts.firstLoaded,nomore:state.contacts.nomore,loading:state.contacts.loading,opened:state.panel.opened,setting:state.setting}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.contactsActions,_actions.panelActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Contacts)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function dateFormat(inputTime){var str,type=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",now=new Date;if("notice"===type&&(str=inputTime.replace(/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/,function(){return(arguments.length<=1?void 0:arguments[1])+"/"+(arguments.length<=2?void 0:arguments[2])+"/"+(arguments.length<=3?void 0:arguments[3])+" "+(arguments.length<=4?void 0:arguments[4])+":"+(arguments.length<=5?void 0:arguments[5])+":"+(arguments.length<=6?void 0:arguments[6])}),inputTime=new Date(str)),"msg"===type){if(inputTime=new Date(inputTime),LT.Date.format(inputTime,"yyyy-MM-dd")===LT.Date.format(now,"yyyy-MM-dd"))return["",LT.Date.format(inputTime,"HH:mm")];if(inputTime.getFullYear()===now.getFullYear())return[LT.Date.format(inputTime,"MM-dd"),LT.Date.format(inputTime,"HH:mm")];if(inputTime.getFullYear()!==now.getFullYear())return[LT.Date.format(inputTime,"yyyy-MM-dd"),LT.Date.format(inputTime,"HH:mm")]}else if("history"===type){if(inputTime=new Date(inputTime),LT.Date.format(inputTime,"yyyy-MM-dd")===LT.Date.format(now,"yyyy-MM-dd"))return["今天",LT.Date.format(inputTime,"HH:mm:ss")];if(inputTime.getFullYear()===now.getFullYear())return[LT.Date.format(inputTime,"MM-dd"),LT.Date.format(inputTime,"HH:mm:ss")];if(inputTime.getFullYear()!==now.getFullYear())return[LT.Date.format(inputTime,"yyyy-MM-dd"),LT.Date.format(inputTime,"HH:mm:ss")]}else{if(LT.Date.format(inputTime,"yyyy-MM-dd")===LT.Date.format(now,"yyyy-MM-dd"))return LT.Date.format(inputTime,"HH:mm");if(inputTime.getFullYear()===now.getFullYear())return LT.Date.format(inputTime,"MM-dd");if(inputTime.getFullYear()!==now.getFullYear())return LT.Date.format(inputTime,"yyyy-MM")}}function timeVisibleFormat(arr){var timeArr=[];return arr.map(function(v){var _dateFormat=dateFormat(v.timestamp,"msg"),_dateFormat2=_slicedToArray(_dateFormat,2),day=_dateFormat2[0],time=_dateFormat2[1];return""===day&&timeArr.indexOf(time)===-1?(timeArr.push(time),v.time=time):""!==day&&timeArr.indexOf(day+" "+time)===-1&&(timeArr.push(day+" "+time),v.time=day+" "+time),v})}function historyTimeVisibleFormat(arr){var dayArr=[];return arr.map(function(v){var _dateFormat3=dateFormat(v.timestamp,"history"),_dateFormat4=_slicedToArray(_dateFormat3,2),day=_dateFormat4[0],time=_dateFormat4[1];return dayArr.indexOf(day)===-1&&(dayArr.push(day),v.day=day),v.time=time,v})}function publish(imcore,dispatch,action){return action=Object.assign({},action,{pageId:imcore.pageId}),dispatch(action),imcore.publish(action.type,action)}function hKilledAccountAlert(imcore,data){("300330003"===data.code||"h"===imcore.env&&"5000"===data.code)&&vdialog.error(data.msg)}var _slicedToArray,_config,_config2,_immutable,getBrief,comparePropsState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.comparePropsState=exports.getBrief=void 0,_slicedToArray=function(){function sliceIterator(arr,i){var _i,_s,_arr=[],_n=!0,_d=!1,_e=void 0;try{for(_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i["return"]&&_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),exports.dateFormat=dateFormat,exports.timeVisibleFormat=timeVisibleFormat,exports.historyTimeVisibleFormat=historyTimeVisibleFormat,exports.publish=publish,exports.hKilledAccountAlert=hKilledAccountAlert,_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_immutable=__webpack_require__(181),getBrief=exports.getBrief=function getBrief(){var str=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",len=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return str&&(str=str.replace(/\n/gm,""),str=str.length===len?""+str.slice(0,len):str.length>len?str.slice(0,len)+"...":str),str},comparePropsState=exports.comparePropsState=function comparePropsState(){var key,_key,thisProps=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},thisState=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},nextProps=arguments[2],nextState=arguments[3];if(Object.keys(thisProps).length!==Object.keys(nextProps).length||Object.keys(thisState).length!==Object.keys(nextState).length)return!0;for(key in nextProps)if(thisProps[key]!==nextProps[key]||!(0,_immutable.is)(thisProps[key],nextProps[key]))return!0;for(_key in nextState)if(thisState[_key]!==nextState[_key]||!(0,_immutable.is)(thisState[_key],nextState[_key]))return!0;return!1}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__,_typeof;_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},function(global,factory){"object"===_typeof(exports)&&"undefined"!=typeof module?module.exports=factory():(__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}(void 0,function(){"use strict";function createClass(ctor,superClass){superClass&&(ctor.prototype=Object.create(superClass.prototype)),ctor.prototype.constructor=ctor}function Iterable(value){return isIterable(value)?value:Seq(value)}function KeyedIterable(value){return isKeyed(value)?value:KeyedSeq(value)}function IndexedIterable(value){return isIndexed(value)?value:IndexedSeq(value)}function SetIterable(value){return isIterable(value)&&!isAssociative(value)?value:SetSeq(value)}function isIterable(maybeIterable){return!(!maybeIterable||!maybeIterable[IS_ITERABLE_SENTINEL])}function isKeyed(maybeKeyed){return!(!maybeKeyed||!maybeKeyed[IS_KEYED_SENTINEL])}function isIndexed(maybeIndexed){return!(!maybeIndexed||!maybeIndexed[IS_INDEXED_SENTINEL])}function isAssociative(maybeAssociative){return isKeyed(maybeAssociative)||isIndexed(maybeAssociative)}function isOrdered(maybeOrdered){return!(!maybeOrdered||!maybeOrdered[IS_ORDERED_SENTINEL])}function MakeRef(ref){return ref.value=!1,ref}function SetRef(ref){ref&&(ref.value=!0)}function OwnerID(){}function arrCopy(arr,offset){var len,newArr,ii;for(offset=offset||0,len=Math.max(0,arr.length-offset),newArr=new Array(len),ii=0;ii<len;ii++)newArr[ii]=arr[ii+offset];return newArr}function ensureSize(iter){return void 0===iter.size&&(iter.size=iter.__iterate(returnTrue)),iter.size}function wrapIndex(iter,index){if("number"!=typeof index){var uint32Index=index>>>0;if(""+uint32Index!==index||4294967295===uint32Index)return NaN;index=uint32Index}return index<0?ensureSize(iter)+index:index}function returnTrue(){return!0}function wholeSlice(begin,end,size){return(0===begin||void 0!==size&&begin<=-size)&&(void 0===end||void 0!==size&&end>=size)}function resolveBegin(begin,size){return resolveIndex(begin,size,0)}function resolveEnd(end,size){return resolveIndex(end,size,size)}function resolveIndex(index,size,defaultIndex){return void 0===index?defaultIndex:index<0?Math.max(0,size+index):void 0===size?index:Math.min(size,index)}function Iterator(next){this.next=next}function iteratorValue(type,k,v,iteratorResult){var value=0===type?k:1===type?v:[k,v];return iteratorResult?iteratorResult.value=value:iteratorResult={value:value,done:!1},iteratorResult}function iteratorDone(){return{value:void 0,done:!0}}function hasIterator(maybeIterable){return!!getIteratorFn(maybeIterable)}function isIterator(maybeIterator){return maybeIterator&&"function"==typeof maybeIterator.next}function getIterator(iterable){var iteratorFn=getIteratorFn(iterable);return iteratorFn&&iteratorFn.call(iterable)}function getIteratorFn(iterable){var iteratorFn=iterable&&(REAL_ITERATOR_SYMBOL&&iterable[REAL_ITERATOR_SYMBOL]||iterable[FAUX_ITERATOR_SYMBOL]);if("function"==typeof iteratorFn)return iteratorFn}function isArrayLike(value){return value&&"number"==typeof value.length}function Seq(value){return null===value||void 0===value?emptySequence():isIterable(value)?value.toSeq():seqFromValue(value)}function KeyedSeq(value){return null===value||void 0===value?emptySequence().toKeyedSeq():isIterable(value)?isKeyed(value)?value.toSeq():value.fromEntrySeq():keyedSeqFromValue(value)}function IndexedSeq(value){return null===value||void 0===value?emptySequence():isIterable(value)?isKeyed(value)?value.entrySeq():value.toIndexedSeq():indexedSeqFromValue(value)}function SetSeq(value){return(null===value||void 0===value?emptySequence():isIterable(value)?isKeyed(value)?value.entrySeq():value:indexedSeqFromValue(value)).toSetSeq()}function ArraySeq(array){this._array=array,this.size=array.length}function ObjectSeq(object){var keys=Object.keys(object);this._object=object,this._keys=keys,this.size=keys.length}function IterableSeq(iterable){this._iterable=iterable,this.size=iterable.length||iterable.size}function IteratorSeq(iterator){this._iterator=iterator,this._iteratorCache=[]}function isSeq(maybeSeq){return!(!maybeSeq||!maybeSeq[IS_SEQ_SENTINEL])}function emptySequence(){return EMPTY_SEQ||(EMPTY_SEQ=new ArraySeq([]))}function keyedSeqFromValue(value){var seq=Array.isArray(value)?new ArraySeq(value).fromEntrySeq():isIterator(value)?new IteratorSeq(value).fromEntrySeq():hasIterator(value)?new IterableSeq(value).fromEntrySeq():"object"===("undefined"==typeof value?"undefined":_typeof(value))?new ObjectSeq(value):void 0;if(!seq)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+value);return seq}function indexedSeqFromValue(value){var seq=maybeIndexedSeqFromValue(value);if(!seq)throw new TypeError("Expected Array or iterable object of values: "+value);return seq}function seqFromValue(value){var seq=maybeIndexedSeqFromValue(value)||"object"===("undefined"==typeof value?"undefined":_typeof(value))&&new ObjectSeq(value);if(!seq)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+value);return seq}function maybeIndexedSeqFromValue(value){return isArrayLike(value)?new ArraySeq(value):isIterator(value)?new IteratorSeq(value):hasIterator(value)?new IterableSeq(value):void 0}function seqIterate(seq,fn,reverse,useKeys){var maxIndex,ii,entry,cache=seq._cache;if(cache){for(maxIndex=cache.length-1,ii=0;ii<=maxIndex;ii++)if(entry=cache[reverse?maxIndex-ii:ii],fn(entry[1],useKeys?entry[0]:ii,seq)===!1)return ii+1;return ii}return seq.__iterateUncached(fn,reverse)}function seqIterator(seq,type,reverse,useKeys){var maxIndex,ii,cache=seq._cache;return cache?(maxIndex=cache.length-1,ii=0,new Iterator(function(){var entry=cache[reverse?maxIndex-ii:ii];return ii++>maxIndex?iteratorDone():iteratorValue(type,useKeys?entry[0]:ii-1,entry[1])})):seq.__iteratorUncached(type,reverse)}function fromJS(json,converter){return converter?fromJSWith(converter,json,"",{"":json}):fromJSDefault(json)}function fromJSWith(converter,json,key,parentJSON){return Array.isArray(json)?converter.call(parentJSON,key,IndexedSeq(json).map(function(v,k){return fromJSWith(converter,v,k,json)})):isPlainObj(json)?converter.call(parentJSON,key,KeyedSeq(json).map(function(v,k){return fromJSWith(converter,v,k,json)})):json}function fromJSDefault(json){return Array.isArray(json)?IndexedSeq(json).map(fromJSDefault).toList():isPlainObj(json)?KeyedSeq(json).map(fromJSDefault).toMap():json}function isPlainObj(value){return value&&(value.constructor===Object||void 0===value.constructor)}function is(valueA,valueB){if(valueA===valueB||valueA!==valueA&&valueB!==valueB)return!0;if(!valueA||!valueB)return!1;if("function"==typeof valueA.valueOf&&"function"==typeof valueB.valueOf){if(valueA=valueA.valueOf(),valueB=valueB.valueOf(),valueA===valueB||valueA!==valueA&&valueB!==valueB)return!0;if(!valueA||!valueB)return!1}return!("function"!=typeof valueA.equals||"function"!=typeof valueB.equals||!valueA.equals(valueB))}function deepEqual(a,b){var notAssociative,entries,flipped,_,allEqual,bSize;return a===b||!(!isIterable(b)||void 0!==a.size&&void 0!==b.size&&a.size!==b.size||void 0!==a.__hash&&void 0!==b.__hash&&a.__hash!==b.__hash||isKeyed(a)!==isKeyed(b)||isIndexed(a)!==isIndexed(b)||isOrdered(a)!==isOrdered(b))&&(0===a.size&&0===b.size||(notAssociative=!isAssociative(a),isOrdered(a)?(entries=a.entries(),b.every(function(v,k){var entry=entries.next().value;return entry&&is(entry[1],v)&&(notAssociative||is(entry[0],k))})&&entries.next().done):(flipped=!1,void 0===a.size&&(void 0===b.size?"function"==typeof a.cacheResult&&a.cacheResult():(flipped=!0,_=a,a=b,b=_)),allEqual=!0,bSize=b.__iterate(function(v,k){if(notAssociative?!a.has(v):flipped?!is(v,a.get(k,NOT_SET)):!is(a.get(k,NOT_SET),v))return allEqual=!1,!1}),allEqual&&a.size===bSize)))}function Repeat(value,times){if(!(this instanceof Repeat))return new Repeat(value,times);if(this._value=value,this.size=void 0===times?1/0:Math.max(0,times),0===this.size){if(EMPTY_REPEAT)return EMPTY_REPEAT;EMPTY_REPEAT=this}}function invariant(condition,error){if(!condition)throw new Error(error)}function Range(start,end,step){if(!(this instanceof Range))return new Range(start,end,step);if(invariant(0!==step,"Cannot step a Range by 0"),start=start||0,void 0===end&&(end=1/0),step=void 0===step?1:Math.abs(step),end<start&&(step=-step),this._start=start,this._end=end,this._step=step,this.size=Math.max(0,Math.ceil((end-start)/step-1)+1),0===this.size){if(EMPTY_RANGE)return EMPTY_RANGE;EMPTY_RANGE=this}}function Collection(){throw TypeError("Abstract")}function KeyedCollection(){}function IndexedCollection(){}function SetCollection(){}function smi(i32){return i32>>>1&1073741824|3221225471&i32}function hash(o){var type,h;if(o===!1||null===o||void 0===o)return 0;if("function"==typeof o.valueOf&&(o=o.valueOf(),o===!1||null===o||void 0===o))return 0;if(o===!0)return 1;if(type="undefined"==typeof o?"undefined":_typeof(o),"number"===type){if(o!==o||o===1/0)return 0;for(h=0|o,h!==o&&(h^=4294967295*o);o>4294967295;)o/=4294967295,h^=o;return smi(h)}if("string"===type)return o.length>STRING_HASH_CACHE_MIN_STRLEN?cachedHashString(o):hashString(o);if("function"==typeof o.hashCode)return o.hashCode();if("object"===type)return hashJSObj(o);if("function"==typeof o.toString)return hashString(o.toString());throw new Error("Value type "+type+" cannot be hashed.")}function cachedHashString(string){var hash=stringHashCache[string];return void 0===hash&&(hash=hashString(string),STRING_HASH_CACHE_SIZE===STRING_HASH_CACHE_MAX_SIZE&&(STRING_HASH_CACHE_SIZE=0,stringHashCache={}),STRING_HASH_CACHE_SIZE++,stringHashCache[string]=hash),hash}function hashString(string){var ii,hash=0;for(ii=0;ii<string.length;ii++)hash=31*hash+string.charCodeAt(ii)|0;return smi(hash)}function hashJSObj(obj){var hash;if(usingWeakMap&&(hash=weakMap.get(obj),void 0!==hash))return hash;if(hash=obj[UID_HASH_KEY],void 0!==hash)return hash;if(!canDefineProperty){if(hash=obj.propertyIsEnumerable&&obj.propertyIsEnumerable[UID_HASH_KEY],void 0!==hash)return hash;if(hash=getIENodeHash(obj),void 0!==hash)return hash}if(hash=++objHashUID,1073741824&objHashUID&&(objHashUID=0),usingWeakMap)weakMap.set(obj,hash);else{if(void 0!==isExtensible&&isExtensible(obj)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(canDefineProperty)Object.defineProperty(obj,UID_HASH_KEY,{enumerable:!1,configurable:!1,writable:!1,value:hash});else if(void 0!==obj.propertyIsEnumerable&&obj.propertyIsEnumerable===obj.constructor.prototype.propertyIsEnumerable)obj.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},obj.propertyIsEnumerable[UID_HASH_KEY]=hash;else{if(void 0===obj.nodeType)throw new Error("Unable to set a non-enumerable property on object.");obj[UID_HASH_KEY]=hash}}return hash}function getIENodeHash(node){if(node&&node.nodeType>0)switch(node.nodeType){case 1:return node.uniqueID;case 9:return node.documentElement&&node.documentElement.uniqueID}}function assertNotInfinite(size){invariant(size!==1/0,"Cannot perform this action with an infinite size.")}function Map(value){return null===value||void 0===value?emptyMap():isMap(value)&&!isOrdered(value)?value:emptyMap().withMutations(function(map){var iter=KeyedIterable(value);assertNotInfinite(iter.size),iter.forEach(function(v,k){return map.set(k,v)})})}function isMap(maybeMap){return!(!maybeMap||!maybeMap[IS_MAP_SENTINEL])}function ArrayMapNode(ownerID,entries){this.ownerID=ownerID,this.entries=entries}function BitmapIndexedNode(ownerID,bitmap,nodes){this.ownerID=ownerID,this.bitmap=bitmap,this.nodes=nodes}function HashArrayMapNode(ownerID,count,nodes){this.ownerID=ownerID,this.count=count,this.nodes=nodes}function HashCollisionNode(ownerID,keyHash,entries){this.ownerID=ownerID,this.keyHash=keyHash,this.entries=entries}function ValueNode(ownerID,keyHash,entry){this.ownerID=ownerID,this.keyHash=keyHash,this.entry=entry}function MapIterator(map,type,reverse){this._type=type,this._reverse=reverse,this._stack=map._root&&mapIteratorFrame(map._root)}function mapIteratorValue(type,entry){return iteratorValue(type,entry[0],entry[1])}function mapIteratorFrame(node,prev){return{node:node,index:0,__prev:prev}}function makeMap(size,root,ownerID,hash){var map=Object.create(MapPrototype);return map.size=size,map._root=root,map.__ownerID=ownerID,map.__hash=hash,map.__altered=!1,map}function emptyMap(){return EMPTY_MAP||(EMPTY_MAP=makeMap(0))}function updateMap(map,k,v){var newRoot,newSize,didChangeSize,didAlter;if(map._root){if(didChangeSize=MakeRef(CHANGE_LENGTH),didAlter=MakeRef(DID_ALTER),newRoot=updateNode(map._root,map.__ownerID,0,void 0,k,v,didChangeSize,didAlter),!didAlter.value)return map;newSize=map.size+(didChangeSize.value?v===NOT_SET?-1:1:0)}else{if(v===NOT_SET)return map;newSize=1,newRoot=new ArrayMapNode(map.__ownerID,[[k,v]])}return map.__ownerID?(map.size=newSize,map._root=newRoot,map.__hash=void 0,map.__altered=!0,map):newRoot?makeMap(newSize,newRoot):emptyMap()}function updateNode(node,ownerID,shift,keyHash,key,value,didChangeSize,didAlter){return node?node.update(ownerID,shift,keyHash,key,value,didChangeSize,didAlter):value===NOT_SET?node:(SetRef(didAlter),SetRef(didChangeSize),new ValueNode(ownerID,keyHash,[key,value]))}function isLeafNode(node){return node.constructor===ValueNode||node.constructor===HashCollisionNode}function mergeIntoNode(node,ownerID,shift,keyHash,entry){var idx1,idx2,newNode,nodes;return node.keyHash===keyHash?new HashCollisionNode(ownerID,keyHash,[node.entry,entry]):(idx1=(0===shift?node.keyHash:node.keyHash>>>shift)&MASK,idx2=(0===shift?keyHash:keyHash>>>shift)&MASK,nodes=idx1===idx2?[mergeIntoNode(node,ownerID,shift+SHIFT,keyHash,entry)]:(newNode=new ValueNode(ownerID,keyHash,entry),idx1<idx2?[node,newNode]:[newNode,node]),new BitmapIndexedNode(ownerID,1<<idx1|1<<idx2,nodes))}function createNodes(ownerID,entries,key,value){var node,ii,entry;for(ownerID||(ownerID=new OwnerID),node=new ValueNode(ownerID,hash(key),[key,value]),ii=0;ii<entries.length;ii++)entry=entries[ii],node=node.update(ownerID,0,void 0,entry[0],entry[1]);return node}function packNodes(ownerID,nodes,count,excluding){var ii,bit,len,node,bitmap=0,packedII=0,packedNodes=new Array(count);for(ii=0,bit=1,len=nodes.length;ii<len;ii++,bit<<=1)node=nodes[ii],void 0!==node&&ii!==excluding&&(bitmap|=bit,packedNodes[packedII++]=node);return new BitmapIndexedNode(ownerID,bitmap,packedNodes)}function expandNodes(ownerID,nodes,bitmap,including,node){var ii,count=0,expandedNodes=new Array(SIZE);for(ii=0;0!==bitmap;ii++,bitmap>>>=1)expandedNodes[ii]=1&bitmap?nodes[count++]:void 0;return expandedNodes[including]=node,new HashArrayMapNode(ownerID,count+1,expandedNodes)}function mergeIntoMapWith(map,merger,iterables){var ii,value,iter,iters=[];for(ii=0;ii<iterables.length;ii++)value=iterables[ii],iter=KeyedIterable(value),isIterable(value)||(iter=iter.map(function(v){return fromJS(v)})),iters.push(iter);return mergeIntoCollectionWith(map,merger,iters)}function deepMerger(existing,value,key){return existing&&existing.mergeDeep&&isIterable(value)?existing.mergeDeep(value):is(existing,value)?existing:value}function deepMergerWith(merger){return function(existing,value,key){if(existing&&existing.mergeDeepWith&&isIterable(value))return existing.mergeDeepWith(merger,value);var nextValue=merger(existing,value,key);return is(existing,nextValue)?existing:nextValue}}function mergeIntoCollectionWith(collection,merger,iters){return iters=iters.filter(function(x){return 0!==x.size}),0===iters.length?collection:0!==collection.size||collection.__ownerID||1!==iters.length?collection.withMutations(function(collection){var ii,mergeIntoMap=merger?function(value,key){collection.update(key,NOT_SET,function(existing){return existing===NOT_SET?value:merger(existing,value,key)})}:function(value,key){collection.set(key,value)};for(ii=0;ii<iters.length;ii++)iters[ii].forEach(mergeIntoMap)}):collection.constructor(iters[0])}function updateInDeepMap(existing,keyPathIter,notSetValue,updater){var existingValue,newValue,key,nextExisting,nextUpdated,isNotSet=existing===NOT_SET,step=keyPathIter.next();return step.done?(existingValue=isNotSet?notSetValue:existing,newValue=updater(existingValue),newValue===existingValue?existing:newValue):(invariant(isNotSet||existing&&existing.set,"invalid keyPath"),key=step.value,nextExisting=isNotSet?NOT_SET:existing.get(key,NOT_SET),nextUpdated=updateInDeepMap(nextExisting,keyPathIter,notSetValue,updater),nextUpdated===nextExisting?existing:nextUpdated===NOT_SET?existing.remove(key):(isNotSet?emptyMap():existing).set(key,nextUpdated))}function popCount(x){return x-=x>>1&1431655765,x=(858993459&x)+(x>>2&858993459),x=x+(x>>4)&252645135,x+=x>>8,x+=x>>16,127&x}function setIn(array,idx,val,canEdit){var newArray=canEdit?array:arrCopy(array);return newArray[idx]=val,newArray}function spliceIn(array,idx,val,canEdit){var newArray,after,ii,newLen=array.length+1;if(canEdit&&idx+1===newLen)return array[idx]=val,array;for(newArray=new Array(newLen),after=0,ii=0;ii<newLen;ii++)ii===idx?(newArray[ii]=val,
after=-1):newArray[ii]=array[ii+after];return newArray}function spliceOut(array,idx,canEdit){var newArray,after,ii,newLen=array.length-1;if(canEdit&&idx===newLen)return array.pop(),array;for(newArray=new Array(newLen),after=0,ii=0;ii<newLen;ii++)ii===idx&&(after=1),newArray[ii]=array[ii+after];return newArray}function List(value){var iter,size,empty=emptyList();return null===value||void 0===value?empty:isList(value)?value:(iter=IndexedIterable(value),size=iter.size,0===size?empty:(assertNotInfinite(size),size>0&&size<SIZE?makeList(0,size,SHIFT,null,new VNode(iter.toArray())):empty.withMutations(function(list){list.setSize(size),iter.forEach(function(v,i){return list.set(i,v)})})))}function isList(maybeList){return!(!maybeList||!maybeList[IS_LIST_SENTINEL])}function VNode(array,ownerID){this.array=array,this.ownerID=ownerID}function iterateList(list,reverse){function iterateNodeOrLeaf(node,level,offset){return 0===level?iterateLeaf(node,offset):iterateNode(node,level,offset)}function iterateLeaf(node,offset){var array=offset===tailPos?tail&&tail.array:node&&node.array,from=offset>left?0:left-offset,to=right-offset;return to>SIZE&&(to=SIZE),function(){if(from===to)return DONE;var idx=reverse?--to:from++;return array&&array[idx]}}function iterateNode(node,level,offset){var values,array=node&&node.array,from=offset>left?0:left-offset>>level,to=(right-offset>>level)+1;return to>SIZE&&(to=SIZE),function(){for(var value,idx;;){if(values){if(value=values(),value!==DONE)return value;values=null}if(from===to)return DONE;idx=reverse?--to:from++,values=iterateNodeOrLeaf(array&&array[idx],level-SHIFT,offset+(idx<<level))}}}var left=list._origin,right=list._capacity,tailPos=getTailOffset(right),tail=list._tail;return iterateNodeOrLeaf(list._root,list._level,0)}function makeList(origin,capacity,level,root,tail,ownerID,hash){var list=Object.create(ListPrototype);return list.size=capacity-origin,list._origin=origin,list._capacity=capacity,list._level=level,list._root=root,list._tail=tail,list.__ownerID=ownerID,list.__hash=hash,list.__altered=!1,list}function emptyList(){return EMPTY_LIST||(EMPTY_LIST=makeList(0,0,SHIFT))}function updateList(list,index,value){var newTail,newRoot,didAlter;return index=wrapIndex(list,index),index!==index?list:index>=list.size||index<0?list.withMutations(function(list){index<0?setListBounds(list,index).set(0,value):setListBounds(list,0,index+1).set(index,value)}):(index+=list._origin,newTail=list._tail,newRoot=list._root,didAlter=MakeRef(DID_ALTER),index>=getTailOffset(list._capacity)?newTail=updateVNode(newTail,list.__ownerID,0,index,value,didAlter):newRoot=updateVNode(newRoot,list.__ownerID,list._level,index,value,didAlter),didAlter.value?list.__ownerID?(list._root=newRoot,list._tail=newTail,list.__hash=void 0,list.__altered=!0,list):makeList(list._origin,list._capacity,list._level,newRoot,newTail):list)}function updateVNode(node,ownerID,level,index,value,didAlter){var newNode,lowerNode,newLowerNode,idx=index>>>level&MASK,nodeHas=node&&idx<node.array.length;return nodeHas||void 0!==value?level>0?(lowerNode=node&&node.array[idx],newLowerNode=updateVNode(lowerNode,ownerID,level-SHIFT,index,value,didAlter),newLowerNode===lowerNode?node:(newNode=editableVNode(node,ownerID),newNode.array[idx]=newLowerNode,newNode)):nodeHas&&node.array[idx]===value?node:(SetRef(didAlter),newNode=editableVNode(node,ownerID),void 0===value&&idx===newNode.array.length-1?newNode.array.pop():newNode.array[idx]=value,newNode):node}function editableVNode(node,ownerID){return ownerID&&node&&ownerID===node.ownerID?node:new VNode(node?node.array.slice():[],ownerID)}function listNodeFor(list,rawIndex){var node,level;if(rawIndex>=getTailOffset(list._capacity))return list._tail;if(rawIndex<1<<list._level+SHIFT){for(node=list._root,level=list._level;node&&level>0;)node=node.array[rawIndex>>>level&MASK],level-=SHIFT;return node}}function setListBounds(list,begin,end){var owner,oldOrigin,oldCapacity,newOrigin,newCapacity,newLevel,newRoot,offsetShift,oldTailOffset,newTailOffset,oldTail,newTail,node,level,idx,beginIndex;if(void 0!==begin&&(begin=0|begin),void 0!==end&&(end=0|end),owner=list.__ownerID||new OwnerID,oldOrigin=list._origin,oldCapacity=list._capacity,newOrigin=oldOrigin+begin,newCapacity=void 0===end?oldCapacity:end<0?oldCapacity+end:oldOrigin+end,newOrigin===oldOrigin&&newCapacity===oldCapacity)return list;if(newOrigin>=newCapacity)return list.clear();for(newLevel=list._level,newRoot=list._root,offsetShift=0;newOrigin+offsetShift<0;)newRoot=new VNode(newRoot&&newRoot.array.length?[void 0,newRoot]:[],owner),newLevel+=SHIFT,offsetShift+=1<<newLevel;for(offsetShift&&(newOrigin+=offsetShift,oldOrigin+=offsetShift,newCapacity+=offsetShift,oldCapacity+=offsetShift),oldTailOffset=getTailOffset(oldCapacity),newTailOffset=getTailOffset(newCapacity);newTailOffset>=1<<newLevel+SHIFT;)newRoot=new VNode(newRoot&&newRoot.array.length?[newRoot]:[],owner),newLevel+=SHIFT;if(oldTail=list._tail,newTail=newTailOffset<oldTailOffset?listNodeFor(list,newCapacity-1):newTailOffset>oldTailOffset?new VNode([],owner):oldTail,oldTail&&newTailOffset>oldTailOffset&&newOrigin<oldCapacity&&oldTail.array.length){for(newRoot=editableVNode(newRoot,owner),node=newRoot,level=newLevel;level>SHIFT;level-=SHIFT)idx=oldTailOffset>>>level&MASK,node=node.array[idx]=editableVNode(node.array[idx],owner);node.array[oldTailOffset>>>SHIFT&MASK]=oldTail}if(newCapacity<oldCapacity&&(newTail=newTail&&newTail.removeAfter(owner,0,newCapacity)),newOrigin>=newTailOffset)newOrigin-=newTailOffset,newCapacity-=newTailOffset,newLevel=SHIFT,newRoot=null,newTail=newTail&&newTail.removeBefore(owner,0,newOrigin);else if(newOrigin>oldOrigin||newTailOffset<oldTailOffset){for(offsetShift=0;newRoot&&(beginIndex=newOrigin>>>newLevel&MASK,!(beginIndex!==newTailOffset>>>newLevel&MASK));)beginIndex&&(offsetShift+=(1<<newLevel)*beginIndex),newLevel-=SHIFT,newRoot=newRoot.array[beginIndex];newRoot&&newOrigin>oldOrigin&&(newRoot=newRoot.removeBefore(owner,newLevel,newOrigin-offsetShift)),newRoot&&newTailOffset<oldTailOffset&&(newRoot=newRoot.removeAfter(owner,newLevel,newTailOffset-offsetShift)),offsetShift&&(newOrigin-=offsetShift,newCapacity-=offsetShift)}return list.__ownerID?(list.size=newCapacity-newOrigin,list._origin=newOrigin,list._capacity=newCapacity,list._level=newLevel,list._root=newRoot,list._tail=newTail,list.__hash=void 0,list.__altered=!0,list):makeList(newOrigin,newCapacity,newLevel,newRoot,newTail)}function mergeIntoListWith(list,merger,iterables){var ii,value,iter,iters=[],maxSize=0;for(ii=0;ii<iterables.length;ii++)value=iterables[ii],iter=IndexedIterable(value),iter.size>maxSize&&(maxSize=iter.size),isIterable(value)||(iter=iter.map(function(v){return fromJS(v)})),iters.push(iter);return maxSize>list.size&&(list=list.setSize(maxSize)),mergeIntoCollectionWith(list,merger,iters)}function getTailOffset(size){return size<SIZE?0:size-1>>>SHIFT<<SHIFT}function OrderedMap(value){return null===value||void 0===value?emptyOrderedMap():isOrderedMap(value)?value:emptyOrderedMap().withMutations(function(map){var iter=KeyedIterable(value);assertNotInfinite(iter.size),iter.forEach(function(v,k){return map.set(k,v)})})}function isOrderedMap(maybeOrderedMap){return isMap(maybeOrderedMap)&&isOrdered(maybeOrderedMap)}function makeOrderedMap(map,list,ownerID,hash){var omap=Object.create(OrderedMap.prototype);return omap.size=map?map.size:0,omap._map=map,omap._list=list,omap.__ownerID=ownerID,omap.__hash=hash,omap}function emptyOrderedMap(){return EMPTY_ORDERED_MAP||(EMPTY_ORDERED_MAP=makeOrderedMap(emptyMap(),emptyList()))}function updateOrderedMap(omap,k,v){var newMap,newList,map=omap._map,list=omap._list,i=map.get(k),has=void 0!==i;if(v===NOT_SET){if(!has)return omap;list.size>=SIZE&&list.size>=2*map.size?(newList=list.filter(function(entry,idx){return void 0!==entry&&i!==idx}),newMap=newList.toKeyedSeq().map(function(entry){return entry[0]}).flip().toMap(),omap.__ownerID&&(newMap.__ownerID=newList.__ownerID=omap.__ownerID)):(newMap=map.remove(k),newList=i===list.size-1?list.pop():list.set(i,void 0))}else if(has){if(v===list.get(i)[1])return omap;newMap=map,newList=list.set(i,[k,v])}else newMap=map.set(k,list.size),newList=list.set(list.size,[k,v]);return omap.__ownerID?(omap.size=newMap.size,omap._map=newMap,omap._list=newList,omap.__hash=void 0,omap):makeOrderedMap(newMap,newList)}function ToKeyedSequence(indexed,useKeys){this._iter=indexed,this._useKeys=useKeys,this.size=indexed.size}function ToIndexedSequence(iter){this._iter=iter,this.size=iter.size}function ToSetSequence(iter){this._iter=iter,this.size=iter.size}function FromEntriesSequence(entries){this._iter=entries,this.size=entries.size}function flipFactory(iterable){var flipSequence=makeSequence(iterable);return flipSequence._iter=iterable,flipSequence.size=iterable.size,flipSequence.flip=function(){return iterable},flipSequence.reverse=function(){var reversedSequence=iterable.reverse.apply(this);return reversedSequence.flip=function(){return iterable.reverse()},reversedSequence},flipSequence.has=function(key){return iterable.includes(key)},flipSequence.includes=function(key){return iterable.has(key)},flipSequence.cacheResult=cacheResultThrough,flipSequence.__iterateUncached=function(fn,reverse){var this$0=this;return iterable.__iterate(function(v,k){return fn(k,v,this$0)!==!1},reverse)},flipSequence.__iteratorUncached=function(type,reverse){if(type===ITERATE_ENTRIES){var iterator=iterable.__iterator(type,reverse);return new Iterator(function(){var k,step=iterator.next();return step.done||(k=step.value[0],step.value[0]=step.value[1],step.value[1]=k),step})}return iterable.__iterator(type===ITERATE_VALUES?ITERATE_KEYS:ITERATE_VALUES,reverse)},flipSequence}function mapFactory(iterable,mapper,context){var mappedSequence=makeSequence(iterable);return mappedSequence.size=iterable.size,mappedSequence.has=function(key){return iterable.has(key)},mappedSequence.get=function(key,notSetValue){var v=iterable.get(key,NOT_SET);return v===NOT_SET?notSetValue:mapper.call(context,v,key,iterable)},mappedSequence.__iterateUncached=function(fn,reverse){var this$0=this;return iterable.__iterate(function(v,k,c){return fn(mapper.call(context,v,k,c),k,this$0)!==!1},reverse)},mappedSequence.__iteratorUncached=function(type,reverse){var iterator=iterable.__iterator(ITERATE_ENTRIES,reverse);return new Iterator(function(){var entry,key,step=iterator.next();return step.done?step:(entry=step.value,key=entry[0],iteratorValue(type,key,mapper.call(context,entry[1],key,iterable),step))})},mappedSequence}function reverseFactory(iterable,useKeys){var reversedSequence=makeSequence(iterable);return reversedSequence._iter=iterable,reversedSequence.size=iterable.size,reversedSequence.reverse=function(){return iterable},iterable.flip&&(reversedSequence.flip=function(){var flipSequence=flipFactory(iterable);return flipSequence.reverse=function(){return iterable.flip()},flipSequence}),reversedSequence.get=function(key,notSetValue){return iterable.get(useKeys?key:-1-key,notSetValue)},reversedSequence.has=function(key){return iterable.has(useKeys?key:-1-key)},reversedSequence.includes=function(value){return iterable.includes(value)},reversedSequence.cacheResult=cacheResultThrough,reversedSequence.__iterate=function(fn,reverse){var this$0=this;return iterable.__iterate(function(v,k){return fn(v,k,this$0)},!reverse)},reversedSequence.__iterator=function(type,reverse){return iterable.__iterator(type,!reverse)},reversedSequence}function filterFactory(iterable,predicate,context,useKeys){var filterSequence=makeSequence(iterable);return useKeys&&(filterSequence.has=function(key){var v=iterable.get(key,NOT_SET);return v!==NOT_SET&&!!predicate.call(context,v,key,iterable)},filterSequence.get=function(key,notSetValue){var v=iterable.get(key,NOT_SET);return v!==NOT_SET&&predicate.call(context,v,key,iterable)?v:notSetValue}),filterSequence.__iterateUncached=function(fn,reverse){var this$0=this,iterations=0;return iterable.__iterate(function(v,k,c){if(predicate.call(context,v,k,c))return iterations++,fn(v,useKeys?k:iterations-1,this$0)},reverse),iterations},filterSequence.__iteratorUncached=function(type,reverse){var iterator=iterable.__iterator(ITERATE_ENTRIES,reverse),iterations=0;return new Iterator(function(){for(var step,entry,key,value;;){if(step=iterator.next(),step.done)return step;if(entry=step.value,key=entry[0],value=entry[1],predicate.call(context,value,key,iterable))return iteratorValue(type,useKeys?key:iterations++,value,step)}})},filterSequence}function countByFactory(iterable,grouper,context){var groups=Map().asMutable();return iterable.__iterate(function(v,k){groups.update(grouper.call(context,v,k,iterable),0,function(a){return a+1})}),groups.asImmutable()}function groupByFactory(iterable,grouper,context){var coerce,isKeyedIter=isKeyed(iterable),groups=(isOrdered(iterable)?OrderedMap():Map()).asMutable();return iterable.__iterate(function(v,k){groups.update(grouper.call(context,v,k,iterable),function(a){return a=a||[],a.push(isKeyedIter?[k,v]:v),a})}),coerce=iterableClass(iterable),groups.map(function(arr){return reify(iterable,coerce(arr))})}function sliceFactory(iterable,begin,end,useKeys){var resolvedBegin,resolvedEnd,resolvedSize,sliceSize,sliceSeq,originalSize=iterable.size;return void 0!==begin&&(begin=0|begin),void 0!==end&&(end=end===1/0?originalSize:0|end),wholeSlice(begin,end,originalSize)?iterable:(resolvedBegin=resolveBegin(begin,originalSize),resolvedEnd=resolveEnd(end,originalSize),resolvedBegin!==resolvedBegin||resolvedEnd!==resolvedEnd?sliceFactory(iterable.toSeq().cacheResult(),begin,end,useKeys):(resolvedSize=resolvedEnd-resolvedBegin,resolvedSize===resolvedSize&&(sliceSize=resolvedSize<0?0:resolvedSize),sliceSeq=makeSequence(iterable),sliceSeq.size=0===sliceSize?sliceSize:iterable.size&&sliceSize||void 0,!useKeys&&isSeq(iterable)&&sliceSize>=0&&(sliceSeq.get=function(index,notSetValue){return index=wrapIndex(this,index),index>=0&&index<sliceSize?iterable.get(index+resolvedBegin,notSetValue):notSetValue}),sliceSeq.__iterateUncached=function(fn,reverse){var skipped,isSkipping,iterations,this$0=this;return 0===sliceSize?0:reverse?this.cacheResult().__iterate(fn,reverse):(skipped=0,isSkipping=!0,iterations=0,iterable.__iterate(function(v,k){if(!isSkipping||!(isSkipping=skipped++<resolvedBegin))return iterations++,fn(v,useKeys?k:iterations-1,this$0)!==!1&&iterations!==sliceSize}),iterations)},sliceSeq.__iteratorUncached=function(type,reverse){var iterator,skipped,iterations;return 0!==sliceSize&&reverse?this.cacheResult().__iterator(type,reverse):(iterator=0!==sliceSize&&iterable.__iterator(type,reverse),skipped=0,iterations=0,new Iterator(function(){for(;skipped++<resolvedBegin;)iterator.next();if(++iterations>sliceSize)return iteratorDone();var step=iterator.next();return useKeys||type===ITERATE_VALUES?step:type===ITERATE_KEYS?iteratorValue(type,iterations-1,void 0,step):iteratorValue(type,iterations-1,step.value[1],step)}))},sliceSeq))}function takeWhileFactory(iterable,predicate,context){var takeSequence=makeSequence(iterable);return takeSequence.__iterateUncached=function(fn,reverse){var iterations,this$0=this;return reverse?this.cacheResult().__iterate(fn,reverse):(iterations=0,iterable.__iterate(function(v,k,c){return predicate.call(context,v,k,c)&&++iterations&&fn(v,k,this$0)}),iterations)},takeSequence.__iteratorUncached=function(type,reverse){var iterator,iterating,this$0=this;return reverse?this.cacheResult().__iterator(type,reverse):(iterator=iterable.__iterator(ITERATE_ENTRIES,reverse),iterating=!0,new Iterator(function(){var step,entry,k,v;return iterating?(step=iterator.next(),step.done?step:(entry=step.value,k=entry[0],v=entry[1],predicate.call(context,v,k,this$0)?type===ITERATE_ENTRIES?step:iteratorValue(type,k,v,step):(iterating=!1,iteratorDone()))):iteratorDone()}))},takeSequence}function skipWhileFactory(iterable,predicate,context,useKeys){var skipSequence=makeSequence(iterable);return skipSequence.__iterateUncached=function(fn,reverse){var isSkipping,iterations,this$0=this;return reverse?this.cacheResult().__iterate(fn,reverse):(isSkipping=!0,iterations=0,iterable.__iterate(function(v,k,c){if(!isSkipping||!(isSkipping=predicate.call(context,v,k,c)))return iterations++,fn(v,useKeys?k:iterations-1,this$0)}),iterations)},skipSequence.__iteratorUncached=function(type,reverse){var iterator,skipping,iterations,this$0=this;return reverse?this.cacheResult().__iterator(type,reverse):(iterator=iterable.__iterator(ITERATE_ENTRIES,reverse),skipping=!0,iterations=0,new Iterator(function(){var step,k,v,entry;do{if(step=iterator.next(),step.done)return useKeys||type===ITERATE_VALUES?step:type===ITERATE_KEYS?iteratorValue(type,iterations++,void 0,step):iteratorValue(type,iterations++,step.value[1],step);entry=step.value,k=entry[0],v=entry[1],skipping&&(skipping=predicate.call(context,v,k,this$0))}while(skipping);return type===ITERATE_ENTRIES?step:iteratorValue(type,k,v,step)}))},skipSequence}function concatFactory(iterable,values){var singleton,concatSeq,isKeyedIterable=isKeyed(iterable),iters=[iterable].concat(values).map(function(v){return isIterable(v)?isKeyedIterable&&(v=KeyedIterable(v)):v=isKeyedIterable?keyedSeqFromValue(v):indexedSeqFromValue(Array.isArray(v)?v:[v]),v}).filter(function(v){return 0!==v.size});return 0===iters.length?iterable:1===iters.length&&(singleton=iters[0],singleton===iterable||isKeyedIterable&&isKeyed(singleton)||isIndexed(iterable)&&isIndexed(singleton))?singleton:(concatSeq=new ArraySeq(iters),isKeyedIterable?concatSeq=concatSeq.toKeyedSeq():isIndexed(iterable)||(concatSeq=concatSeq.toSetSeq()),concatSeq=concatSeq.flatten(!0),concatSeq.size=iters.reduce(function(sum,seq){if(void 0!==sum){var size=seq.size;if(void 0!==size)return sum+size}},0),concatSeq)}function flattenFactory(iterable,depth,useKeys){var flatSequence=makeSequence(iterable);return flatSequence.__iterateUncached=function(fn,reverse){function flatDeep(iter,currentDepth){var this$0=this;iter.__iterate(function(v,k){return(!depth||currentDepth<depth)&&isIterable(v)?flatDeep(v,currentDepth+1):fn(v,useKeys?k:iterations++,this$0)===!1&&(stopped=!0),!stopped},reverse)}var iterations=0,stopped=!1;return flatDeep(iterable,0),iterations},flatSequence.__iteratorUncached=function(type,reverse){var iterator=iterable.__iterator(type,reverse),stack=[],iterations=0;return new Iterator(function(){for(var step,v;iterator;)if(step=iterator.next(),step.done===!1){if(v=step.value,type===ITERATE_ENTRIES&&(v=v[1]),depth&&!(stack.length<depth)||!isIterable(v))return useKeys?step:iteratorValue(type,iterations++,v,step);stack.push(iterator),iterator=v.__iterator(type,reverse)}else iterator=stack.pop();return iteratorDone()})},flatSequence}function flatMapFactory(iterable,mapper,context){var coerce=iterableClass(iterable);return iterable.toSeq().map(function(v,k){return coerce(mapper.call(context,v,k,iterable))}).flatten(!0)}function interposeFactory(iterable,separator){var interposedSequence=makeSequence(iterable);return interposedSequence.size=iterable.size&&2*iterable.size-1,interposedSequence.__iterateUncached=function(fn,reverse){var this$0=this,iterations=0;return iterable.__iterate(function(v,k){return(!iterations||fn(separator,iterations++,this$0)!==!1)&&fn(v,iterations++,this$0)!==!1},reverse),iterations},interposedSequence.__iteratorUncached=function(type,reverse){var step,iterator=iterable.__iterator(ITERATE_VALUES,reverse),iterations=0;return new Iterator(function(){return(!step||iterations%2)&&(step=iterator.next(),step.done)?step:iterations%2?iteratorValue(type,iterations++,separator):iteratorValue(type,iterations++,step.value,step)})},interposedSequence}function sortFactory(iterable,comparator,mapper){var isKeyedIterable,index,entries;return comparator||(comparator=defaultComparator),isKeyedIterable=isKeyed(iterable),index=0,entries=iterable.toSeq().map(function(v,k){return[k,v,index++,mapper?mapper(v,k,iterable):v]}).toArray(),entries.sort(function(a,b){return comparator(a[3],b[3])||a[2]-b[2]}).forEach(isKeyedIterable?function(v,i){entries[i].length=2}:function(v,i){entries[i]=v[1]}),isKeyedIterable?KeyedSeq(entries):isIndexed(iterable)?IndexedSeq(entries):SetSeq(entries)}function maxFactory(iterable,comparator,mapper){if(comparator||(comparator=defaultComparator),mapper){var entry=iterable.toSeq().map(function(v,k){return[v,mapper(v,k,iterable)]}).reduce(function(a,b){return maxCompare(comparator,a[1],b[1])?b:a});return entry&&entry[0]}return iterable.reduce(function(a,b){return maxCompare(comparator,a,b)?b:a})}function maxCompare(comparator,a,b){var comp=comparator(b,a);return 0===comp&&b!==a&&(void 0===b||null===b||b!==b)||comp>0}function zipWithFactory(keyIter,zipper,iters){var zipSequence=makeSequence(keyIter);return zipSequence.size=new ArraySeq(iters).map(function(i){return i.size}).min(),zipSequence.__iterate=function(fn,reverse){for(var step,iterator=this.__iterator(ITERATE_VALUES,reverse),iterations=0;!(step=iterator.next()).done&&fn(step.value,iterations++,this)!==!1;);return iterations},zipSequence.__iteratorUncached=function(type,reverse){var iterators=iters.map(function(i){return i=Iterable(i),getIterator(reverse?i.reverse():i)}),iterations=0,isDone=!1;return new Iterator(function(){var steps;return isDone||(steps=iterators.map(function(i){return i.next()}),isDone=steps.some(function(s){return s.done})),isDone?iteratorDone():iteratorValue(type,iterations++,zipper.apply(null,steps.map(function(s){return s.value})))})},zipSequence}function reify(iter,seq){return isSeq(iter)?seq:iter.constructor(seq)}function validateEntry(entry){if(entry!==Object(entry))throw new TypeError("Expected [K, V] tuple: "+entry)}function resolveSize(iter){return assertNotInfinite(iter.size),ensureSize(iter)}function iterableClass(iterable){return isKeyed(iterable)?KeyedIterable:isIndexed(iterable)?IndexedIterable:SetIterable}function makeSequence(iterable){return Object.create((isKeyed(iterable)?KeyedSeq:isIndexed(iterable)?IndexedSeq:SetSeq).prototype)}function cacheResultThrough(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):Seq.prototype.cacheResult.call(this)}function defaultComparator(a,b){return a>b?1:a<b?-1:0}function forceIterator(keyPath){var iter=getIterator(keyPath);if(!iter){if(!isArrayLike(keyPath))throw new TypeError("Expected iterable or array-like: "+keyPath);iter=getIterator(Iterable(keyPath))}return iter}function Record(defaultValues,name){var hasInitialized,RecordType=function Record(values){if(values instanceof RecordType)return values;if(!(this instanceof RecordType))return new RecordType(values);if(!hasInitialized){hasInitialized=!0;var keys=Object.keys(defaultValues);setProps(RecordTypePrototype,keys),RecordTypePrototype.size=keys.length,RecordTypePrototype._name=name,RecordTypePrototype._keys=keys,RecordTypePrototype._defaultValues=defaultValues}this._map=Map(values)},RecordTypePrototype=RecordType.prototype=Object.create(RecordPrototype);return RecordTypePrototype.constructor=RecordType,RecordType}function makeRecord(likeRecord,map,ownerID){var record=Object.create(Object.getPrototypeOf(likeRecord));return record._map=map,record.__ownerID=ownerID,record}function recordName(record){return record._name||record.constructor.name||"Record"}function setProps(prototype,names){try{names.forEach(setProp.bind(void 0,prototype))}catch(error){}}function setProp(prototype,name){Object.defineProperty(prototype,name,{get:function get(){return this.get(name)},set:function set(value){invariant(this.__ownerID,"Cannot set on an immutable record."),this.set(name,value)}})}function Set(value){return null===value||void 0===value?emptySet():isSet(value)&&!isOrdered(value)?value:emptySet().withMutations(function(set){var iter=SetIterable(value);assertNotInfinite(iter.size),iter.forEach(function(v){return set.add(v)})})}function isSet(maybeSet){return!(!maybeSet||!maybeSet[IS_SET_SENTINEL])}function updateSet(set,newMap){return set.__ownerID?(set.size=newMap.size,set._map=newMap,set):newMap===set._map?set:0===newMap.size?set.__empty():set.__make(newMap)}function makeSet(map,ownerID){var set=Object.create(SetPrototype);return set.size=map?map.size:0,set._map=map,set.__ownerID=ownerID,set}function emptySet(){return EMPTY_SET||(EMPTY_SET=makeSet(emptyMap()))}function OrderedSet(value){return null===value||void 0===value?emptyOrderedSet():isOrderedSet(value)?value:emptyOrderedSet().withMutations(function(set){var iter=SetIterable(value);assertNotInfinite(iter.size),iter.forEach(function(v){return set.add(v)})})}function isOrderedSet(maybeOrderedSet){return isSet(maybeOrderedSet)&&isOrdered(maybeOrderedSet)}function makeOrderedSet(map,ownerID){var set=Object.create(OrderedSetPrototype);return set.size=map?map.size:0,set._map=map,set.__ownerID=ownerID,set}function emptyOrderedSet(){return EMPTY_ORDERED_SET||(EMPTY_ORDERED_SET=makeOrderedSet(emptyOrderedMap()))}function Stack(value){return null===value||void 0===value?emptyStack():isStack(value)?value:emptyStack().unshiftAll(value)}function isStack(maybeStack){return!(!maybeStack||!maybeStack[IS_STACK_SENTINEL])}function makeStack(size,head,ownerID,hash){var map=Object.create(StackPrototype);return map.size=size,map._head=head,map.__ownerID=ownerID,map.__hash=hash,map.__altered=!1,map}function emptyStack(){return EMPTY_STACK||(EMPTY_STACK=makeStack(0))}function mixin(ctor,methods){var keyCopier=function keyCopier(key){ctor.prototype[key]=methods[key]};return Object.keys(methods).forEach(keyCopier),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(methods).forEach(keyCopier),ctor}function keyMapper(v,k){return k}function entryMapper(v,k){return[k,v]}function not(predicate){return function(){return!predicate.apply(this,arguments)}}function neg(predicate){return function(){return-predicate.apply(this,arguments)}}function quoteString(value){return"string"==typeof value?JSON.stringify(value):String(value)}function defaultZipper(){return arrCopy(arguments)}function defaultNegComparator(a,b){return a<b?1:a>b?-1:0}function hashIterable(iterable){var ordered,keyed,h,size;return iterable.size===1/0?0:(ordered=isOrdered(iterable),keyed=isKeyed(iterable),h=ordered?1:0,size=iterable.__iterate(keyed?ordered?function(v,k){h=31*h+hashMerge(hash(v),hash(k))|0}:function(v,k){h=h+hashMerge(hash(v),hash(k))|0}:ordered?function(v){h=31*h+hash(v)|0}:function(v){h=h+hash(v)|0}),murmurHashOfSize(size,h))}function murmurHashOfSize(size,h){return h=imul(h,3432918353),h=imul(h<<15|h>>>-15,461845907),h=imul(h<<13|h>>>-13,5),h=(h+3864292196|0)^size,h=imul(h^h>>>16,2246822507),h=imul(h^h>>>13,3266489909),h=smi(h^h>>>16)}function hashMerge(a,b){return a^b+2654435769+(a<<6)+(a>>2)|0}var IS_ITERABLE_SENTINEL,IS_KEYED_SENTINEL,IS_INDEXED_SENTINEL,IS_ORDERED_SENTINEL,DELETE,SHIFT,SIZE,MASK,NOT_SET,CHANGE_LENGTH,DID_ALTER,ITERATE_KEYS,ITERATE_VALUES,ITERATE_ENTRIES,REAL_ITERATOR_SYMBOL,FAUX_ITERATOR_SYMBOL,ITERATOR_SYMBOL,IS_SEQ_SENTINEL,EMPTY_SEQ,EMPTY_REPEAT,EMPTY_RANGE,imul,isExtensible,canDefineProperty,usingWeakMap,weakMap,objHashUID,UID_HASH_KEY,STRING_HASH_CACHE_MIN_STRLEN,STRING_HASH_CACHE_MAX_SIZE,STRING_HASH_CACHE_SIZE,stringHashCache,IS_MAP_SENTINEL,MapPrototype,EMPTY_MAP,MAX_ARRAY_MAP_SIZE,MAX_BITMAP_INDEXED_SIZE,MIN_HASH_ARRAY_MAP_SIZE,IS_LIST_SENTINEL,ListPrototype,DONE,EMPTY_LIST,EMPTY_ORDERED_MAP,RecordPrototype,IS_SET_SENTINEL,SetPrototype,EMPTY_SET,OrderedSetPrototype,EMPTY_ORDERED_SET,IS_STACK_SENTINEL,StackPrototype,EMPTY_STACK,IterablePrototype,KeyedIterablePrototype,Immutable,SLICE$0=Array.prototype.slice;return createClass(KeyedIterable,Iterable),createClass(IndexedIterable,Iterable),createClass(SetIterable,Iterable),Iterable.isIterable=isIterable,Iterable.isKeyed=isKeyed,Iterable.isIndexed=isIndexed,Iterable.isAssociative=isAssociative,Iterable.isOrdered=isOrdered,Iterable.Keyed=KeyedIterable,Iterable.Indexed=IndexedIterable,Iterable.Set=SetIterable,IS_ITERABLE_SENTINEL="@@__IMMUTABLE_ITERABLE__@@",IS_KEYED_SENTINEL="@@__IMMUTABLE_KEYED__@@",IS_INDEXED_SENTINEL="@@__IMMUTABLE_INDEXED__@@",IS_ORDERED_SENTINEL="@@__IMMUTABLE_ORDERED__@@",DELETE="delete",SHIFT=5,SIZE=1<<SHIFT,MASK=SIZE-1,NOT_SET={},CHANGE_LENGTH={value:!1},DID_ALTER={value:!1},ITERATE_KEYS=0,ITERATE_VALUES=1,ITERATE_ENTRIES=2,REAL_ITERATOR_SYMBOL="function"==typeof Symbol&&Symbol.iterator,FAUX_ITERATOR_SYMBOL="@@iterator",ITERATOR_SYMBOL=REAL_ITERATOR_SYMBOL||FAUX_ITERATOR_SYMBOL,Iterator.prototype.toString=function(){return"[Iterator]"},Iterator.KEYS=ITERATE_KEYS,Iterator.VALUES=ITERATE_VALUES,Iterator.ENTRIES=ITERATE_ENTRIES,Iterator.prototype.inspect=Iterator.prototype.toSource=function(){return this.toString()},Iterator.prototype[ITERATOR_SYMBOL]=function(){return this},createClass(Seq,Iterable),Seq.of=function(){return Seq(arguments)},Seq.prototype.toSeq=function(){return this},Seq.prototype.toString=function(){return this.__toString("Seq {","}")},Seq.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},Seq.prototype.__iterate=function(fn,reverse){return seqIterate(this,fn,reverse,!0)},Seq.prototype.__iterator=function(type,reverse){return seqIterator(this,type,reverse,!0)},createClass(KeyedSeq,Seq),KeyedSeq.prototype.toKeyedSeq=function(){return this},createClass(IndexedSeq,Seq),IndexedSeq.of=function(){return IndexedSeq(arguments)},IndexedSeq.prototype.toIndexedSeq=function(){return this},IndexedSeq.prototype.toString=function(){return this.__toString("Seq [","]")},IndexedSeq.prototype.__iterate=function(fn,reverse){return seqIterate(this,fn,reverse,!1)},IndexedSeq.prototype.__iterator=function(type,reverse){return seqIterator(this,type,reverse,!1)},createClass(SetSeq,Seq),SetSeq.of=function(){return SetSeq(arguments)},SetSeq.prototype.toSetSeq=function(){return this},Seq.isSeq=isSeq,Seq.Keyed=KeyedSeq,Seq.Set=SetSeq,Seq.Indexed=IndexedSeq,IS_SEQ_SENTINEL="@@__IMMUTABLE_SEQ__@@",Seq.prototype[IS_SEQ_SENTINEL]=!0,createClass(ArraySeq,IndexedSeq),ArraySeq.prototype.get=function(index,notSetValue){return this.has(index)?this._array[wrapIndex(this,index)]:notSetValue},ArraySeq.prototype.__iterate=function(fn,reverse){var ii,array=this._array,maxIndex=array.length-1;for(ii=0;ii<=maxIndex;ii++)if(fn(array[reverse?maxIndex-ii:ii],ii,this)===!1)return ii+1;return ii},ArraySeq.prototype.__iterator=function(type,reverse){var array=this._array,maxIndex=array.length-1,ii=0;return new Iterator(function(){return ii>maxIndex?iteratorDone():iteratorValue(type,ii,array[reverse?maxIndex-ii++:ii++])})},createClass(ObjectSeq,KeyedSeq),ObjectSeq.prototype.get=function(key,notSetValue){return void 0===notSetValue||this.has(key)?this._object[key]:notSetValue},ObjectSeq.prototype.has=function(key){return this._object.hasOwnProperty(key)},ObjectSeq.prototype.__iterate=function(fn,reverse){var ii,key,object=this._object,keys=this._keys,maxIndex=keys.length-1;for(ii=0;ii<=maxIndex;ii++)if(key=keys[reverse?maxIndex-ii:ii],fn(object[key],key,this)===!1)return ii+1;return ii},ObjectSeq.prototype.__iterator=function(type,reverse){var object=this._object,keys=this._keys,maxIndex=keys.length-1,ii=0;return new Iterator(function(){var key=keys[reverse?maxIndex-ii:ii];return ii++>maxIndex?iteratorDone():iteratorValue(type,key,object[key])})},ObjectSeq.prototype[IS_ORDERED_SENTINEL]=!0,createClass(IterableSeq,IndexedSeq),IterableSeq.prototype.__iterateUncached=function(fn,reverse){var iterable,iterator,iterations,step;if(reverse)return this.cacheResult().__iterate(fn,reverse);if(iterable=this._iterable,iterator=getIterator(iterable),iterations=0,isIterator(iterator))for(;!(step=iterator.next()).done&&fn(step.value,iterations++,this)!==!1;);return iterations},IterableSeq.prototype.__iteratorUncached=function(type,reverse){var iterable,iterator,iterations;return reverse?this.cacheResult().__iterator(type,reverse):(iterable=this._iterable,iterator=getIterator(iterable),isIterator(iterator)?(iterations=0,new Iterator(function(){var step=iterator.next();
return step.done?step:iteratorValue(type,iterations++,step.value)})):new Iterator(iteratorDone))},createClass(IteratorSeq,IndexedSeq),IteratorSeq.prototype.__iterateUncached=function(fn,reverse){var iterator,cache,iterations,step,val;if(reverse)return this.cacheResult().__iterate(fn,reverse);for(iterator=this._iterator,cache=this._iteratorCache,iterations=0;iterations<cache.length;)if(fn(cache[iterations],iterations++,this)===!1)return iterations;for(;!(step=iterator.next()).done&&(val=step.value,cache[iterations]=val,fn(val,iterations++,this)!==!1););return iterations},IteratorSeq.prototype.__iteratorUncached=function(type,reverse){var iterator,cache,iterations;return reverse?this.cacheResult().__iterator(type,reverse):(iterator=this._iterator,cache=this._iteratorCache,iterations=0,new Iterator(function(){if(iterations>=cache.length){var step=iterator.next();if(step.done)return step;cache[iterations]=step.value}return iteratorValue(type,iterations,cache[iterations++])}))},createClass(Repeat,IndexedSeq),Repeat.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},Repeat.prototype.get=function(index,notSetValue){return this.has(index)?this._value:notSetValue},Repeat.prototype.includes=function(searchValue){return is(this._value,searchValue)},Repeat.prototype.slice=function(begin,end){var size=this.size;return wholeSlice(begin,end,size)?this:new Repeat(this._value,resolveEnd(end,size)-resolveBegin(begin,size))},Repeat.prototype.reverse=function(){return this},Repeat.prototype.indexOf=function(searchValue){return is(this._value,searchValue)?0:-1},Repeat.prototype.lastIndexOf=function(searchValue){return is(this._value,searchValue)?this.size:-1},Repeat.prototype.__iterate=function(fn,reverse){for(var ii=0;ii<this.size;ii++)if(fn(this._value,ii,this)===!1)return ii+1;return ii},Repeat.prototype.__iterator=function(type,reverse){var this$0=this,ii=0;return new Iterator(function(){return ii<this$0.size?iteratorValue(type,ii++,this$0._value):iteratorDone()})},Repeat.prototype.equals=function(other){return other instanceof Repeat?is(this._value,other._value):deepEqual(other)},createClass(Range,IndexedSeq),Range.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},Range.prototype.get=function(index,notSetValue){return this.has(index)?this._start+wrapIndex(this,index)*this._step:notSetValue},Range.prototype.includes=function(searchValue){var possibleIndex=(searchValue-this._start)/this._step;return possibleIndex>=0&&possibleIndex<this.size&&possibleIndex===Math.floor(possibleIndex)},Range.prototype.slice=function(begin,end){return wholeSlice(begin,end,this.size)?this:(begin=resolveBegin(begin,this.size),end=resolveEnd(end,this.size),end<=begin?new Range(0,0):new Range(this.get(begin,this._end),this.get(end,this._end),this._step))},Range.prototype.indexOf=function(searchValue){var index,offsetValue=searchValue-this._start;return offsetValue%this._step===0&&(index=offsetValue/this._step,index>=0&&index<this.size)?index:-1},Range.prototype.lastIndexOf=function(searchValue){return this.indexOf(searchValue)},Range.prototype.__iterate=function(fn,reverse){var ii,maxIndex=this.size-1,step=this._step,value=reverse?this._start+maxIndex*step:this._start;for(ii=0;ii<=maxIndex;ii++){if(fn(value,ii,this)===!1)return ii+1;value+=reverse?-step:step}return ii},Range.prototype.__iterator=function(type,reverse){var maxIndex=this.size-1,step=this._step,value=reverse?this._start+maxIndex*step:this._start,ii=0;return new Iterator(function(){var v=value;return value+=reverse?-step:step,ii>maxIndex?iteratorDone():iteratorValue(type,ii++,v)})},Range.prototype.equals=function(other){return other instanceof Range?this._start===other._start&&this._end===other._end&&this._step===other._step:deepEqual(this,other)},createClass(Collection,Iterable),createClass(KeyedCollection,Collection),createClass(IndexedCollection,Collection),createClass(SetCollection,Collection),Collection.Keyed=KeyedCollection,Collection.Indexed=IndexedCollection,Collection.Set=SetCollection,imul="function"==typeof Math.imul&&Math.imul(4294967295,2)===-2?Math.imul:function imul(a,b){var c,d;return a=0|a,b=0|b,c=65535&a,d=65535&b,c*d+((a>>>16)*d+c*(b>>>16)<<16>>>0)|0},isExtensible=Object.isExtensible,canDefineProperty=function(){try{return Object.defineProperty({},"@",{}),!0}catch(e){return!1}}(),usingWeakMap="function"==typeof WeakMap,usingWeakMap&&(weakMap=new WeakMap),objHashUID=0,UID_HASH_KEY="__immutablehash__","function"==typeof Symbol&&(UID_HASH_KEY=Symbol(UID_HASH_KEY)),STRING_HASH_CACHE_MIN_STRLEN=16,STRING_HASH_CACHE_MAX_SIZE=255,STRING_HASH_CACHE_SIZE=0,stringHashCache={},createClass(Map,KeyedCollection),Map.of=function(){var keyValues=SLICE$0.call(arguments,0);return emptyMap().withMutations(function(map){for(var i=0;i<keyValues.length;i+=2){if(i+1>=keyValues.length)throw new Error("Missing value for key: "+keyValues[i]);map.set(keyValues[i],keyValues[i+1])}})},Map.prototype.toString=function(){return this.__toString("Map {","}")},Map.prototype.get=function(k,notSetValue){return this._root?this._root.get(0,void 0,k,notSetValue):notSetValue},Map.prototype.set=function(k,v){return updateMap(this,k,v)},Map.prototype.setIn=function(keyPath,v){return this.updateIn(keyPath,NOT_SET,function(){return v})},Map.prototype.remove=function(k){return updateMap(this,k,NOT_SET)},Map.prototype.deleteIn=function(keyPath){return this.updateIn(keyPath,function(){return NOT_SET})},Map.prototype.update=function(k,notSetValue,updater){return 1===arguments.length?k(this):this.updateIn([k],notSetValue,updater)},Map.prototype.updateIn=function(keyPath,notSetValue,updater){updater||(updater=notSetValue,notSetValue=void 0);var updatedValue=updateInDeepMap(this,forceIterator(keyPath),notSetValue,updater);return updatedValue===NOT_SET?void 0:updatedValue},Map.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):emptyMap()},Map.prototype.merge=function(){return mergeIntoMapWith(this,void 0,arguments)},Map.prototype.mergeWith=function(merger){var iters=SLICE$0.call(arguments,1);return mergeIntoMapWith(this,merger,iters)},Map.prototype.mergeIn=function(keyPath){var iters=SLICE$0.call(arguments,1);return this.updateIn(keyPath,emptyMap(),function(m){return"function"==typeof m.merge?m.merge.apply(m,iters):iters[iters.length-1]})},Map.prototype.mergeDeep=function(){return mergeIntoMapWith(this,deepMerger,arguments)},Map.prototype.mergeDeepWith=function(merger){var iters=SLICE$0.call(arguments,1);return mergeIntoMapWith(this,deepMergerWith(merger),iters)},Map.prototype.mergeDeepIn=function(keyPath){var iters=SLICE$0.call(arguments,1);return this.updateIn(keyPath,emptyMap(),function(m){return"function"==typeof m.mergeDeep?m.mergeDeep.apply(m,iters):iters[iters.length-1]})},Map.prototype.sort=function(comparator){return OrderedMap(sortFactory(this,comparator))},Map.prototype.sortBy=function(mapper,comparator){return OrderedMap(sortFactory(this,comparator,mapper))},Map.prototype.withMutations=function(fn){var mutable=this.asMutable();return fn(mutable),mutable.wasAltered()?mutable.__ensureOwner(this.__ownerID):this},Map.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new OwnerID)},Map.prototype.asImmutable=function(){return this.__ensureOwner()},Map.prototype.wasAltered=function(){return this.__altered},Map.prototype.__iterator=function(type,reverse){return new MapIterator(this,type,reverse)},Map.prototype.__iterate=function(fn,reverse){var this$0=this,iterations=0;return this._root&&this._root.iterate(function(entry){return iterations++,fn(entry[1],entry[0],this$0)},reverse),iterations},Map.prototype.__ensureOwner=function(ownerID){return ownerID===this.__ownerID?this:ownerID?makeMap(this.size,this._root,ownerID,this.__hash):(this.__ownerID=ownerID,this.__altered=!1,this)},Map.isMap=isMap,IS_MAP_SENTINEL="@@__IMMUTABLE_MAP__@@",MapPrototype=Map.prototype,MapPrototype[IS_MAP_SENTINEL]=!0,MapPrototype[DELETE]=MapPrototype.remove,MapPrototype.removeIn=MapPrototype.deleteIn,ArrayMapNode.prototype.get=function(shift,keyHash,key,notSetValue){var ii,len,entries=this.entries;for(ii=0,len=entries.length;ii<len;ii++)if(is(key,entries[ii][0]))return entries[ii][1];return notSetValue},ArrayMapNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){var len,exists,isEditable,newEntries,removed=value===NOT_SET,entries=this.entries,idx=0;for(len=entries.length;idx<len&&!is(key,entries[idx][0]);idx++);return exists=idx<len,(exists?entries[idx][1]===value:removed)?this:(SetRef(didAlter),(removed||!exists)&&SetRef(didChangeSize),removed&&1===entries.length?void 0:!exists&&!removed&&entries.length>=MAX_ARRAY_MAP_SIZE?createNodes(ownerID,entries,key,value):(isEditable=ownerID&&ownerID===this.ownerID,newEntries=isEditable?entries:arrCopy(entries),exists?removed?idx===len-1?newEntries.pop():newEntries[idx]=newEntries.pop():newEntries[idx]=[key,value]:newEntries.push([key,value]),isEditable?(this.entries=newEntries,this):new ArrayMapNode(ownerID,newEntries)))},BitmapIndexedNode.prototype.get=function(shift,keyHash,key,notSetValue){var bit,bitmap;return void 0===keyHash&&(keyHash=hash(key)),bit=1<<((0===shift?keyHash:keyHash>>>shift)&MASK),bitmap=this.bitmap,0===(bitmap&bit)?notSetValue:this.nodes[popCount(bitmap&bit-1)].get(shift+SHIFT,keyHash,key,notSetValue)},BitmapIndexedNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){var keyHashFrag,bit,bitmap,exists,idx,nodes,node,newNode,isEditable,newBitmap,newNodes;return void 0===keyHash&&(keyHash=hash(key)),keyHashFrag=(0===shift?keyHash:keyHash>>>shift)&MASK,bit=1<<keyHashFrag,bitmap=this.bitmap,exists=0!==(bitmap&bit),exists||value!==NOT_SET?(idx=popCount(bitmap&bit-1),nodes=this.nodes,node=exists?nodes[idx]:void 0,newNode=updateNode(node,ownerID,shift+SHIFT,keyHash,key,value,didChangeSize,didAlter),newNode===node?this:!exists&&newNode&&nodes.length>=MAX_BITMAP_INDEXED_SIZE?expandNodes(ownerID,nodes,bitmap,keyHashFrag,newNode):exists&&!newNode&&2===nodes.length&&isLeafNode(nodes[1^idx])?nodes[1^idx]:exists&&newNode&&1===nodes.length&&isLeafNode(newNode)?newNode:(isEditable=ownerID&&ownerID===this.ownerID,newBitmap=exists?newNode?bitmap:bitmap^bit:bitmap|bit,newNodes=exists?newNode?setIn(nodes,idx,newNode,isEditable):spliceOut(nodes,idx,isEditable):spliceIn(nodes,idx,newNode,isEditable),isEditable?(this.bitmap=newBitmap,this.nodes=newNodes,this):new BitmapIndexedNode(ownerID,newBitmap,newNodes))):this},HashArrayMapNode.prototype.get=function(shift,keyHash,key,notSetValue){var idx,node;return void 0===keyHash&&(keyHash=hash(key)),idx=(0===shift?keyHash:keyHash>>>shift)&MASK,node=this.nodes[idx],node?node.get(shift+SHIFT,keyHash,key,notSetValue):notSetValue},HashArrayMapNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){var idx,removed,nodes,node,newNode,newCount,isEditable,newNodes;if(void 0===keyHash&&(keyHash=hash(key)),idx=(0===shift?keyHash:keyHash>>>shift)&MASK,removed=value===NOT_SET,nodes=this.nodes,node=nodes[idx],removed&&!node)return this;if(newNode=updateNode(node,ownerID,shift+SHIFT,keyHash,key,value,didChangeSize,didAlter),newNode===node)return this;if(newCount=this.count,node){if(!newNode&&(newCount--,newCount<MIN_HASH_ARRAY_MAP_SIZE))return packNodes(ownerID,nodes,newCount,idx)}else newCount++;return isEditable=ownerID&&ownerID===this.ownerID,newNodes=setIn(nodes,idx,newNode,isEditable),isEditable?(this.count=newCount,this.nodes=newNodes,this):new HashArrayMapNode(ownerID,newCount,newNodes)},HashCollisionNode.prototype.get=function(shift,keyHash,key,notSetValue){var ii,len,entries=this.entries;for(ii=0,len=entries.length;ii<len;ii++)if(is(key,entries[ii][0]))return entries[ii][1];return notSetValue},HashCollisionNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){var removed,entries,idx,len,exists,isEditable,newEntries;if(void 0===keyHash&&(keyHash=hash(key)),removed=value===NOT_SET,keyHash!==this.keyHash)return removed?this:(SetRef(didAlter),SetRef(didChangeSize),mergeIntoNode(this,ownerID,shift,keyHash,[key,value]));for(entries=this.entries,idx=0,len=entries.length;idx<len&&!is(key,entries[idx][0]);idx++);return exists=idx<len,(exists?entries[idx][1]===value:removed)?this:(SetRef(didAlter),(removed||!exists)&&SetRef(didChangeSize),removed&&2===len?new ValueNode(ownerID,this.keyHash,entries[1^idx]):(isEditable=ownerID&&ownerID===this.ownerID,newEntries=isEditable?entries:arrCopy(entries),exists?removed?idx===len-1?newEntries.pop():newEntries[idx]=newEntries.pop():newEntries[idx]=[key,value]:newEntries.push([key,value]),isEditable?(this.entries=newEntries,this):new HashCollisionNode(ownerID,this.keyHash,newEntries)))},ValueNode.prototype.get=function(shift,keyHash,key,notSetValue){return is(key,this.entry[0])?this.entry[1]:notSetValue},ValueNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){var removed=value===NOT_SET,keyMatch=is(key,this.entry[0]);return(keyMatch?value===this.entry[1]:removed)?this:(SetRef(didAlter),removed?void SetRef(didChangeSize):keyMatch?ownerID&&ownerID===this.ownerID?(this.entry[1]=value,this):new ValueNode(ownerID,this.keyHash,[key,value]):(SetRef(didChangeSize),mergeIntoNode(this,ownerID,shift,hash(key),[key,value])))},ArrayMapNode.prototype.iterate=HashCollisionNode.prototype.iterate=function(fn,reverse){var ii,maxIndex,entries=this.entries;for(ii=0,maxIndex=entries.length-1;ii<=maxIndex;ii++)if(fn(entries[reverse?maxIndex-ii:ii])===!1)return!1},BitmapIndexedNode.prototype.iterate=HashArrayMapNode.prototype.iterate=function(fn,reverse){var ii,maxIndex,node,nodes=this.nodes;for(ii=0,maxIndex=nodes.length-1;ii<=maxIndex;ii++)if(node=nodes[reverse?maxIndex-ii:ii],node&&node.iterate(fn,reverse)===!1)return!1},ValueNode.prototype.iterate=function(fn,reverse){return fn(this.entry)},createClass(MapIterator,Iterator),MapIterator.prototype.next=function(){for(var node,index,maxIndex,subNode,type=this._type,stack=this._stack;stack;){if(node=stack.node,index=stack.index++,node.entry){if(0===index)return mapIteratorValue(type,node.entry)}else if(node.entries){if(maxIndex=node.entries.length-1,index<=maxIndex)return mapIteratorValue(type,node.entries[this._reverse?maxIndex-index:index])}else if(maxIndex=node.nodes.length-1,index<=maxIndex){if(subNode=node.nodes[this._reverse?maxIndex-index:index]){if(subNode.entry)return mapIteratorValue(type,subNode.entry);stack=this._stack=mapIteratorFrame(subNode,stack)}continue}stack=this._stack=this._stack.__prev}return iteratorDone()},MAX_ARRAY_MAP_SIZE=SIZE/4,MAX_BITMAP_INDEXED_SIZE=SIZE/2,MIN_HASH_ARRAY_MAP_SIZE=SIZE/4,createClass(List,IndexedCollection),List.of=function(){return this(arguments)},List.prototype.toString=function(){return this.__toString("List [","]")},List.prototype.get=function(index,notSetValue){if(index=wrapIndex(this,index),index>=0&&index<this.size){index+=this._origin;var node=listNodeFor(this,index);return node&&node.array[index&MASK]}return notSetValue},List.prototype.set=function(index,value){return updateList(this,index,value)},List.prototype.remove=function(index){return this.has(index)?0===index?this.shift():index===this.size-1?this.pop():this.splice(index,1):this},List.prototype.insert=function(index,value){return this.splice(index,0,value)},List.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=SHIFT,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):emptyList()},List.prototype.push=function(){var values=arguments,oldSize=this.size;return this.withMutations(function(list){setListBounds(list,0,oldSize+values.length);for(var ii=0;ii<values.length;ii++)list.set(oldSize+ii,values[ii])})},List.prototype.pop=function(){return setListBounds(this,0,-1)},List.prototype.unshift=function(){var values=arguments;return this.withMutations(function(list){setListBounds(list,-values.length);for(var ii=0;ii<values.length;ii++)list.set(ii,values[ii])})},List.prototype.shift=function(){return setListBounds(this,1)},List.prototype.merge=function(){return mergeIntoListWith(this,void 0,arguments)},List.prototype.mergeWith=function(merger){var iters=SLICE$0.call(arguments,1);return mergeIntoListWith(this,merger,iters)},List.prototype.mergeDeep=function(){return mergeIntoListWith(this,deepMerger,arguments)},List.prototype.mergeDeepWith=function(merger){var iters=SLICE$0.call(arguments,1);return mergeIntoListWith(this,deepMergerWith(merger),iters)},List.prototype.setSize=function(size){return setListBounds(this,0,size)},List.prototype.slice=function(begin,end){var size=this.size;return wholeSlice(begin,end,size)?this:setListBounds(this,resolveBegin(begin,size),resolveEnd(end,size))},List.prototype.__iterator=function(type,reverse){var index=0,values=iterateList(this,reverse);return new Iterator(function(){var value=values();return value===DONE?iteratorDone():iteratorValue(type,index++,value)})},List.prototype.__iterate=function(fn,reverse){for(var value,index=0,values=iterateList(this,reverse);(value=values())!==DONE&&fn(value,index++,this)!==!1;);return index},List.prototype.__ensureOwner=function(ownerID){return ownerID===this.__ownerID?this:ownerID?makeList(this._origin,this._capacity,this._level,this._root,this._tail,ownerID,this.__hash):(this.__ownerID=ownerID,this)},List.isList=isList,IS_LIST_SENTINEL="@@__IMMUTABLE_LIST__@@",ListPrototype=List.prototype,ListPrototype[IS_LIST_SENTINEL]=!0,ListPrototype[DELETE]=ListPrototype.remove,ListPrototype.setIn=MapPrototype.setIn,ListPrototype.deleteIn=ListPrototype.removeIn=MapPrototype.removeIn,ListPrototype.update=MapPrototype.update,ListPrototype.updateIn=MapPrototype.updateIn,ListPrototype.mergeIn=MapPrototype.mergeIn,ListPrototype.mergeDeepIn=MapPrototype.mergeDeepIn,ListPrototype.withMutations=MapPrototype.withMutations,ListPrototype.asMutable=MapPrototype.asMutable,ListPrototype.asImmutable=MapPrototype.asImmutable,ListPrototype.wasAltered=MapPrototype.wasAltered,VNode.prototype.removeBefore=function(ownerID,level,index){var originIndex,removingFirst,newChild,oldChild,editable,ii;if(index===level?1<<level:0===this.array.length)return this;if(originIndex=index>>>level&MASK,originIndex>=this.array.length)return new VNode([],ownerID);if(removingFirst=0===originIndex,level>0&&(oldChild=this.array[originIndex],newChild=oldChild&&oldChild.removeBefore(ownerID,level-SHIFT,index),newChild===oldChild&&removingFirst))return this;if(removingFirst&&!newChild)return this;if(editable=editableVNode(this,ownerID),!removingFirst)for(ii=0;ii<originIndex;ii++)editable.array[ii]=void 0;return newChild&&(editable.array[originIndex]=newChild),editable},VNode.prototype.removeAfter=function(ownerID,level,index){var sizeIndex,newChild,oldChild,editable;return index===(level?1<<level:0)||0===this.array.length?this:(sizeIndex=index-1>>>level&MASK,sizeIndex>=this.array.length?this:level>0&&(oldChild=this.array[sizeIndex],newChild=oldChild&&oldChild.removeAfter(ownerID,level-SHIFT,index),newChild===oldChild&&sizeIndex===this.array.length-1)?this:(editable=editableVNode(this,ownerID),editable.array.splice(sizeIndex+1),newChild&&(editable.array[sizeIndex]=newChild),editable))},DONE={},createClass(OrderedMap,Map),OrderedMap.of=function(){return this(arguments)},OrderedMap.prototype.toString=function(){return this.__toString("OrderedMap {","}")},OrderedMap.prototype.get=function(k,notSetValue){var index=this._map.get(k);return void 0!==index?this._list.get(index)[1]:notSetValue},OrderedMap.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):emptyOrderedMap()},OrderedMap.prototype.set=function(k,v){return updateOrderedMap(this,k,v)},OrderedMap.prototype.remove=function(k){return updateOrderedMap(this,k,NOT_SET)},OrderedMap.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},OrderedMap.prototype.__iterate=function(fn,reverse){var this$0=this;return this._list.__iterate(function(entry){return entry&&fn(entry[1],entry[0],this$0)},reverse)},OrderedMap.prototype.__iterator=function(type,reverse){return this._list.fromEntrySeq().__iterator(type,reverse)},OrderedMap.prototype.__ensureOwner=function(ownerID){var newMap,newList;return ownerID===this.__ownerID?this:(newMap=this._map.__ensureOwner(ownerID),newList=this._list.__ensureOwner(ownerID),ownerID?makeOrderedMap(newMap,newList,ownerID,this.__hash):(this.__ownerID=ownerID,this._map=newMap,this._list=newList,this))},OrderedMap.isOrderedMap=isOrderedMap,OrderedMap.prototype[IS_ORDERED_SENTINEL]=!0,OrderedMap.prototype[DELETE]=OrderedMap.prototype.remove,createClass(ToKeyedSequence,KeyedSeq),ToKeyedSequence.prototype.get=function(key,notSetValue){return this._iter.get(key,notSetValue)},ToKeyedSequence.prototype.has=function(key){return this._iter.has(key)},ToKeyedSequence.prototype.valueSeq=function(){return this._iter.valueSeq()},ToKeyedSequence.prototype.reverse=function(){var this$0=this,reversedSequence=reverseFactory(this,!0);return this._useKeys||(reversedSequence.valueSeq=function(){return this$0._iter.toSeq().reverse()}),reversedSequence},ToKeyedSequence.prototype.map=function(mapper,context){var this$0=this,mappedSequence=mapFactory(this,mapper,context);return this._useKeys||(mappedSequence.valueSeq=function(){return this$0._iter.toSeq().map(mapper,context)}),mappedSequence},ToKeyedSequence.prototype.__iterate=function(fn,reverse){var ii,this$0=this;return this._iter.__iterate(this._useKeys?function(v,k){return fn(v,k,this$0)}:(ii=reverse?resolveSize(this):0,function(v){return fn(v,reverse?--ii:ii++,this$0)}),reverse)},ToKeyedSequence.prototype.__iterator=function(type,reverse){var iterator,ii;return this._useKeys?this._iter.__iterator(type,reverse):(iterator=this._iter.__iterator(ITERATE_VALUES,reverse),ii=reverse?resolveSize(this):0,new Iterator(function(){var step=iterator.next();return step.done?step:iteratorValue(type,reverse?--ii:ii++,step.value,step)}))},ToKeyedSequence.prototype[IS_ORDERED_SENTINEL]=!0,createClass(ToIndexedSequence,IndexedSeq),ToIndexedSequence.prototype.includes=function(value){return this._iter.includes(value)},ToIndexedSequence.prototype.__iterate=function(fn,reverse){var this$0=this,iterations=0;return this._iter.__iterate(function(v){return fn(v,iterations++,this$0)},reverse)},ToIndexedSequence.prototype.__iterator=function(type,reverse){var iterator=this._iter.__iterator(ITERATE_VALUES,reverse),iterations=0;return new Iterator(function(){var step=iterator.next();return step.done?step:iteratorValue(type,iterations++,step.value,step)})},createClass(ToSetSequence,SetSeq),ToSetSequence.prototype.has=function(key){return this._iter.includes(key)},ToSetSequence.prototype.__iterate=function(fn,reverse){var this$0=this;return this._iter.__iterate(function(v){return fn(v,v,this$0)},reverse)},ToSetSequence.prototype.__iterator=function(type,reverse){var iterator=this._iter.__iterator(ITERATE_VALUES,reverse);return new Iterator(function(){var step=iterator.next();return step.done?step:iteratorValue(type,step.value,step.value,step)})},createClass(FromEntriesSequence,KeyedSeq),FromEntriesSequence.prototype.entrySeq=function(){return this._iter.toSeq()},FromEntriesSequence.prototype.__iterate=function(fn,reverse){var this$0=this;return this._iter.__iterate(function(entry){if(entry){validateEntry(entry);var indexedIterable=isIterable(entry);return fn(indexedIterable?entry.get(1):entry[1],indexedIterable?entry.get(0):entry[0],this$0)}},reverse)},FromEntriesSequence.prototype.__iterator=function(type,reverse){var iterator=this._iter.__iterator(ITERATE_VALUES,reverse);return new Iterator(function(){for(var step,entry,indexedIterable;;){if(step=iterator.next(),step.done)return step;if(entry=step.value)return validateEntry(entry),indexedIterable=isIterable(entry),iteratorValue(type,indexedIterable?entry.get(0):entry[0],indexedIterable?entry.get(1):entry[1],step)}})},ToIndexedSequence.prototype.cacheResult=ToKeyedSequence.prototype.cacheResult=ToSetSequence.prototype.cacheResult=FromEntriesSequence.prototype.cacheResult=cacheResultThrough,createClass(Record,KeyedCollection),Record.prototype.toString=function(){return this.__toString(recordName(this)+" {","}")},Record.prototype.has=function(k){return this._defaultValues.hasOwnProperty(k)},Record.prototype.get=function(k,notSetValue){if(!this.has(k))return notSetValue;var defaultVal=this._defaultValues[k];return this._map?this._map.get(k,defaultVal):defaultVal},Record.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var RecordType=this.constructor;return RecordType._empty||(RecordType._empty=makeRecord(this,emptyMap()))},Record.prototype.set=function(k,v){var defaultVal,newMap;if(!this.has(k))throw new Error('Cannot set unknown key "'+k+'" on '+recordName(this));return this._map&&!this._map.has(k)&&(defaultVal=this._defaultValues[k],v===defaultVal)?this:(newMap=this._map&&this._map.set(k,v),this.__ownerID||newMap===this._map?this:makeRecord(this,newMap))},Record.prototype.remove=function(k){if(!this.has(k))return this;var newMap=this._map&&this._map.remove(k);return this.__ownerID||newMap===this._map?this:makeRecord(this,newMap)},Record.prototype.wasAltered=function(){return this._map.wasAltered()},Record.prototype.__iterator=function(type,reverse){var this$0=this;return KeyedIterable(this._defaultValues).map(function(_,k){return this$0.get(k)}).__iterator(type,reverse)},Record.prototype.__iterate=function(fn,reverse){var this$0=this;return KeyedIterable(this._defaultValues).map(function(_,k){return this$0.get(k)}).__iterate(fn,reverse)},Record.prototype.__ensureOwner=function(ownerID){if(ownerID===this.__ownerID)return this;var newMap=this._map&&this._map.__ensureOwner(ownerID);return ownerID?makeRecord(this,newMap,ownerID):(this.__ownerID=ownerID,this._map=newMap,this)},RecordPrototype=Record.prototype,RecordPrototype[DELETE]=RecordPrototype.remove,RecordPrototype.deleteIn=RecordPrototype.removeIn=MapPrototype.removeIn,RecordPrototype.merge=MapPrototype.merge,RecordPrototype.mergeWith=MapPrototype.mergeWith,RecordPrototype.mergeIn=MapPrototype.mergeIn,RecordPrototype.mergeDeep=MapPrototype.mergeDeep,RecordPrototype.mergeDeepWith=MapPrototype.mergeDeepWith,RecordPrototype.mergeDeepIn=MapPrototype.mergeDeepIn,RecordPrototype.setIn=MapPrototype.setIn,RecordPrototype.update=MapPrototype.update,RecordPrototype.updateIn=MapPrototype.updateIn,RecordPrototype.withMutations=MapPrototype.withMutations,RecordPrototype.asMutable=MapPrototype.asMutable,RecordPrototype.asImmutable=MapPrototype.asImmutable,createClass(Set,SetCollection),Set.of=function(){return this(arguments)},Set.fromKeys=function(value){return this(KeyedIterable(value).keySeq())},Set.prototype.toString=function(){return this.__toString("Set {","}")},Set.prototype.has=function(value){return this._map.has(value)},Set.prototype.add=function(value){return updateSet(this,this._map.set(value,!0))},Set.prototype.remove=function(value){return updateSet(this,this._map.remove(value))},Set.prototype.clear=function(){return updateSet(this,this._map.clear())},Set.prototype.union=function(){var iters=SLICE$0.call(arguments,0);return iters=iters.filter(function(x){return 0!==x.size}),0===iters.length?this:0!==this.size||this.__ownerID||1!==iters.length?this.withMutations(function(set){for(var ii=0;ii<iters.length;ii++)SetIterable(iters[ii]).forEach(function(value){return set.add(value)})}):this.constructor(iters[0])},Set.prototype.intersect=function(){var originalSet,iters=SLICE$0.call(arguments,0);return 0===iters.length?this:(iters=iters.map(function(iter){return SetIterable(iter)}),originalSet=this,this.withMutations(function(set){originalSet.forEach(function(value){iters.every(function(iter){return iter.includes(value)})||set.remove(value)})}))},Set.prototype.subtract=function(){var originalSet,iters=SLICE$0.call(arguments,0);return 0===iters.length?this:(iters=iters.map(function(iter){return SetIterable(iter)}),originalSet=this,this.withMutations(function(set){originalSet.forEach(function(value){iters.some(function(iter){return iter.includes(value)})&&set.remove(value)})}))},Set.prototype.merge=function(){return this.union.apply(this,arguments)},Set.prototype.mergeWith=function(merger){var iters=SLICE$0.call(arguments,1);return this.union.apply(this,iters)},Set.prototype.sort=function(comparator){return OrderedSet(sortFactory(this,comparator))},Set.prototype.sortBy=function(mapper,comparator){return OrderedSet(sortFactory(this,comparator,mapper))},Set.prototype.wasAltered=function(){return this._map.wasAltered()},Set.prototype.__iterate=function(fn,reverse){var this$0=this;return this._map.__iterate(function(_,k){return fn(k,k,this$0)},reverse)},Set.prototype.__iterator=function(type,reverse){return this._map.map(function(_,k){return k}).__iterator(type,reverse)},Set.prototype.__ensureOwner=function(ownerID){if(ownerID===this.__ownerID)return this;var newMap=this._map.__ensureOwner(ownerID);return ownerID?this.__make(newMap,ownerID):(this.__ownerID=ownerID,this._map=newMap,this)},Set.isSet=isSet,IS_SET_SENTINEL="@@__IMMUTABLE_SET__@@",SetPrototype=Set.prototype,SetPrototype[IS_SET_SENTINEL]=!0,SetPrototype[DELETE]=SetPrototype.remove,SetPrototype.mergeDeep=SetPrototype.merge,SetPrototype.mergeDeepWith=SetPrototype.mergeWith,SetPrototype.withMutations=MapPrototype.withMutations,SetPrototype.asMutable=MapPrototype.asMutable,SetPrototype.asImmutable=MapPrototype.asImmutable,SetPrototype.__empty=emptySet,SetPrototype.__make=makeSet,createClass(OrderedSet,Set),OrderedSet.of=function(){return this(arguments)},OrderedSet.fromKeys=function(value){return this(KeyedIterable(value).keySeq())},OrderedSet.prototype.toString=function(){return this.__toString("OrderedSet {","}")},OrderedSet.isOrderedSet=isOrderedSet,OrderedSetPrototype=OrderedSet.prototype,OrderedSetPrototype[IS_ORDERED_SENTINEL]=!0,OrderedSetPrototype.__empty=emptyOrderedSet,OrderedSetPrototype.__make=makeOrderedSet,createClass(Stack,IndexedCollection),Stack.of=function(){return this(arguments)},Stack.prototype.toString=function(){return this.__toString("Stack [","]")},Stack.prototype.get=function(index,notSetValue){var head=this._head;for(index=wrapIndex(this,index);head&&index--;)head=head.next;return head?head.value:notSetValue},Stack.prototype.peek=function(){return this._head&&this._head.value},Stack.prototype.push=function(){var newSize,head,ii;if(0===arguments.length)return this;for(newSize=this.size+arguments.length,head=this._head,ii=arguments.length-1;ii>=0;ii--)head={value:arguments[ii],next:head};return this.__ownerID?(this.size=newSize,this._head=head,this.__hash=void 0,this.__altered=!0,this):makeStack(newSize,head)},Stack.prototype.pushAll=function(iter){var newSize,head;return iter=IndexedIterable(iter),0===iter.size?this:(assertNotInfinite(iter.size),newSize=this.size,head=this._head,iter.reverse().forEach(function(value){newSize++,head={value:value,next:head}}),this.__ownerID?(this.size=newSize,this._head=head,this.__hash=void 0,this.__altered=!0,this):makeStack(newSize,head))},Stack.prototype.pop=function(){return this.slice(1)},Stack.prototype.unshift=function(){return this.push.apply(this,arguments)},Stack.prototype.unshiftAll=function(iter){return this.pushAll(iter)},Stack.prototype.shift=function(){return this.pop.apply(this,arguments)},Stack.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):emptyStack()},Stack.prototype.slice=function(begin,end){var resolvedBegin,resolvedEnd,newSize,head;if(wholeSlice(begin,end,this.size))return this;if(resolvedBegin=resolveBegin(begin,this.size),resolvedEnd=resolveEnd(end,this.size),resolvedEnd!==this.size)return IndexedCollection.prototype.slice.call(this,begin,end);
for(newSize=this.size-resolvedBegin,head=this._head;resolvedBegin--;)head=head.next;return this.__ownerID?(this.size=newSize,this._head=head,this.__hash=void 0,this.__altered=!0,this):makeStack(newSize,head)},Stack.prototype.__ensureOwner=function(ownerID){return ownerID===this.__ownerID?this:ownerID?makeStack(this.size,this._head,ownerID,this.__hash):(this.__ownerID=ownerID,this.__altered=!1,this)},Stack.prototype.__iterate=function(fn,reverse){var iterations,node;if(reverse)return this.reverse().__iterate(fn);for(iterations=0,node=this._head;node&&fn(node.value,iterations++,this)!==!1;)node=node.next;return iterations},Stack.prototype.__iterator=function(type,reverse){var iterations,node;return reverse?this.reverse().__iterator(type):(iterations=0,node=this._head,new Iterator(function(){if(node){var value=node.value;return node=node.next,iteratorValue(type,iterations++,value)}return iteratorDone()}))},Stack.isStack=isStack,IS_STACK_SENTINEL="@@__IMMUTABLE_STACK__@@",StackPrototype=Stack.prototype,StackPrototype[IS_STACK_SENTINEL]=!0,StackPrototype.withMutations=MapPrototype.withMutations,StackPrototype.asMutable=MapPrototype.asMutable,StackPrototype.asImmutable=MapPrototype.asImmutable,StackPrototype.wasAltered=MapPrototype.wasAltered,Iterable.Iterator=Iterator,mixin(Iterable,{toArray:function toArray(){assertNotInfinite(this.size);var array=new Array(this.size||0);return this.valueSeq().__iterate(function(v,i){array[i]=v}),array},toIndexedSeq:function toIndexedSeq(){return new ToIndexedSequence(this)},toJS:function toJS(){return this.toSeq().map(function(value){return value&&"function"==typeof value.toJS?value.toJS():value}).__toJS()},toJSON:function toJSON(){return this.toSeq().map(function(value){return value&&"function"==typeof value.toJSON?value.toJSON():value}).__toJS()},toKeyedSeq:function toKeyedSeq(){return new ToKeyedSequence(this,(!0))},toMap:function toMap(){return Map(this.toKeyedSeq())},toObject:function toObject(){assertNotInfinite(this.size);var object={};return this.__iterate(function(v,k){object[k]=v}),object},toOrderedMap:function toOrderedMap(){return OrderedMap(this.toKeyedSeq())},toOrderedSet:function toOrderedSet(){return OrderedSet(isKeyed(this)?this.valueSeq():this)},toSet:function toSet(){return Set(isKeyed(this)?this.valueSeq():this)},toSetSeq:function toSetSeq(){return new ToSetSequence(this)},toSeq:function toSeq(){return isIndexed(this)?this.toIndexedSeq():isKeyed(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function toStack(){return Stack(isKeyed(this)?this.valueSeq():this)},toList:function toList(){return List(isKeyed(this)?this.valueSeq():this)},toString:function toString(){return"[Iterable]"},__toString:function __toString(head,tail){return 0===this.size?head+tail:head+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+tail},concat:function concat(){var values=SLICE$0.call(arguments,0);return reify(this,concatFactory(this,values))},includes:function includes(searchValue){return this.some(function(value){return is(value,searchValue)})},entries:function entries(){return this.__iterator(ITERATE_ENTRIES)},every:function every(predicate,context){assertNotInfinite(this.size);var returnValue=!0;return this.__iterate(function(v,k,c){if(!predicate.call(context,v,k,c))return returnValue=!1,!1}),returnValue},filter:function filter(predicate,context){return reify(this,filterFactory(this,predicate,context,!0))},find:function find(predicate,context,notSetValue){var entry=this.findEntry(predicate,context);return entry?entry[1]:notSetValue},forEach:function forEach(sideEffect,context){return assertNotInfinite(this.size),this.__iterate(context?sideEffect.bind(context):sideEffect)},join:function join(separator){var joined,isFirst;return assertNotInfinite(this.size),separator=void 0!==separator?""+separator:",",joined="",isFirst=!0,this.__iterate(function(v){isFirst?isFirst=!1:joined+=separator,joined+=null!==v&&void 0!==v?v.toString():""}),joined},keys:function keys(){return this.__iterator(ITERATE_KEYS)},map:function map(mapper,context){return reify(this,mapFactory(this,mapper,context))},reduce:function reduce(reducer,initialReduction,context){var reduction,useFirst;return assertNotInfinite(this.size),arguments.length<2?useFirst=!0:reduction=initialReduction,this.__iterate(function(v,k,c){useFirst?(useFirst=!1,reduction=v):reduction=reducer.call(context,reduction,v,k,c)}),reduction},reduceRight:function reduceRight(reducer,initialReduction,context){var reversed=this.toKeyedSeq().reverse();return reversed.reduce.apply(reversed,arguments)},reverse:function reverse(){return reify(this,reverseFactory(this,!0))},slice:function slice(begin,end){return reify(this,sliceFactory(this,begin,end,!0))},some:function some(predicate,context){return!this.every(not(predicate),context)},sort:function sort(comparator){return reify(this,sortFactory(this,comparator))},values:function values(){return this.__iterator(ITERATE_VALUES)},butLast:function butLast(){return this.slice(0,-1)},isEmpty:function isEmpty(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function count(predicate,context){return ensureSize(predicate?this.toSeq().filter(predicate,context):this)},countBy:function countBy(grouper,context){return countByFactory(this,grouper,context)},equals:function equals(other){return deepEqual(this,other)},entrySeq:function entrySeq(){var entriesSequence,iterable=this;return iterable._cache?new ArraySeq(iterable._cache):(entriesSequence=iterable.toSeq().map(entryMapper).toIndexedSeq(),entriesSequence.fromEntrySeq=function(){return iterable.toSeq()},entriesSequence)},filterNot:function filterNot(predicate,context){return this.filter(not(predicate),context)},findEntry:function findEntry(predicate,context,notSetValue){var found=notSetValue;return this.__iterate(function(v,k,c){if(predicate.call(context,v,k,c))return found=[k,v],!1}),found},findKey:function findKey(predicate,context){var entry=this.findEntry(predicate,context);return entry&&entry[0]},findLast:function findLast(predicate,context,notSetValue){return this.toKeyedSeq().reverse().find(predicate,context,notSetValue)},findLastEntry:function findLastEntry(predicate,context,notSetValue){return this.toKeyedSeq().reverse().findEntry(predicate,context,notSetValue)},findLastKey:function findLastKey(predicate,context){return this.toKeyedSeq().reverse().findKey(predicate,context)},first:function first(){return this.find(returnTrue)},flatMap:function flatMap(mapper,context){return reify(this,flatMapFactory(this,mapper,context))},flatten:function flatten(depth){return reify(this,flattenFactory(this,depth,!0))},fromEntrySeq:function fromEntrySeq(){return new FromEntriesSequence(this)},get:function get(searchKey,notSetValue){return this.find(function(_,key){return is(key,searchKey)},void 0,notSetValue)},getIn:function getIn(searchKeyPath,notSetValue){for(var step,key,nested=this,iter=forceIterator(searchKeyPath);!(step=iter.next()).done;)if(key=step.value,nested=nested&&nested.get?nested.get(key,NOT_SET):NOT_SET,nested===NOT_SET)return notSetValue;return nested},groupBy:function groupBy(grouper,context){return groupByFactory(this,grouper,context)},has:function has(searchKey){return this.get(searchKey,NOT_SET)!==NOT_SET},hasIn:function hasIn(searchKeyPath){return this.getIn(searchKeyPath,NOT_SET)!==NOT_SET},isSubset:function isSubset(iter){return iter="function"==typeof iter.includes?iter:Iterable(iter),this.every(function(value){return iter.includes(value)})},isSuperset:function isSuperset(iter){return iter="function"==typeof iter.isSubset?iter:Iterable(iter),iter.isSubset(this)},keyOf:function keyOf(searchValue){return this.findKey(function(value){return is(value,searchValue)})},keySeq:function keySeq(){return this.toSeq().map(keyMapper).toIndexedSeq()},last:function last(){return this.toSeq().reverse().first()},lastKeyOf:function lastKeyOf(searchValue){return this.toKeyedSeq().reverse().keyOf(searchValue)},max:function max(comparator){return maxFactory(this,comparator)},maxBy:function maxBy(mapper,comparator){return maxFactory(this,comparator,mapper)},min:function min(comparator){return maxFactory(this,comparator?neg(comparator):defaultNegComparator)},minBy:function minBy(mapper,comparator){return maxFactory(this,comparator?neg(comparator):defaultNegComparator,mapper)},rest:function rest(){return this.slice(1)},skip:function skip(amount){return this.slice(Math.max(0,amount))},skipLast:function skipLast(amount){return reify(this,this.toSeq().reverse().skip(amount).reverse())},skipWhile:function skipWhile(predicate,context){return reify(this,skipWhileFactory(this,predicate,context,!0))},skipUntil:function skipUntil(predicate,context){return this.skipWhile(not(predicate),context)},sortBy:function sortBy(mapper,comparator){return reify(this,sortFactory(this,comparator,mapper))},take:function take(amount){return this.slice(0,Math.max(0,amount))},takeLast:function takeLast(amount){return reify(this,this.toSeq().reverse().take(amount).reverse())},takeWhile:function takeWhile(predicate,context){return reify(this,takeWhileFactory(this,predicate,context))},takeUntil:function takeUntil(predicate,context){return this.takeWhile(not(predicate),context)},valueSeq:function valueSeq(){return this.toIndexedSeq()},hashCode:function hashCode(){return this.__hash||(this.__hash=hashIterable(this))}}),IterablePrototype=Iterable.prototype,IterablePrototype[IS_ITERABLE_SENTINEL]=!0,IterablePrototype[ITERATOR_SYMBOL]=IterablePrototype.values,IterablePrototype.__toJS=IterablePrototype.toArray,IterablePrototype.__toStringMapper=quoteString,IterablePrototype.inspect=IterablePrototype.toSource=function(){return this.toString()},IterablePrototype.chain=IterablePrototype.flatMap,IterablePrototype.contains=IterablePrototype.includes,mixin(KeyedIterable,{flip:function flip(){return reify(this,flipFactory(this))},mapEntries:function mapEntries(mapper,context){var this$0=this,iterations=0;return reify(this,this.toSeq().map(function(v,k){return mapper.call(context,[k,v],iterations++,this$0)}).fromEntrySeq())},mapKeys:function mapKeys(mapper,context){var this$0=this;return reify(this,this.toSeq().flip().map(function(k,v){return mapper.call(context,k,v,this$0)}).flip())}}),KeyedIterablePrototype=KeyedIterable.prototype,KeyedIterablePrototype[IS_KEYED_SENTINEL]=!0,KeyedIterablePrototype[ITERATOR_SYMBOL]=IterablePrototype.entries,KeyedIterablePrototype.__toJS=IterablePrototype.toObject,KeyedIterablePrototype.__toStringMapper=function(v,k){return JSON.stringify(k)+": "+quoteString(v)},mixin(IndexedIterable,{toKeyedSeq:function toKeyedSeq(){return new ToKeyedSequence(this,(!1))},filter:function filter(predicate,context){return reify(this,filterFactory(this,predicate,context,!1))},findIndex:function findIndex(predicate,context){var entry=this.findEntry(predicate,context);return entry?entry[0]:-1},indexOf:function indexOf(searchValue){var key=this.keyOf(searchValue);return void 0===key?-1:key},lastIndexOf:function lastIndexOf(searchValue){var key=this.lastKeyOf(searchValue);return void 0===key?-1:key},reverse:function reverse(){return reify(this,reverseFactory(this,!1))},slice:function slice(begin,end){return reify(this,sliceFactory(this,begin,end,!1))},splice:function splice(index,removeNum){var spliced,numArgs=arguments.length;return removeNum=Math.max(0|removeNum,0),0===numArgs||2===numArgs&&!removeNum?this:(index=resolveBegin(index,index<0?this.count():this.size),spliced=this.slice(0,index),reify(this,1===numArgs?spliced:spliced.concat(arrCopy(arguments,2),this.slice(index+removeNum))))},findLastIndex:function findLastIndex(predicate,context){var entry=this.findLastEntry(predicate,context);return entry?entry[0]:-1},first:function first(){return this.get(0)},flatten:function flatten(depth){return reify(this,flattenFactory(this,depth,!1))},get:function get(index,notSetValue){return index=wrapIndex(this,index),index<0||this.size===1/0||void 0!==this.size&&index>this.size?notSetValue:this.find(function(_,key){return key===index},void 0,notSetValue)},has:function has(index){return index=wrapIndex(this,index),index>=0&&(void 0!==this.size?this.size===1/0||index<this.size:this.indexOf(index)!==-1)},interpose:function interpose(separator){return reify(this,interposeFactory(this,separator))},interleave:function interleave(){var iterables=[this].concat(arrCopy(arguments)),zipped=zipWithFactory(this.toSeq(),IndexedSeq.of,iterables),interleaved=zipped.flatten(!0);return zipped.size&&(interleaved.size=zipped.size*iterables.length),reify(this,interleaved)},keySeq:function keySeq(){return Range(0,this.size)},last:function last(){return this.get(-1)},skipWhile:function skipWhile(predicate,context){return reify(this,skipWhileFactory(this,predicate,context,!1))},zip:function zip(){var iterables=[this].concat(arrCopy(arguments));return reify(this,zipWithFactory(this,defaultZipper,iterables))},zipWith:function zipWith(zipper){var iterables=arrCopy(arguments);return iterables[0]=this,reify(this,zipWithFactory(this,zipper,iterables))}}),IndexedIterable.prototype[IS_INDEXED_SENTINEL]=!0,IndexedIterable.prototype[IS_ORDERED_SENTINEL]=!0,mixin(SetIterable,{get:function get(value,notSetValue){return this.has(value)?value:notSetValue},includes:function includes(value){return this.has(value)},keySeq:function keySeq(){return this.valueSeq()}}),SetIterable.prototype.has=IterablePrototype.includes,SetIterable.prototype.contains=SetIterable.prototype.includes,mixin(KeyedSeq,KeyedIterable.prototype),mixin(IndexedSeq,IndexedIterable.prototype),mixin(SetSeq,SetIterable.prototype),mixin(KeyedCollection,KeyedIterable.prototype),mixin(IndexedCollection,IndexedIterable.prototype),mixin(SetCollection,SetIterable.prototype),Immutable={Iterable:Iterable,Seq:Seq,Collection:Collection,Map:Map,OrderedMap:OrderedMap,List:List,Stack:Stack,Set:Set,OrderedSet:OrderedSet,Record:Record,Range:Range,Repeat:Repeat,is:is,fromJS:fromJS}})},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _objectWithoutProperties(obj,keys){var i,target={};for(i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function addTlog(mapToProps){return function(Comp){return function(_Component){function _class(){return _classCallCheck(this,_class),_possibleConstructorReturn(this,(_class.__proto__||Object.getPrototypeOf(_class)).apply(this,arguments))}return _inherits(_class,_Component),_createClass(_class,[{key:"render",value:function render(){var _props=this.props,onClick=_props.onClick,pushStr=_props.pushStr,rest=_objectWithoutProperties(_props,["onClick","pushStr"]);return _react2["default"].createElement(Comp,_extends({},rest,mapToProps(onClick,pushStr)))}}]),_class}(_react.Component)}}function A(props){var children=props.children,rest=_objectWithoutProperties(props,["children"]);return _react2["default"].createElement("a",rest,children)}function Input(props){var children=props.children,rest=_objectWithoutProperties(props,["children"]);return _react2["default"].createElement("input",rest,children)}var _extends,_createClass,_react,_react2,Atlog,InputTlog;Object.defineProperty(exports,"__esModule",{value:!0}),exports.InputTlog=exports.Atlog=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),Atlog=exports.Atlog=addTlog(function(_onClick,pushStr){return{onClick:function onClick(){pushStr&&(window.tlog=window.tlog||[],tlog.push(pushStr)),_onClick&&_onClick()}}})(A),InputTlog=exports.InputTlog=addTlog(function(_onClick2,pushStr){return{onClick:function onClick(){pushStr&&(window.tlog=window.tlog||[],tlog.push(pushStr)),_onClick2&&_onClick2()}}})(Input)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function CIdentity(props){var item=props.item,config=props.config,identity="",icons="";switch(item.oppositeUserKind){case _constants.UserType.USER_TYPE_B.toString():icons="icons24-hr";break;case _constants.UserType.USER_TYPE_H.toString():icons="icons24-lietou";break;case _constants.UserType.USER_TYPE_C.toString():"0"===item.oppositeImUserType||"1"===item.oppositeImUserType&&(icons="icons24-recruit")}return _react2["default"].createElement("span",{className:"user-name link-img"},(0,_utils.getBrief)(item.oppositeUserName,4)," ",_react2["default"].createElement("em",{className:"webim-icons24 "+icons}))}function ContactInfo(props){var env=props.imcore.env.toLowerCase(),config=(0,_config2["default"])(env),userInfo=props.imcore.userInfo,v=props.contacts,isSettingShield=!(v.unReadCnt>0),msg=new _lastmsg.LastMessage;switch(msg.set(v.lastPayload),env){case"c":return _react2["default"].createElement("div",{className:"contact-info clearfix",onClick:function onClick(){return props.actions.selectContact(props.imcore,v)}},_react2["default"].createElement("div",{className:"photo"},_react2["default"].createElement("img",{className:"tinyFace circle",src:"//image0.lietou-static.com/normal/"+v.oppositeUserPhoto}),_react2["default"].createElement("i",{className:(0,_classnames2["default"])({dot:!0,hide:isSettingShield})},v.unReadCnt>99?"99+":v.unReadCnt)),_react2["default"].createElement("div",{className:"info"},_react2["default"].createElement("p",null,_react2["default"].createElement(CIdentity,{config:config.tlogs,item:v}),_react2["default"].createElement("time",null,v.latestMsgTime?(0,_utils.dateFormat)(new Date(v.latestMsgTime)):"")),_react2["default"].createElement("p",{className:"last"},_react2["default"].createElement(_LastMsg2["default"],{env:env,message:v.lastPayload,name:(0,_utils.getBrief)(userInfo.oppositeUserName,3)}))));case"b":return _react2["default"].createElement("div",{className:"contact-info clearfix",onClick:function onClick(){return props.actions.selectContact(props.imcore,v)}},_react2["default"].createElement("div",{className:"photo"},_react2["default"].createElement("img",{className:"tinyFace circle",src:"https://image0.lietou-static.com/normal/"+v.oppositeUserPhoto}),_react2["default"].createElement("i",{className:(0,_classnames2["default"])({dot:!0,hide:isSettingShield})},v.unReadCnt>99?"99+":v.unReadCnt),v.contact&&props.isHistory?_react2["default"].createElement("em",{className:"connected"},"曾沟通"):""),_react2["default"].createElement("div",{className:"info"},_react2["default"].createElement("p",null,3==v.oppositeImUserType?_react2["default"].createElement("span",null,_react2["default"].createElement("span",{className:"name"},(0,_utils.getBrief)(v.oppositeUserName,6)),_react2["default"].createElement("span",{className:"labels labels-blue"},"同事")):_react2["default"].createElement("span",null,_react2["default"].createElement("span",{className:"name"},(0,_utils.getBrief)(v.oppositeUserName,2)),_react2["default"].createElement("em",{className:"job-title"},(0,_utils.getBrief)(v.oppositeUserTitle,3))),_react2["default"].createElement("time",null,v.latestMsgTime?(0,_utils.dateFormat)(new Date(v.latestMsgTime)):"")),_react2["default"].createElement("p",{className:"last"},_react2["default"].createElement(_LastMsg2["default"],{env:env,message:v.lastPayload,name:(0,_utils.getBrief)(v.oppositeUserName,3)}))));case"h":return _react2["default"].createElement("div",{className:"contact-info clearfix",onClick:function onClick(){return props.actions.selectContact(props.imcore,v)}},_react2["default"].createElement("div",{className:"photo"},_react2["default"].createElement("img",{className:"tinyFace circle",src:"https://image0.lietou-static.com/normal/"+v.oppositeUserPhoto}),_react2["default"].createElement("i",{className:(0,_classnames2["default"])({dot:!0,hide:isSettingShield})},v.unReadCnt>99?"99+":v.unReadCnt),v.contact&&props.isHistory?_react2["default"].createElement("em",{className:"connected"},"曾沟通"):""),_react2["default"].createElement("div",{className:"info"},_react2["default"].createElement("p",null,_react2["default"].createElement("span",{className:"name"},(0,_utils.getBrief)(v.oppositeUserName,3)),_react2["default"].createElement("em",{className:"job-title"},(0,_utils.getBrief)(v.oppositeUserTitle,3)),_react2["default"].createElement("time",null,v.latestMsgTime?(0,_utils.dateFormat)(new Date(v.latestMsgTime)):"")),_react2["default"].createElement("p",{className:"last"},_react2["default"].createElement(_LastMsg2["default"],{env:env,message:v.lastPayload,name:(0,_utils.getBrief)(v.oppositeUserName,3)}))))}}var _enums,_constants,_react,_react2,_classnames,_classnames2,_config,_config2,_utils,_LastMsg,_LastMsg2,_lastmsg,_addTlog;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CIdentity=CIdentity,exports["default"]=ContactInfo,_enums=__webpack_require__(162),_constants=__webpack_require__(156),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils=__webpack_require__(180),_LastMsg=__webpack_require__(184),_LastMsg2=_interopRequireDefault(_LastMsg),_lastmsg=__webpack_require__(185),_addTlog=__webpack_require__(182),__webpack_require__(186)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function LastMsg(props){var getMsg,env=props.env,message=props.message,len=props.len,name=props.name,msg=new _lastmsg.LastMessage;return msg.set(message),(0,_lastmsg.messageLastMsgFilter)(msg)?(getMsg="",getMsg="c"==env?getLastMsgC(msg,len,name):"b"==env?getLastMsgB(msg,len,name):getLastMsgH(msg,len,name),_react2["default"].createElement("span",null,getMsg)):"c"==env?_react2["default"].createElement("span",null,(0,_utils.getBrief)(_enums.CompatibleExtType.CANNOT_SHOW_CIMG,20)):"b"==env?_react2["default"].createElement("span",null,(0,_utils.getBrief)(_enums.CompatibleExtType.CANNOT_SHOW_BIMG,20)):_react2["default"].createElement("span",null,(0,_utils.getBrief)(_enums.CompatibleExtType.CANNOT_SHOW_HIMG,20))}var _react,_react2,_enums,_utils,_constants,_lastmsg,getLastMsgC,getLastMsgB,getLastMsgH;Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=LastMsg,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_enums=__webpack_require__(162),_utils=__webpack_require__(180),_constants=__webpack_require__(156),_lastmsg=__webpack_require__(185),getLastMsgC=function getLastMsgC(msg){var len=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,name=arguments[2],lastMsg="",msgType=msg.type,msgText=msg.msg,extType=msg.extType,senderKind=msg.senderKind,receiverKind=msg.receiverKind;switch(extType-0){case _enums.ExtType.MESSAGE_TEXT:lastMsg="img"===msgType?"[图片]":(0,_utils.getBrief)(msgText,len);break;case _enums.ExtType.MESSAGE_RESUME:lastMsg="[委托的简历] "+name+"的简历";break;case _enums.ExtType.MESSAGE_SEND_JOB:lastMsg=senderKind==_constants.UserType.USER_TYPE_C?"[我感兴趣的职位]":senderKind==_constants.UserType.USER_TYPE_B?"[邀您应聘的职位]":senderKind==_constants.UserType.USER_TYPE_H?"[为你推荐的职位]":"[职位]";break;case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:senderKind==_constants.UserType.USER_TYPE_C?lastMsg="[应聘简历]":senderKind==_constants.UserType.USER_TYPE_H&&(lastMsg="[应聘的简历] "+name+"的简历");break;case _enums.ExtType.MESSAGE_SEND_NAMECARD:lastMsg="[发送名片]";break;case _enums.ExtType.MESSAGE_ASK_RESUME:lastMsg="[索要简历]我想要一份你的简历，你是否同意？";break;case _enums.ExtType.MESSAGE_SEND_RATINGBAR:lastMsg="[请为猎头服务做出评价]";break;case _enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK:lastMsg="[已拒绝推荐职位]";break;case _enums.ExtType.MESSAGE_SEND_APPLYSUCFEEDBACK:lastMsg="[已接受推荐职位]";break;default:lastMsg=(0,_utils.getBrief)(msgText,len)}return lastMsg},getLastMsgB=function getLastMsgB(msg){var len=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,name=arguments[2],lastMsg="",msgType=msg.type,msgText=msg.msg,extType=msg.extType,senderKind=msg.senderKind,receiverKind=msg.receiverKind;switch(extType-0){case _enums.ExtType.MESSAGE_TEXT:lastMsg="img"===msgType?"[图片]":(0,_utils.getBrief)(msgText,len);break;case _enums.ExtType.MESSAGE_SEND_JOB:lastMsg="[职位]";break;case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:lastMsg="[应聘简历]";break;case _enums.ExtType.MESSAGE_SEND_NAMECARD:lastMsg="[应聘者的名片]";break;case _enums.ExtType.MESSAGE_ASK_RESUME:lastMsg="索要简历的请求已发送";break;default:lastMsg=(0,_utils.getBrief)(msgText,len)}return lastMsg},getLastMsgH=function getLastMsgH(msg){var len=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,name=arguments[2],lastMsg="",msgType=msg.type,msgText=msg.msg,extType=msg.extType,senderKind=msg.senderKind,receiverKind=msg.receiverKind;switch(extType-0){case _enums.ExtType.MESSAGE_TEXT:lastMsg="img"===msgType?"[图片]":(0,_utils.getBrief)(msgText,len);break;case _enums.ExtType.MESSAGE_RESUME:lastMsg="[委托的简历] "+name+"的简历";break;case _enums.ExtType.MESSAGE_SEND_JOB:lastMsg=senderKind==_constants.UserType.USER_TYPE_C?"[我感兴趣的职位]":senderKind==_constants.UserType.USER_TYPE_H?"[我推荐的职位]":"[职位]";break;case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:lastMsg="[应聘的简历] "+name+"的简历";break;case _enums.ExtType.MESSAGE_SEND_NAMECARD:lastMsg="[应聘者的名片] "+name+"的名片";break;case _enums.ExtType.MESSAGE_ASK_RESUME:lastMsg="索要简历的请求已发送";break;case _enums.ExtType.MESSAGE_SEND_RATINGBAR:lastMsg="[请为猎头服务做出评价]";break;case _enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK:lastMsg="[已拒绝推荐职位]";break;case _enums.ExtType.MESSAGE_SEND_APPLYSUCFEEDBACK:lastMsg="[已接受推荐职位]";break;default:lastMsg=(0,_utils.getBrief)(msgText,len)}return lastMsg}},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function messageLastMsgFilter(message){var type=message.type,messageSource=message.messageSource,receiverKind=message.receiverKind,senderKind=message.senderKind,extType=message.extType;switch(type){case"txt":if((1!=messageSource||0!=receiverKind||0!=senderKind||extType!==_enums.ExtType.MESSAGE_RESUME)&&(1!=messageSource||1!=receiverKind||1!=senderKind||extType!==_enums.ExtType.MESSAGE_SEND_APPLYRESUME)&&_enums.CompatibleExtType.TXT_EXT_TYPES_ARR.includes(extType))return!0;break;case"img":if(_enums.CompatibleExtType.IMG_EXT_TYPES_ARR.includes(extType))return!0}return!1}var _createClass,_enums,LastMessage;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LastMessage=void 0,_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),exports.messageLastMsgFilter=messageLastMsgFilter,_enums=__webpack_require__(162),LastMessage=exports.LastMessage=function(){function LastMessage(){_classCallCheck(this,LastMessage)}return _createClass(LastMessage,[{key:"set",value:function set(content){try{var msg=JSON.parse(content);return this.type=msg.bodies&&msg.bodies[0].type,this.extType=msg.ext.extType,this.msg=msg&&msg.bodies&&msg.bodies[0].msg||"",this.senderKind=msg.ext&&msg.ext.extBody&&msg.ext.extBody.senderKind,this.receiverKind=msg.ext&&msg.ext.extBody&&msg.ext.extBody.receiverKind,this.messageSource=msg.ext&&msg.ext.extBody&&msg.ext.extBody.messageSource,this}catch(e){return null}}}]),LastMessage}()},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function Bcard(props){var env=props.env,v=props.v;switch(v.oppositeImUserType){case"0":return _react2["default"].createElement("a",{href:"/resume/showresumecarte4im?usercId="+v.oppositeUserId+"&oppositeImId="+v.oppositeImId,target:"_blank"},_react2["default"].createElement("dl",{className:"target-info"},_react2["default"].createElement("dt",null,_react2["default"].createElement("img",{className:"tinyFace circle",src:"https://image0.lietou-static.com/normal/"+v.oppositeUserPhoto})),_react2["default"].createElement("dd",{className:"name"},_react2["default"].createElement("span",{className:"name"},(0,_utils.getBrief)(v.oppositeUserName,4))),_react2["default"].createElement("dd",{className:"job-info"},v.oppositeUserSexName?_react2["default"].createElement("span",null,v.oppositeUserSexName," | "):"",v.oppositeUserEdulevelName?_react2["default"].createElement("span",{title:v.oppositeUserEdulevelName},(0,_utils.getBrief)(v.oppositeUserEdulevelName,3)," | "):"",_react2["default"].createElement("span",null,"工作",v.oppositeWorkAge,"年")," | ",_react2["default"].createElement("span",{title:v.oppositeUserDqName},(0,_utils.getBrief)(v.oppositeUserDqName,6)))),_react2["default"].createElement("div",{className:"last-full-msg"},_react2["default"].createElement(_LastMsg2["default"],{env:env,message:v.lastPayload,name:(0,_utils.getBrief)(v.oppositeUserName,3)})));case"3":return _react2["default"].createElement("div",null,_react2["default"].createElement("dl",{className:"target-info",style:{minHeight:40}},_react2["default"].createElement("dt",null,_react2["default"].createElement("img",{className:"tinyFace circle",src:"https://image0.lietou-static.com/normal/"+v.oppositeUserPhoto})),_react2["default"].createElement("dd",{className:"name"},_react2["default"].createElement("span",{className:"name"},(0,_utils.getBrief)(v.oppositeUserName,12)))),_react2["default"].createElement("div",{className:"last-full-msg"},_react2["default"].createElement(_LastMsg2["default"],{env:env,message:v.lastPayload,name:(0,_utils.getBrief)(v.oppositeUserName,3)})))}}function ContactCard(props){var titlePushStr,env=props.imcore.env.toLowerCase(),config=(0,_config2["default"])(env),userInfo=props.imcore.userInfo,v=props.contacts;switch(env){case"c":switch(titlePushStr="",v.oppositeUserKind){case _constants.UserType.USER_TYPE_B.toString():titlePushStr=config.OPEN_BPAGE;break;case _constants.UserType.USER_TYPE_H.toString():titlePushStr=config.OPEN_HPAGE}return _react2["default"].createElement("div",{className:"contact-card"},_react2["default"].createElement(_addTlog.Atlog,{href:v.oppositeMainUrl,target:"_blank",pushStr:titlePushStr},_react2["default"].createElement("dl",{className:"target-info"},_react2["default"].createElement("dt",null,_react2["default"].createElement("img",{
className:"tinyFace circle",src:"https://image0.lietou-static.com/normal/"+v.oppositeUserPhoto})),_react2["default"].createElement("dd",{className:"name"},_react2["default"].createElement(_ContactInfo.CIdentity,{config:config.tlogs,item:v})),_react2["default"].createElement("dd",{className:"job-info"},_react2["default"].createElement("span",{title:v.oppositeUserTitle},(0,_utils.getBrief)(v.oppositeUserTitle,6))," | ",_react2["default"].createElement("span",{title:v.oppositeUserCompany},(0,_utils.getBrief)(v.oppositeUserCompany,10)))),_react2["default"].createElement("div",{className:"last-full-msg"},_react2["default"].createElement(_LastMsg2["default"],{env:env,message:v.lastPayload,name:(0,_utils.getBrief)(userInfo.oppositeUserName,3)}))));case"b":return _react2["default"].createElement("div",{className:"contact-card"},_react2["default"].createElement(Bcard,{env:env,v:v}));case"h":return _react2["default"].createElement("div",{className:"contact-card"},_react2["default"].createElement(_addTlog.Atlog,{href:"https://h.liepin.com/im/showresumedetail4im/?oppositeImId="+v.oppositeImId,target:"_blank",pushStr:config.tlogs.CLICK_CONTACTSCARD},_react2["default"].createElement("dl",{className:"target-info"},_react2["default"].createElement("dt",null,_react2["default"].createElement("img",{className:"tinyFace circle",src:"https://image0.lietou-static.com/normal/"+v.oppositeUserPhoto})),_react2["default"].createElement("dd",{className:"name"},_react2["default"].createElement("span",{className:"name"},(0,_utils.getBrief)(v.oppositeUserName,4))),_react2["default"].createElement("dd",{className:"job-info"},v.oppositeUserSexName?_react2["default"].createElement("span",null,v.oppositeUserSexName," | "):"",v.oppositeUserEdulevelName?_react2["default"].createElement("span",{title:v.oppositeUserEdulevelName},(0,_utils.getBrief)(v.oppositeUserEdulevelName,3)," | "):"",_react2["default"].createElement("span",null,"工作",v.oppositeWorkAge,"年")," | ",_react2["default"].createElement("span",{title:v.oppositeUserDqName},(0,_utils.getBrief)(v.oppositeUserDqName,6)))),_react2["default"].createElement("div",{className:"last-full-msg"},_react2["default"].createElement(_LastMsg2["default"],{env:env,message:v.lastPayload,name:(0,_utils.getBrief)(v.oppositeUserName,3)}))))}}var _react,_react2,_classnames,_classnames2,_config,_config2,_utils,_ContactInfo,_addTlog,_constants,_LastMsg,_LastMsg2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Bcard=Bcard,exports["default"]=ContactCard,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils=__webpack_require__(180),_ContactInfo=__webpack_require__(183),_addTlog=__webpack_require__(182),_constants=__webpack_require__(156),_LastMsg=__webpack_require__(184),_LastMsg2=_interopRequireDefault(_LastMsg),__webpack_require__(188)},function(module,exports){},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_actions,Sns,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_actions=__webpack_require__(173),__webpack_require__(191),Sns=function(_Component){function Sns(props){return _classCallCheck(this,Sns),_possibleConstructorReturn(this,(Sns.__proto__||Object.getPrototypeOf(Sns)).call(this,props))}return _inherits(Sns,_Component),_createClass(Sns,[{key:"render",value:function render(){var _props=this.props,activeTab=_props.activeTab,sns=_props.sns,imcore=_props.imcore,actions=_props.actions;return _react2["default"].createElement("div",{className:(0,_classnames2["default"])("sns",{hide:"sns"!==activeTab.key})},sns.map(function(v,i){return _react2["default"].createElement("ul",{key:i,className:"contact-list"},v.map(function(m,n){if(m.count>=0)return _react2["default"].createElement("li",{key:n},_react2["default"].createElement("a",{href:m.url,target:"_blank"},_react2["default"].createElement("dl",{className:"clearfix"},_react2["default"].createElement("dt",null,_react2["default"].createElement("span",{className:"person-arrow"===m.icon||"person-arr"===m.icon?"back-brown":"building"===m.icon?"back-red":"concern"===m.icon?"back-pink":"back-blue"},_react2["default"].createElement("i",{className:(0,_classnames2["default"])("webim-icons24","icons24-"+m.icon)})),_react2["default"].createElement("i",{className:"dot"})),_react2["default"].createElement("dd",null,m.txt),_react2["default"].createElement("dd",{className:(0,_classnames2["default"])("number")},m.count))))}))}))}}]),Sns}(_react.Component),mapStateToProps=function mapStateToProps(state){return{activeTab:state.panel.activeTab,sns:state.sns.sns}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.snsActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Sns)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_utils,_addTlog,_actions,_config,_config2,_NoticeDetail,_NoticeDetail2,_Dialog,_Dialog2,Notice,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_utils=__webpack_require__(180),_addTlog=__webpack_require__(182),_actions=__webpack_require__(173),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_NoticeDetail=__webpack_require__(193),_NoticeDetail2=_interopRequireDefault(_NoticeDetail),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog),__webpack_require__(197),Notice=function(_Component){function Notice(props){_classCallCheck(this,Notice);var _this=_possibleConstructorReturn(this,(Notice.__proto__||Object.getPrototypeOf(Notice)).call(this,props));return _this.state={showNoticeDetail:!1,dialogVisible:!1,canload:!0},_this}return _inherits(Notice,_Component),_createClass(Notice,[{key:"componentDidMount",value:function componentDidMount(){var _props=this.props,imcore=_props.imcore,actions=_props.actions,loading=_props.loading,nomore=_props.nomore;LT.Comet.on("event_msg_unread_cnt_change",function(_ref){var flag=_ref.flag,data=_ref.data;1===flag&&data.s_unread_cnt>0&&(actions.showNoticeTabUnread(imcore),actions.getNoticeList(imcore,!0))})}},{key:"scrollList",value:function scrollList(){var _props2=this.props,imcore=_props2.imcore,actions=_props2.actions,wrapHeight=this.refs.noticeWrap.clientHeight,listHeight=this.refs.noticeListH.offsetHeight,srcollH=this.refs.noticeWrap.scrollTop;listHeight-wrapHeight-srcollH<50&&this.canload&&(this.canload=!1,actions.getNoticeList(imcore))}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){var sysMsgList=nextProps.sysMsgList,_props3=this.props,actions=_props3.actions,activeTab=_props3.activeTab;nextProps.activeTab.key!==activeTab.key&&nextProps.firstLoaded===!1&&"notice"===nextProps.activeTab.key&&actions.selectTab(imcore,nextProps.activeTab),this.props.sysMsgList&&sysMsgList.length!==this.props.sysMsgList.length&&sysMsgList.length!==this.props.totalCnt&&(this.canload=!0),nextProps.activeTab.key!==this.props.activeTab.key&&"notice"===this.props.activeTab.key&&_Dialog2["default"].closeAllConfirm({parent:"main"})}},{key:"openDialog",value:function openDialog(){this.setState({dialogVisible:!0})}},{key:"closeDialog",value:function closeDialog(){this.setState({dialogVisible:!1})}},{key:"selectNotice",value:function selectNotice(imcore,noticeDetail,index){window.tlog=window.tlog||[],tlog.push((0,_config2["default"])(imcore.env).tlogs.OPEN_NOTICE_LAYER),this.props.actions.hasReadNotice(imcore,noticeDetail,index),this.setState({showNoticeDetail:!0,index:index,noticeDetail:noticeDetail})}},{key:"closeDetail",value:function closeDetail(imcore){this.setState({showNoticeDetail:!1,index:0}),"b"===imcore.env&&(window.tlog=window.tlog||[],tlog.push((0,_config2["default"])(imcore.env).tlogs.CLOSE_NOTICE_LAYER))}},{key:"delNoticeItem",value:function delNoticeItem(e,id,type){var _props4,actions,imcore,_this2=this;e.stopPropagation(),_props4=this.props,actions=_props4.actions,imcore=_props4.imcore,window.tlog=window.tlog||[],tlog.push((0,_config2["default"])(imcore.env).tlogs.DELETE_NOTICE),this.objectId=id,this.objectType=type,_Dialog2["default"].confirm({parent:"main",text:"确定要删除通知吗",onOk:function onOk(){actions.deleteNoticeItem(imcore,_this2.objectId,_this2.objectType)}})}},{key:"render",value:function render(){var _this3=this,_props5=this.props,activeTab=_props5.activeTab,sysMsgList=_props5.sysMsgList,totalCnt=_props5.totalCnt,imcore=_props5.imcore,actions=_props5.actions,nomoreNotice=_props5.nomoreNotice,loading=_props5.loading,firstLoaded=_props5.firstLoaded,failMsg=_props5.failMsg;return firstLoaded?0===sysMsgList.length?_react2["default"].createElement("div",{className:(0,_classnames2["default"])({hide:"notice"!==activeTab.key},"notice")},_react2["default"].createElement("div",{className:"no-message"},_react2["default"].createElement("span",null,"暂无通知"))):_react2["default"].createElement("div",{className:(0,_classnames2["default"])({hide:"notice"!==activeTab.key},"notice")},_react2["default"].createElement("div",{className:"noticeWrap",ref:"noticeWrap",onScroll:function onScroll(){return _this3.scrollList()}},_react2["default"].createElement("ul",{className:"notice-list",ref:"noticeListH"},sysMsgList&&sysMsgList.map(function(val,index){return _react2["default"].createElement("li",{key:index,onClick:function onClick(){return _this3.selectNotice(imcore,val,index)},"data-id":val.id,"data-type":val.type},_react2["default"].createElement("a",{href:"javascript:;",className:"close",onClick:function onClick(e){return _this3.delNoticeItem(e,val.id,val.type)}},"×"),_react2["default"].createElement("dl",{className:"clearfix"},_react2["default"].createElement("dd",null,_react2["default"].createElement("span",{className:"clearfix"},_react2["default"].createElement("time",null,val.createtime?(0,_utils.dateFormat)(val.createtime,"notice"):""),_react2["default"].createElement("label",null,(0,_utils.getBrief)(val.title,5)),"0"===val.readFlag?_react2["default"].createElement("i",{className:"dot"},"new"):""),_react2["default"].createElement("p",null,LT.String.substr("<"===val.context.charAt(0)?$(val.context).text():$("<div></div>").html(val.context).text(),"0","84","…")))))}))),this.state.showNoticeDetail?_react2["default"].createElement(_NoticeDetail2["default"],{index:this.state.index,canLoad:this.canload,closeDetail:this.closeDetail.bind(this),imcore:imcore,noticeDetail:this.state.noticeDetail}):""):_react2["default"].createElement("div",{className:(0,_classnames2["default"])({hide:"notice"!==activeTab.key},"notice")},failMsg?_react2["default"].createElement("div",{className:"fail-loading"},failMsg,"，请刷新页面重试！"):_react2["default"].createElement("div",{className:"list-loading"},_react2["default"].createElement("em",null)))}}]),Notice}(_react.Component),mapStateToProps=function mapStateToProps(state){return{activeTab:state.panel.activeTab,unReadTabs:state.panel.unReadTabs,sysMsgList:state.notice.sysMsgList,totalCnt:state.notice.totalCnt,firstLoaded:state.notice.firstLoaded,nomoreNotice:state.notice.nomoreNotice,loading:state.notice.loading,failMsg:state.notice.failMsg}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.noticeActions,_actions.panelActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Notice)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_reactDom,_reactDom2,_classnames,_classnames2,_redux,_reactRedux,_constants,_config,_config2,_utils,_addTlog,_actions,_NoticeDetailList,_NoticeDetailList2,NoticeDetail,mapStateToProps,mapDispatchToProps,ScrollDialog;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(111),_reactDom2=_interopRequireDefault(_reactDom),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_constants=__webpack_require__(156),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils=__webpack_require__(180),_addTlog=__webpack_require__(182),_actions=__webpack_require__(173),__webpack_require__(194),_NoticeDetailList=__webpack_require__(195),_NoticeDetailList2=_interopRequireDefault(_NoticeDetailList),NoticeDetail=function(_Component){function NoticeDetail(props){_classCallCheck(this,NoticeDetail);var _this=_possibleConstructorReturn(this,(NoticeDetail.__proto__||Object.getPrototypeOf(NoticeDetail)).call(this,props));return _this.current=0,_this.Dom=null,_this}return _inherits(NoticeDetail,_Component),_createClass(NoticeDetail,[{key:"componentDidMount",value:function componentDidMount(){var that=this,_props=this.props,index=_props.index,sysMsgList=_props.sysMsgList,totalCnt=_props.totalCnt,loading=_props.loading,actions=_props.actions,imcore=_props.imcore,curPage=_props.curPage,noticeDetail=_props.noticeDetail;new ScrollDialog({dom:that.refs.detailMain,width:600,modal:!0,current:index,totalPage:totalCnt,callback:function callback(data){var noticeData={};sysMsgList.forEach(function(v,i){i===data.current&&(noticeData=v)}),actions.hasReadNotice(imcore,noticeData,index),data.current>=data.length-2&&data.current<data.totalPage-1&&(++curPage,actions.getNoticeList(imcore,curPage))}})}},{key:"render",value:function render(){var _props2=this.props,imcore=_props2.imcore,actions=_props2.actions,sysMsgList=_props2.sysMsgList,totalCnt=_props2.totalCnt,index=_props2.index,closeDetail=_props2.closeDetail;return _react2["default"].createElement("div",{className:"notice-detail"},_react2["default"].createElement("div",{className:"scroll-dialog-main",ref:"detailMain"},_react2["default"].createElement("a",{className:"sd-close webim-icons32 icons32-detail-close",href:"javascript:;",onClick:function onClick(){return closeDetail(imcore)}}),_react2["default"].createElement(_NoticeDetailList2["default"],{imcore:imcore,sysMsgList:sysMsgList}),_react2["default"].createElement("article",null,_react2["default"].createElement("p",{className:"change-page"},_react2["default"].createElement("a",{"data-selector":"prev-btn",className:"prev-btn webim-icons32 icons32-prev-btn",href:"javascript:;"})),_react2["default"].createElement("span",null,_react2["default"].createElement("i",{"data-selector":"current-page"},index+1),"/",_react2["default"].createElement("i",{"data-selector":"total-page"},totalCnt)),_react2["default"].createElement("p",{className:"change-page"},_react2["default"].createElement("a",{"data-selector":"next-btn",className:"next-btn webim-icons32 icons32-next-btn",href:"javascript:;"})))))}}]),NoticeDetail}(_react.Component),mapStateToProps=function mapStateToProps(state,props){return{sysMsgList:state.notice.sysMsgList,totalCnt:state.notice.totalCnt,curPage:state.notice.curPage,loading:state.contacts.loading}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.noticeActions),dispatch)}},ScrollDialog=function(){function ScrollDialog(options){_classCallCheck(this,ScrollDialog),this.options=$.extend({current:0,content:"",dom:null,init:null,modal:!0,close:null,width:800,canScroll:!0,speed:1500,totalPage:0,callback:null},ScrollDialog._options,options),this._init()}return _createClass(ScrollDialog,[{key:"_init",value:function _init(){var that=this,html=$(that.options.dom);return that.DOM={wrap:html,close:html.find(".sd-close"),content:html.find(".scroll-box"),prevBtn:html.find('[data-selector="prev-btn"]'),nextBtn:html.find('[data-selector="next-btn"]'),totalPage:html.find('[data-selector="total-page"]'),currentPage:html.find('[data-selector="current-page"]'),article:html.find("article"),modal:null},that._build(),that.width(that.options.width),that.init(that.options.init),that.options.modal&&that.showModal(),$(window).on("resize",function(){that.refresh()}).trigger("resize"),that}},{key:"init",value:function init(fn){var that=this,length=$(".scroll-item",this.DOM.wrap).length;return that.length=length,that.DOM.totalPage.html(that.options.totalPage),that.DOM.currentPage.html(that.options.current+1),that.options.init=fn,"function"==typeof fn&&that.options.init.call(that),that.event(),that}},{key:"event",value:function event(){var that=this;that.DOM.wrap.on("mousewheel DOMMouseScroll",function(event,delta){var deltaY,deltaNum,diff,itemWrapH=$(event.target).closest(".content-box")?$(event.target).closest(".content-box").height():0,itemContentH=$(event.target).closest(".content-main")?$(event.target).closest(".content-main").height():0;if(!(itemWrapH<itemContentH&&$(event.target).closest(".content-box"))&&that.options.canScroll)if(deltaY=-event.originalEvent.detail/3||event.originalEvent.wheelDelta/120,deltaNum=Math.round(Math.abs(deltaY)/2),diff=that.length-1-that.options.current,deltaY<0){if(that.options.current>=that.options.totalPage-1)return;deltaNum>=diff?(that.options.current=that.length-1,that.options.canScroll=!0):deltaNum<=2&&that.options.current++,that._move()}else{if(that.options.current<=0)return;deltaNum>=that.options.current?(that.options.current=0,that.options.canScroll=!0):that.options.current--,that._move()}}),that.DOM.prevBtn.on("click",function(event){that.options.current<=0||(that.options.current--,that._move())}),that.DOM.nextBtn.on("click",function(event){that.options.current>=that.options.totalPage-1||(that.options.current++,that._move())})}},{key:"_move",value:function _move(){var that=this;that.options.canScroll=!1,that.DOM.content.stop().animate({top:-that.itemH*that.options.current+"px"},that.options.speed,function(){that.options.canScroll=!0,that.options.canAjax=!0,that.DOM.currentPage.html(that.options.current+1),that.refresh(),that._callback()})}},{key:"_callback",value:function _callback(){var that=this;that.options.callback&&that.options.callback.call(that,{current:that.options.current,totalPage:that.options.totalPage,length:that.length})}},{key:"_build",value:function _build(){var that=this,wrap=this.DOM.wrap;return wrap.css({zIndex:++ScrollDialog._options.zIndex}),wrap.appendTo(wrap.closest(".notice-detail")),ScrollDialog._options.cache.push({dialog:this}),this}},{key:"width",value:function width(_width){return void 0===_width?this.options.width:(this.options.width=_width,this.DOM.content.width(this.options.width),this.refresh(),this)}},{key:"refresh",value:function refresh(){var itemH=void 0,winH=$(window).height(),height=winH-140,item=$(".scroll-item",this.DOM.content);item.css({height:height+"px"}),itemH=item.outerHeight(!0),this.itemH=itemH,this.DOM.content.css({top:-itemH*this.options.current+"px"}),this.options.width&&(this.DOM.content.css({"margin-left":-(this.options.width+68)/2+"px"}),this.DOM.article.css({"margin-left":(this.options.width+68)/2-48+"px"}),this.DOM.close.css({"margin-left":(this.options.width+68)/2-48+"px"})),this.length=$(".scroll-item",this.DOM.wrap).length,0==this.options.current?this.DOM.prevBtn.addClass("icons32-prev-btn-disabled").removeClass("icons32-prev-btn"):this.DOM.prevBtn.addClass("icons32-prev-btn").removeClass("icons32-prev-btn-disabled"),this.options.current==this.options.totalPage-1?this.DOM.nextBtn.addClass("icons32-next-btn-disabled").removeClass("icons32-next-btn"):this.DOM.nextBtn.addClass("icons32-next-btn").removeClass("icons32-next-btn-disabled")}},{key:"showModal",value:function showModal(){return this.DOM.modal=this.DOM.modal||$("<div />").addClass("scroll-dialog-modal").css({zIndex:ScrollDialog._options.zIndex}).insertBefore(this.DOM.wrap),this.DOM.wrap.show(),this.refresh(),this}}]),ScrollDialog}(),ScrollDialog._options={zIndex:1e3,cache:[]},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(NoticeDetail)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_constants,_config,_config2,_utils,_addTlog,_actions,NoticeDetailList;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_constants=__webpack_require__(156),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils=__webpack_require__(180),_addTlog=__webpack_require__(182),_actions=__webpack_require__(173),__webpack_require__(196),NoticeDetailList=function(_Component){function NoticeDetailList(props){return _classCallCheck(this,NoticeDetailList),_possibleConstructorReturn(this,(NoticeDetailList.__proto__||Object.getPrototypeOf(NoticeDetailList)).call(this,props))}return _inherits(NoticeDetailList,_Component),_createClass(NoticeDetailList,[{key:"render",value:function render(){var _props=this.props,sysMsgList=_props.sysMsgList,imcore=_props.imcore,noticeDetail=_props.noticeDetail;return _react2["default"].createElement("div",{className:"scroll-box"},sysMsgList.map(function(val,index){return _react2["default"].createElement("section",{key:index,className:"scroll-item","data-id":val.id,"data-type":val.type},_react2["default"].createElement("div",{className:"title"},val.title),_react2["default"].createElement("div",{className:"content-box"},_react2["default"].createElement("p",{className:"time"},(0,_utils.dateFormat)(val.createtime,"notice")),_react2["default"].createElement("div",{className:"content-main",dangerouslySetInnerHTML:{__html:val.context}})))}))}}]),NoticeDetailList}(_react.Component),exports["default"]=NoticeDetailList},function(module,exports){},function(module,exports){},function(module,exports){"use strict";var OPEN_PANEL,CLOSE_PANEL,OPEN_NOTICE,OPEN_CONTACTS,OPEN_SNS,OLD_VERSION,OPEN_EMOJI,SEND_IMAGE,CLICK_HISTORY_ICON,CLICK_SEND_BTN,CLICK_ENTRUST_ICON,CLICK_HISTORY_LINK,OPEN_CPAGE,OPEN_HPAGE,OPEN_BPAGE,PANEL_SETTING,SELECT_REMIND,SELECT_NOREMIND,SELECT_DIALOG_ENTER,SELECT_DIALOG_CTRLENTER,ATTENTION_BTN,CANCEL_ATTENTION_BTN,DEL_CURRENT_MESSAGE,OPEN_DIALOG_C,OPEN_DIALOG_B,OPEN_DIALOG_H,DELETE_NOTICE,OPEN_NOTICE_LAYER;Object.defineProperty(exports,"__esModule",{value:!0}),OPEN_PANEL=exports.OPEN_PANEL="c:C000010090",CLOSE_PANEL=exports.CLOSE_PANEL="c:C000010092",OPEN_NOTICE=exports.OPEN_NOTICE="c:C000010096",OPEN_CONTACTS=exports.OPEN_CONTACTS="c:C000010095",OPEN_SNS=exports.OPEN_SNS="c:C000010097",OLD_VERSION=exports.OLD_VERSION="c:C000010101",OPEN_EMOJI=exports.OPEN_EMOJI="c:C000010109",SEND_IMAGE=exports.SEND_IMAGE="c:C000010108",CLICK_HISTORY_ICON=exports.CLICK_HISTORY_ICON="c:C000010107",CLICK_SEND_BTN=exports.CLICK_SEND_BTN="c:C000010110",CLICK_ENTRUST_ICON=exports.CLICK_ENTRUST_ICON="c:C000010116",CLICK_HISTORY_LINK=exports.CLICK_HISTORY_LINK="c:C000010106",OPEN_CPAGE=exports.OPEN_CPAGE="c:C000010103",OPEN_HPAGE=exports.OPEN_HPAGE="c:C000010104",OPEN_BPAGE=exports.OPEN_BPAGE="c:C000010105",PANEL_SETTING=exports.PANEL_SETTING="c:C000010091",SELECT_REMIND=exports.SELECT_REMIND="c:C000010093",SELECT_NOREMIND=exports.SELECT_NOREMIND="c:C000010094",SELECT_DIALOG_ENTER=exports.SELECT_DIALOG_ENTER="c:C000010391",SELECT_DIALOG_CTRLENTER=exports.SELECT_DIALOG_CTRLENTER="c:C000010392",ATTENTION_BTN=exports.ATTENTION_BTN="c:C000010115",CANCEL_ATTENTION_BTN=exports.CANCEL_ATTENTION_BTN="c:C000010114",DEL_CURRENT_MESSAGE=exports.DEL_CURRENT_MESSAGE="c:C000010102",OPEN_DIALOG_C=exports.OPEN_DIALOG_C="c:C000010098",OPEN_DIALOG_B=exports.OPEN_DIALOG_B="c:C000010099",OPEN_DIALOG_H=exports.OPEN_DIALOG_H="c:C000010100",DELETE_NOTICE=exports.DELETE_NOTICE="c:C000010119",OPEN_NOTICE_LAYER=exports.OPEN_NOTICE_LAYER="c:C000010118"},function(module,exports){"use strict";var tooldversion,mycontacts,simpleInfos,getsysmsglist4im,delsysmessagebyid,readedmessagebyid,snsList,chart,readed,getonecontact,delmycontact,saveChatSetting,getHiList,canAssessH,assessH,canSendExtType,recordSendJobCard,infoBetweenUsers,addCBl,removeCBl,aadduserhblacklist,removeuserhblacklist,reportChat,jobstatus,jobrefuse,unreadcount;Object.defineProperty(exports,"__esModule",{value:!0}),tooldversion=exports.tooldversion=LT.Env.cRoot+"message/#c:1:/message/getcmsg/",mycontacts=exports.mycontacts="https://im.liepin.com/mycontacts.json",simpleInfos=exports.simpleInfos=LT.Env.cRoot+"user/simple-infos.json",getsysmsglist4im=exports.getsysmsglist4im=LT.Env.cRoot+"message/getsysmsglist4im.json",delsysmessagebyid=exports.delsysmessagebyid=LT.Env.cRoot+"message/delsysmessagebyid.json",readedmessagebyid=exports.readedmessagebyid=LT.Env.cRoot+"message/readedmessagebyid.json",snsList=exports.snsList=LT.Env.cRoot+"connection/count.json",chart=exports.chart="https://im.liepin.com/chart.json",readed=exports.readed="https://im.liepin.com/readed.json",getonecontact=exports.getonecontact=LT.Env.cRoot+"msg/getonecontact.json",delmycontact=exports.delmycontact="https://im.liepin.com/delmycontact.json",saveChatSetting=exports.saveChatSetting=LT.Env.cRoot+"msg/save-chat-setting.json",getHiList=exports.getHiList=LT.Env.cRoot+"msg/get-hi-list.json",
canAssessH=exports.canAssessH=LT.Env.cRoot+"msg/can-assess-h.json",assessH=exports.assessH=LT.Env.cRoot+"msg/assess-h.json",canSendExtType=exports.canSendExtType=LT.Env.cRoot+"msg/canSendExtType.json",recordSendJobCard=exports.recordSendJobCard=LT.Env.cRoot+"msg/recordSendJobCard.json",infoBetweenUsers=exports.infoBetweenUsers=LT.Env.cRoot+"user/info-between-users.json",addCBl=exports.addCBl=LT.Env.cRoot+"user/add-c-bl.json",removeCBl=exports.removeCBl=LT.Env.cRoot+"user/remove-c-bl.json",aadduserhblacklist=exports.aadduserhblacklist=LT.Env.cRoot+"user/adduserhblacklist.json",removeuserhblacklist=exports.removeuserhblacklist=LT.Env.cRoot+"user/removeuserhblacklist.json",reportChat=exports.reportChat=LT.Env.cRoot+"msg/report-chat.json",jobstatus=exports.jobstatus=LT.Env.cRoot+"job/feedback/recommandhjob/status.json",jobrefuse=exports.jobrefuse=LT.Env.cRoot+"job/feedback/refuse.json",unreadcount=exports.unreadcount="https://im.liepin.com/unreadcount.json"},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _tabs,_tlogs2,_tlogs,_urls2,_urls;Object.defineProperty(exports,"__esModule",{value:!0}),exports.urls=exports.tlogs=exports.tabs=void 0,_tabs=__webpack_require__(201),Object.defineProperty(exports,"tabs",{enumerable:!0,get:function get(){return _tabs.tabs}}),_tlogs2=__webpack_require__(204),_tlogs=_interopRequireWildcard(_tlogs2),_urls2=__webpack_require__(205),_urls=_interopRequireWildcard(_urls2),exports.tlogs=_tlogs,exports.urls=_urls},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _Contacts,_Contacts2,_HistoryContacts,_HistoryContacts2,_Notice,_Notice2,tabs;Object.defineProperty(exports,"__esModule",{value:!0}),exports.tabs=void 0,_Contacts=__webpack_require__(179),_Contacts2=_interopRequireDefault(_Contacts),_HistoryContacts=__webpack_require__(202),_HistoryContacts2=_interopRequireDefault(_HistoryContacts),_Notice=__webpack_require__(192),_Notice2=_interopRequireDefault(_Notice),tabs=exports.tabs=[{key:"contacts",name:"消息",comp:_Contacts2["default"]},{key:"historycontacts",name:"最近",comp:_HistoryContacts2["default"]},{key:"notice",name:"通知",comp:_Notice2["default"]}]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_ContactInfo,_ContactInfo2,_ContactCard,_ContactCard2,_actions,_addTlog,_Dialog,_Dialog2,HistoryContacts,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_ContactInfo=__webpack_require__(183),_ContactInfo2=_interopRequireDefault(_ContactInfo),_ContactCard=__webpack_require__(187),_ContactCard2=_interopRequireDefault(_ContactCard),_actions=__webpack_require__(173),_addTlog=__webpack_require__(182),__webpack_require__(203),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog),HistoryContacts=function(_Component){function HistoryContacts(props){_classCallCheck(this,HistoryContacts);var _this=_possibleConstructorReturn(this,(HistoryContacts.__proto__||Object.getPrototypeOf(HistoryContacts)).call(this,props));return _this.canload=!0,_this.curMsgPage=0,_this.state={hover:!1},_this.containerDom=null,_this}return _inherits(HistoryContacts,_Component),_createClass(HistoryContacts,[{key:"componentDidMount",value:function componentDidMount(){var _props=this.props,imcore=_props.imcore,actions=_props.actions,contacts=_props.contacts,loading=_props.loading,nomore=_props.nomore,firstLoaded=_props.firstLoaded,that=this,$container=$(this.containerDom);$container.on("scroll",function(){var containerHeight=$container.height(),scrollTop=this.scrollTop,listHeight=$container.find(".scrolldiv").height();scrollTop+containerHeight+20>listHeight&&firstLoaded&that.getHistoryContacts()}),$container.hover(function(){$(this).addClass("lihover")},function(){$(this).removeClass("lihover")})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){var _props2=this.props,actions=_props2.actions,activeTab=_props2.activeTab;nextProps.activeTab.key!==activeTab.key&&nextProps.firstLoaded===!1&&"historycontacts"===nextProps.activeTab.key&&actions.selectTab(imcore,nextProps.activeTab),nextProps.activeTab.key!==activeTab.key&&"historycontacts"===activeTab.key&&_Dialog2["default"].closeAllConfirm({parent:"main"})}},{key:"getHistoryContacts",value:function getHistoryContacts(){var _props3=this.props,imcore=_props3.imcore,actions=_props3.actions,loading=_props3.loading,nomore=_props3.nomore;nomore||loading||actions.getHistoryContactsList(imcore)}},{key:"delContact",value:function delContact(v,e){var _props4=this.props,actions=_props4.actions,imcore=_props4.imcore;_Dialog2["default"].confirm({parent:"main",onOk:function onOk(){actions.deleteContact(imcore,v)},text:"确定删除该联系人吗"}),e.stopPropagation()}},{key:"setHoverStyle",value:function setHoverStyle(){this.setState({hover:!0})}},{key:"removeHoverStyle",value:function removeHoverStyle(){this.setState({hover:!1})}},{key:"renderList",value:function renderList(){var _this2=this,_props5=this.props,activeTab=_props5.activeTab,firstLoaded=_props5.firstLoaded,curMonthContacts=_props5.curMonthContacts,earlierContacts=_props5.earlierContacts,imcore=_props5.imcore,actions=_props5.actions,setting=_props5.setting;return firstLoaded?_react2["default"].createElement("div",{className:"scrolldiv"},_react2["default"].createElement("h4",null,"本月"),_react2["default"].createElement("ul",null,curMonthContacts.map(function(v,i){return _react2["default"].createElement("li",{key:i,className:"clearfix"},_react2["default"].createElement("a",{className:"close",href:"javascript:;",onClick:function onClick(e){return _this2.delContact(v,e)}},"×"),_react2["default"].createElement(_ContactInfo2["default"],{imcore:imcore,contacts:v,actions:actions,isHistory:!1}),_react2["default"].createElement(_ContactCard2["default"],{imcore:imcore,contacts:v}))})),_react2["default"].createElement("h4",null,"更早"),_react2["default"].createElement("ul",null,earlierContacts&&earlierContacts.map(function(v,i){return _react2["default"].createElement("li",{key:i,onClick:function onClick(){return actions.selectContact(imcore,v)},className:"clearfix",onMouseEnter:function onMouseEnter(){_this2.setHoverStyle()},onMouseLeave:function onMouseLeave(){_this2.removeHoverStyle()}},_react2["default"].createElement("a",{className:"close",href:"javascript:;",onClick:function onClick(e){return _this2.delContact(v,e)}},"×"),_react2["default"].createElement(_ContactInfo2["default"],{imcore:imcore,contacts:v,isHistory:!1,actions:actions,setting:setting}),_react2["default"].createElement(_ContactCard2["default"],{imcore:imcore,contacts:v}))}))):_react2["default"].createElement("div",{className:"list-loading"},_react2["default"].createElement("em",null))}},{key:"render",value:function render(){var _this3=this,_props6=this.props,activeTab=_props6.activeTab,actions=_props6.actions,setting=_props6.setting;return _react2["default"].createElement("div",{className:(0,_classnames2["default"])("historycontacts",{hide:"historycontacts"!==activeTab.key})},_react2["default"].createElement("div",{className:"history-contact-list",ref:function ref(dom){return _this3.containerDom=dom}},this.renderList()))}}]),HistoryContacts}(_react.Component),mapStateToProps=function mapStateToProps(state){return{activeTab:state.panel.activeTab,firstLoaded:state.historyContacts.firstLoaded,curMonthContacts:state.historyContacts.curMonthContacts,earlierContacts:state.historyContacts.earlierContacts,loading:state.historyContacts.loading,nomore:state.historyContacts.nomore,setting:state.setting}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.contactsActions,_actions.panelActions,_actions.historyContactsActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(HistoryContacts)},function(module,exports){},function(module,exports){"use strict";var OPEN_PANEL,CLOSE_PANEL,OPEN_NOTICE,OPEN_CONTACTS,OPEN_HISTORYLIST,OLD_VERSION,OPEN_EMOJI,SEND_IMAGE,CLICK_HISTORY_ICON,CLICK_SEND_BTN,CLICK_HISTORY_LINK,PANEL_SETTING,SELECT_REMIND,SELECT_NOREMIND,SELECT_DIALOG_ENTER,SELECT_DIALOG_CTRLENTER,DEL_CURRENT_MESSAGE,OPEN_DIALOG_C,CLOSE_NOTICE_LAYER,OPEN_NOTICE_LAYER,CLICK_HISTORYCONTACTS,DELETE_NOTICE,EMPLOY_SUIT,RESUME_SUIT,RESUME_UNSUIT,ASK_RESUME,SHIELD_MSG,SHIELD_MSG_RELIVE,SHIELD_MSG_WINDOW,SHIELD_MSG_RELIVE_WINDOW;Object.defineProperty(exports,"__esModule",{value:!0}),OPEN_PANEL=exports.OPEN_PANEL="c:C000010709",CLOSE_PANEL=exports.CLOSE_PANEL="c:C000010710",OPEN_NOTICE=exports.OPEN_NOTICE="c:C000010711",OPEN_CONTACTS=exports.OPEN_CONTACTS="c:C000010729",OPEN_HISTORYLIST=exports.OPEN_HISTORYLIST="c:C000010712",OLD_VERSION=exports.OLD_VERSION="c:C000010713",OPEN_EMOJI=exports.OPEN_EMOJI="c:C000010714",SEND_IMAGE=exports.SEND_IMAGE="c:C000010715",CLICK_HISTORY_ICON=exports.CLICK_HISTORY_ICON="c:C000010716",CLICK_SEND_BTN=exports.CLICK_SEND_BTN="c:C000010717",CLICK_HISTORY_LINK=exports.CLICK_HISTORY_LINK="c:C000010718",PANEL_SETTING=exports.PANEL_SETTING="c:C000010719",SELECT_REMIND=exports.SELECT_REMIND="c:C000010720",SELECT_NOREMIND=exports.SELECT_NOREMIND="c:C000010721",SELECT_DIALOG_ENTER=exports.SELECT_DIALOG_ENTER="c:C000010722",SELECT_DIALOG_CTRLENTER=exports.SELECT_DIALOG_CTRLENTER="c:C000010723",DEL_CURRENT_MESSAGE=exports.DEL_CURRENT_MESSAGE="c:C000010724",OPEN_DIALOG_C=exports.OPEN_DIALOG_C="c:C000010725",CLOSE_NOTICE_LAYER=exports.CLOSE_NOTICE_LAYER="c:C000010726",OPEN_NOTICE_LAYER=exports.OPEN_NOTICE_LAYER="c:C000010727",CLICK_HISTORYCONTACTS=exports.CLICK_HISTORYCONTACTS="c:C000010728",DELETE_NOTICE=exports.DELETE_NOTICE="c:C000010732",EMPLOY_SUIT=exports.EMPLOY_SUIT="c:C000010380",RESUME_SUIT=exports.RESUME_SUIT="c:C000010381",RESUME_UNSUIT=exports.RESUME_UNSUIT="c:C000010382",ASK_RESUME=exports.ASK_RESUME="C000010798",SHIELD_MSG=exports.SHIELD_MSG="c:C000010544",SHIELD_MSG_RELIVE=exports.SHIELD_MSG_RELIVE="c:C000010547",SHIELD_MSG_WINDOW=exports.SHIELD_MSG_WINDOW="c:C000010545",SHIELD_MSG_RELIVE_WINDOW=exports.SHIELD_MSG_RELIVE_WINDOW="c:C000010548"},function(module,exports){"use strict";var tooldversion,mycontacts,simpleInfos,chart,getsysmsglist4im,readedmessagebyid,delsysmessagebyid,getonecontact,delmycontact,gethistorycontactlist,getapplyidbyejobidandresid,batchchangeapplycategorybyapplyids,infoBetweenUsers,rejectreceivemsg,cancelrejectreceivemsg,askresume,iscanaskresume,successaskresume,readed,unreadcount;Object.defineProperty(exports,"__esModule",{value:!0}),tooldversion=exports.tooldversion="//lpt.liepin.com/message/showmessageindex/#c:1:/message/showecgrouplist/",mycontacts=exports.mycontacts="https://im.liepin.com/mycontacts.json",simpleInfos=exports.simpleInfos=LT.Env.lptRoot+"im/simple-infos.json",chart=exports.chart="https://im.liepin.com/chart.json",getsysmsglist4im=exports.getsysmsglist4im=LT.Env.lptRoot+"message/getsysmsglist4im.json",readedmessagebyid=exports.readedmessagebyid=LT.Env.lptRoot+"message/handleunreadsysmessageasread.json",delsysmessagebyid=exports.delsysmessagebyid=LT.Env.lptRoot+"message/delsysmessagebyid.json",getonecontact=exports.getonecontact=LT.Env.lptRoot+"im/getonecontact.json",delmycontact=exports.delmycontact="https://im.liepin.com/delmycontact.json",gethistorycontactlist=exports.gethistorycontactlist=LT.Env.lptRoot+"im/gethistorycontactlist.json",getapplyidbyejobidandresid=exports.getapplyidbyejobidandresid=LT.Env.lptRoot+"apply/getapplyidbyejobidandresid.json",batchchangeapplycategorybyapplyids=exports.batchchangeapplycategorybyapplyids=LT.Env.lptRoot+"apply/batchchangeapplycategorybyapplyids.json",infoBetweenUsers=exports.infoBetweenUsers=LT.Env.lptRoot+"im/getrejectstatus.json",rejectreceivemsg=exports.rejectreceivemsg=LT.Env.lptRoot+"im/rejectreceivemsg.json",cancelrejectreceivemsg=exports.cancelrejectreceivemsg=LT.Env.lptRoot+"im/cancelrejectreceivemsg.json",askresume=exports.askresume=LT.Env.lptRoot+"im/checkforaskresume.json",iscanaskresume=exports.iscanaskresume=LT.Env.lptRoot+"im/canaskresume.json",successaskresume=exports.successaskresume=LT.Env.lptRoot+"im/successaskresume.json",readed=exports.readed="https://im.liepin.com/readed.json",unreadcount=exports.unreadcount="https://im.liepin.com/unreadcount.json"},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _tabs,_tlogs2,_tlogs,_urls2,_urls;Object.defineProperty(exports,"__esModule",{value:!0}),exports.urls=exports.tlogs=exports.tabs=void 0,_tabs=__webpack_require__(207),Object.defineProperty(exports,"tabs",{enumerable:!0,get:function get(){return _tabs.tabs}}),_tlogs2=__webpack_require__(208),_tlogs=_interopRequireWildcard(_tlogs2),_urls2=__webpack_require__(209),_urls=_interopRequireWildcard(_urls2),exports.tlogs=_tlogs,exports.urls=_urls},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _Contacts,_Contacts2,_HistoryContacts,_HistoryContacts2,_Notice,_Notice2,tabs;Object.defineProperty(exports,"__esModule",{value:!0}),exports.tabs=void 0,_Contacts=__webpack_require__(179),_Contacts2=_interopRequireDefault(_Contacts),_HistoryContacts=__webpack_require__(202),_HistoryContacts2=_interopRequireDefault(_HistoryContacts),_Notice=__webpack_require__(192),_Notice2=_interopRequireDefault(_Notice),tabs=exports.tabs=[{key:"contacts",name:"消息",comp:_Contacts2["default"]},{key:"historycontacts",name:"历史",comp:_HistoryContacts2["default"]},{key:"notice",name:"通知",comp:_Notice2["default"]}]},function(module,exports){"use strict";var OPEN_PANEL,CLOSE_PANEL,PANEL_SETTING,SELECT_REMIND,SELECT_NOREMIND,OPEN_CONTACTS,OPEN_NOTICE,OPEN_HISTORYLIST,CLICK_HISTORYCONTACTS,OPEN_DIALOG_C,OLD_VERSION,DEL_CURRENT_MESSAGE,CLICK_CONTACTSCARD,CLICK_DIALOG_CONTACTSINFO,CLICK_DIALOG_RESUMEBTN,ATTENTION_BTN,CANCEL_ATTENTION_BTN,CLICK_HISTORY_LINK,CLICK_HISTORY_ICON,SEND_IMAGE,OPEN_EMOJI,CLICK_SEND_BTN,CLICK_RECOMMEND_ICON,CLICK_RECOMMEND_DETAIL,OPEN_CPAGE,OPEN_NOTICE_LAYER,DELETE_NOTICE,CLICK_ASKRESUME,CLICK_APPLYRESUME;Object.defineProperty(exports,"__esModule",{value:!0}),OPEN_PANEL=exports.OPEN_PANEL="c:C000010063",CLOSE_PANEL=exports.CLOSE_PANEL="c:C000010065",PANEL_SETTING=exports.PANEL_SETTING="c:C000010064",SELECT_REMIND=exports.SELECT_REMIND="c:C000010066",SELECT_NOREMIND=exports.SELECT_NOREMIND="c:C000010067",OPEN_CONTACTS=exports.OPEN_CONTACTS="c:C000010068",OPEN_NOTICE=exports.OPEN_NOTICE="c:C000010069",OPEN_HISTORYLIST=exports.OPEN_HISTORYLIST="c:C000010070",CLICK_HISTORYCONTACTS=exports.CLICK_HISTORYCONTACTS="c:C000010071",OPEN_DIALOG_C=exports.OPEN_DIALOG_C="c:C000010072",OLD_VERSION=exports.OLD_VERSION="c:C000010073",DEL_CURRENT_MESSAGE=exports.DEL_CURRENT_MESSAGE="c:C000010074",CLICK_CONTACTSCARD=exports.CLICK_CONTACTSCARD="c:C000010075",CLICK_DIALOG_CONTACTSINFO=exports.CLICK_DIALOG_CONTACTSINFO="c:C000010076",CLICK_DIALOG_RESUMEBTN=exports.CLICK_DIALOG_RESUMEBTN="c:C000010077",ATTENTION_BTN=exports.ATTENTION_BTN="c:C000010078",CANCEL_ATTENTION_BTN=exports.CANCEL_ATTENTION_BTN="c:C000010079",CLICK_HISTORY_LINK=exports.CLICK_HISTORY_LINK="c:C000010080",CLICK_HISTORY_ICON=exports.CLICK_HISTORY_ICON="c:C000010081",SEND_IMAGE=exports.SEND_IMAGE="c:C000010082",OPEN_EMOJI=exports.OPEN_EMOJI="c:C000010083",CLICK_SEND_BTN=exports.CLICK_SEND_BTN="c:C000010084",CLICK_RECOMMEND_ICON=exports.CLICK_RECOMMEND_ICON="c:C000010085",CLICK_RECOMMEND_DETAIL=exports.CLICK_RECOMMEND_DETAIL="c:C000010086",OPEN_CPAGE=exports.OPEN_CPAGE="c:C000010087",OPEN_NOTICE_LAYER=exports.OPEN_NOTICE_LAYER="c:C000010088",DELETE_NOTICE=exports.DELETE_NOTICE="c:C000010089",CLICK_ASKRESUME=exports.CLICK_ASKRESUME="c:C000010800",CLICK_APPLYRESUME=exports.CLICK_APPLYRESUME="c:C000010801"},function(module,exports){"use strict";var tooldversion,mycontacts,simpleInfos,getsysmsglist4im,delsysmessagebyid,readedmessagebyid,chart,readed,getonecontact,delmycontact,getonecontactotherinfo,gethistorycontactlist,isapplyfeedback,updateappresappropriate4im,hasaskedresume,checkaskresume,askresume,unreadcount;Object.defineProperty(exports,"__esModule",{value:!0}),tooldversion=exports.tooldversion=LT.Env.hRoot+"message/showmessage/",mycontacts=exports.mycontacts="https://im.liepin.com/mycontacts.json",simpleInfos=exports.simpleInfos=LT.Env.hRoot+"user/simple-infos.json",getsysmsglist4im=exports.getsysmsglist4im=LT.Env.hRoot+"message/getsysmsglist4im.json",delsysmessagebyid=exports.delsysmessagebyid=LT.Env.hRoot+"message/delsysmessagebyid.json",readedmessagebyid=exports.readedmessagebyid=LT.Env.hRoot+"message/readedmessagebyid.json",chart=exports.chart="https://im.liepin.com/chart.json",readed=exports.readed="https://im.liepin.com/readed.json",getonecontact=exports.getonecontact=LT.Env.hRoot+"message/getonecontact.json",delmycontact=exports.delmycontact="https://im.liepin.com/delmycontact.json",getonecontactotherinfo=exports.getonecontactotherinfo=LT.Env.hRoot+"im/getonecontactotherinfo.json",gethistorycontactlist=exports.gethistorycontactlist=LT.Env.hRoot+"im/gethistorycontactlist.json",isapplyfeedback=exports.isapplyfeedback=LT.Env.hRoot+"resume/isapplyfeedback.json",updateappresappropriate4im=exports.updateappresappropriate4im=LT.Env.hRoot+"resume/updateappresappropriate4im.json",hasaskedresume=exports.hasaskedresume=LT.Env.hRoot+"message/hasaskedresume.json",checkaskresume=exports.checkaskresume=LT.Env.hRoot+"message/checkaskresume.json",askresume=exports.askresume=LT.Env.hRoot+"message/askresume.json",unreadcount=exports.unreadcount="https://im.liepin.com/unreadcount.json"},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function showHistory(imcore){return{type:ActionType.SHOW_HISTORY,payload:{visible:!0,serverHistory:[],lastmsgid:-1,nomore:!1}}}function hideHistory(imcore){return{type:ActionType.SHOW_HISTORY,payload:{visible:!1}}}function getServerHistory(imcore,targetDetail){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){var list,nomore,newLastmsgid,formattedServerHistory,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,history,newMsg,formatted;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,dispatch({type:ActionType.GET_SERVER_HISTORY_STARTED,payload:{loading:!0}}),_context.next=4,_api.historyApi.getHistoryFromServer(imcore,getState().panel.activeContact.oppositeImId,getState().history.lastmsgid,_constants2.enums.HISTORY_PAGESIZE);case 4:list=_context.sent,nomore=getState().history.nomore,newLastmsgid=-1,list.length>0?(newLastmsgid=list[list.length-1].msgId-1,nomore=list.length!==_constants2.enums.HISTORY_PAGESIZE):nomore=!0,list=list.reverse(),formattedServerHistory=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_context.prev=13,_iterator=list[Symbol.iterator]();case 15:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=25;break}return history=_step.value,newMsg=(new _history.HistoryMsg).set({msg:history,targetDetail:targetDetail,userDetail:imcore.userInfo}),_context.next=20,newMsg.fillInfo(imcore);case 20:formatted=_context.sent.getDetailFormat(),formatted.visible&&formattedServerHistory.push(formatted);case 22:_iteratorNormalCompletion=!0,_context.next=15;break;case 25:_context.next=31;break;case 27:_context.prev=27,_context.t0=_context["catch"](13),_didIteratorError=!0,_iteratorError=_context.t0;case 31:_context.prev=31,_context.prev=32,!_iteratorNormalCompletion&&_iterator["return"]&&_iterator["return"]();case 34:if(_context.prev=34,!_didIteratorError){_context.next=37;break}throw _iteratorError;case 37:return _context.finish(34);case 38:return _context.finish(31);case 39:(0,_utils.publish)(imcore,dispatch,{type:ActionType.GET_SERVER_HISTORY_SUCCESS,payload:{newpage:formattedServerHistory,lastmsgid:newLastmsgid,loading:!1,nomore:nomore}}),_context.next=46;break;case 42:_context.prev=42,_context.t1=_context["catch"](0),imcore.handleErr(_context.t1),dispatch({type:ActionType.GET_SERVER_HISTORY_FAILED,payload:{loading:!1}});case 46:case"end":return _context.stop()}},_callee,_this,[[0,42],[13,27,31,39],[32,,34,38]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}function getInitialServerHistory(imcore,targetDetail){var _this2=this;return function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(dispatch,getState){var list,formattedServerHistory,_iteratorNormalCompletion2,_didIteratorError2,_iteratorError2,_iterator2,_step2,history,newMsg,formatted;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,dispatch({type:ActionType.GET_INITIAL_SERVER_HISTORY_START,payload:null}),_context2.next=4,_api.historyApi.getHistoryFromServer(imcore,targetDetail.oppositeImId,-1,30);case 4:list=_context2.sent,formattedServerHistory=[],_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0,_context2.prev=9,_iterator2=list[Symbol.iterator]();case 11:if(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done){_context2.next=21;break}return history=_step2.value,newMsg=(new _history.HistoryMsg).set({msg:history,targetDetail:targetDetail,userDetail:imcore.userInfo}),_context2.next=16,newMsg.fillInfo(imcore);case 16:formatted=_context2.sent.getDetailFormat(),formatted.visible&&formattedServerHistory.push(formatted);case 18:_iteratorNormalCompletion2=!0,_context2.next=11;break;case 21:_context2.next=27;break;case 23:_context2.prev=23,_context2.t0=_context2["catch"](9),_didIteratorError2=!0,_iteratorError2=_context2.t0;case 27:_context2.prev=27,_context2.prev=28,!_iteratorNormalCompletion2&&_iterator2["return"]&&_iterator2["return"]();case 30:if(_context2.prev=30,!_didIteratorError2){_context2.next=33;break}throw _iteratorError2;case 33:return _context2.finish(30);case 34:return _context2.finish(27);case 35:formattedServerHistory.sort(function(a,b){return a.timestamp>b.timestamp?1:-1}),(0,_utils.publish)(imcore,dispatch,{type:ActionType.GET_INITIAL_SERVER_HISTORY,payload:formattedServerHistory}),_context2.next=43;break;case 39:_context2.prev=39,_context2.t1=_context2["catch"](0),dispatch({type:ActionType.GET_INITIAL_SERVER_HISTORY_FAIL,payload:null}),imcore.handleErr(_context2.t1);case 43:case"end":return _context2.stop()}},_callee2,_this2,[[0,39],[9,23,27,35],[28,,30,34]])}));return function(_x3,_x4){return _ref2.apply(this,arguments)}}()}function clearInitialServerHistory(imcore){return{type:ActionType.CLEAR_INITIAL_SERVER_HISTORY,payload:null}}function updateInitialServerHistory(imcore,updateFunc){return function(dispatch,getState){(0,_utils.publish)(imcore,dispatch,{type:ActionType.UPDATE_INITIAL_SERVER_HISTORY,payload:updateFunc(getState().history.initialServerHistory)})}}var _history,_constants,_constants2,_ActionType,ActionType,_config,_config2,_api,_utils;Object.defineProperty(exports,"__esModule",{value:!0}),exports.showHistory=showHistory,exports.hideHistory=hideHistory,exports.getServerHistory=getServerHistory,exports.getInitialServerHistory=getInitialServerHistory,exports.clearInitialServerHistory=clearInitialServerHistory,exports.updateInitialServerHistory=updateInitialServerHistory,_history=__webpack_require__(211),_constants=__webpack_require__(156),_constants2=__webpack_require__(212),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_api=__webpack_require__(215),_utils=__webpack_require__(180)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function getJobKindEnum(jobkind){switch(jobkind){case"HJOB":return"1";case"EJOB":return"2";case"GJOB":return"3";case"CJOB":return"4";case"RPOJOB":return"5";default:return"1"}}function messageHistoryFilter(message){var type=message.type,extType=message.extType,messageSource=void 0,senderKind=void 0,receiverKind=void 0;switch(void 0!=message.messageSource?(messageSource=message.messageSource,senderKind=message.senderKind,receiverKind=message.receiverKind):message.ext&&(messageSource=message.ext.extBody.messageSource,senderKind=message.ext.extBody.senderKind,receiverKind=message.ext.extBody.receiverKind),type){case"txt":if((1!=messageSource||0!=receiverKind||0!=senderKind||extType!==_enums.ExtType.MESSAGE_RESUME)&&(1!=messageSource||1!=receiverKind||1!=senderKind||extType!==_enums.ExtType.MESSAGE_SEND_APPLYRESUME)&&_enums.CompatibleExtType.TXT_EXT_TYPES_ARR.includes(extType))return!0;break;case"img":if(_enums.CompatibleExtType.IMG_EXT_TYPES_ARR.includes(extType))return!0}return!1}var _extends,_createClass,_enums,_api,api,_constants,HistoryMsg;Object.defineProperty(exports,"__esModule",{value:!0}),exports.HistoryMsg=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),exports.messageHistoryFilter=messageHistoryFilter,_enums=__webpack_require__(162),_api=__webpack_require__(166),api=_interopRequireWildcard(_api),_constants=__webpack_require__(156),HistoryMsg=exports.HistoryMsg=function(){function HistoryMsg(){_classCallCheck(this,HistoryMsg)}return _createClass(HistoryMsg,[{key:"set",value:function set(options){var _options$msg=options.msg,direction=_options$msg.direction,msgId=_options$msg.msgId,payload=_options$msg.payload,msgTime=_options$msg.msgTime,oppositeUserId=_options$msg.oppositeUserId,timestamp=_options$msg.timestamp,userId=_options$msg.userId,oppositeImId=_options$msg.oppositeImId,imId=_options$msg.imId,userDetail=options.userDetail,targetDetail=options.targetDetail,content=JSON.parse(payload);if(this.id=msgId,this.from="1"===direction?oppositeImId:imId,this.to="1"===direction?imId:oppositeImId,this.value=content.bodies,this.type=this.value[0].type,this.extType=content.ext&&content.ext.extType-0,this.timestamp=msgTime?msgTime:Date.now(),this.state=2,this.data=this.value[0].msg,this.senderKind="1"===direction?targetDetail.oppositeUserKind:userDetail.oppositeUserKind,this.receiverKind="0"===direction?targetDetail.oppositeUserKind:userDetail.oppositeUserKind,this.userId=userId,this.jobId=content.ext&&content.ext.extBody.jobId,this.jobKind=content.ext&&content.ext.extBody.jobKind,this.reason=content.ext&&content.ext.extBody.reason,this.messageSource=content.ext&&content.ext.extBody.messageSource,this.extBody=content.ext&&content.ext.extBody,this.visible=!0,"img"===this.type)this.data=this.value[0].url||this.value[0].msg;else switch(this.extType){case _enums.ExtType.MESSAGE_RESUME:userDetail.oppositeUserKind==_constants.UserType.USER_TYPE_C?(this.resumeUrl="//c.liepin.com/resume/getdefaultresume/",this.name=userDetail.oppositeUserName,this.title=userDetail.oppositeUserTitle,this.company=userDetail.oppositeUserCompany):(this.name=targetDetail.oppositeUserNameShow||targetDetail.oppositeUserName,this.title=targetDetail.oppositeUserTitle,this.company=targetDetail.oppositeUserCompany,userDetail.oppositeUserKind==_constants.UserType.USER_TYPE_H&&(this.resumeUrl="//h.liepin.com/resume/showresumedetail4im/?oppositeEmUserName="+targetDetail.oppositeImId));break;case _enums.ExtType.MESSAGE_SEND_JOB:this.jobId=content.ext.extBody.jobId,this.jobKind=content.ext.extBody.jobKind,this.isHandler=content.ext.extBody.isHandler;break;case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:userDetail.oppositeUserKind==_constants.UserType.USER_TYPE_C?(this.resumeUrl="//c.liepin.com/resume/getdefaultresume/",this.name=userDetail.oppositeUserName):(userDetail.oppositeUserKind==_constants.UserType.USER_TYPE_H&&(this.resumeUrl="//h.liepin.com/resume/showresumedetail4im/?oppositeEmUserName="+targetDetail.oppositeImId),
userDetail.oppositeUserKind==_constants.UserType.USER_TYPE_B&&(this.resumeUrl="//lpt.liepin.com/resume/showresumecarte4im?usercId="+targetDetail.oppositeUserId+"&oppositeImId="+targetDetail.oppositeImId),this.name=targetDetail.oppositeUserName||targetDetail.oppositeUserNameShow);break;case _enums.ExtType.MESSAGE_SEND_RATINGBAR:break;case _enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK:this.jobId=content.ext.extBody.jobId,this.jobKind=getJobKindEnum(content.ext.extBody.jobKind),this.reason=content.ext.extBody.reason,this.title=content.ext.extBody.title,this.salary=content.ext.extBody.salary,this.jobHref=content.ext.extBody.jobHref,this.jobName=content.ext.extBody.jobName;break;case _enums.ExtType.MESSAGE_SEND_APPLYSUCFEEDBACK:this.jobId=content.ext.extBody.jobId,this.jobKind=getJobKindEnum(content.ext.extBody.jobKind),this.title=content.ext.extBody.title,this.salary=content.ext.extBody.salary,this.jobHref=content.ext.extBody.jobHref,this.jobName=content.ext.extBody.jobName;break;case _enums.ExtType.MESSAGE_SEND_NAMECARD:this.jobKind=content.ext.extBody.jobKind,this.jobId=content.ext.extBody.jobId,this.resumeUrl=LT.Env.cRoot+"resume/getdefaultresume/";break;case _enums.ExtType.MESSAGE_ASK_RESUME:this.jobId=content.ext.extBody.jobId,this.jobKind=content.ext.extBody.jobKind}return this}},{key:"fillInfo",value:function(){function fillInfo(_x){return _ref.apply(this,arguments)}var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(imcore){var info;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.prev=0,this.receiverKind==this.senderKind){_context.next=9;break}return _context.next=4,imcore.fillInfo(imcore,this,this.extBody);case 4:if(_context.t0=_context.sent,_context.t0){_context.next=7;break}_context.t0={};case 7:info=_context.t0,Object.assign(this,_extends({},info));case 9:return _context.abrupt("return",this);case 12:throw _context.prev=12,_context.t1=_context["catch"](0),imcore.handleErr(_context.t1),_context.t1;case 16:case"end":return _context.stop()}},_callee,this,[[0,12]])}));return fillInfo}()},{key:"getDetailFormat",value:function getDetailFormat(){return{id:this.id,type:this.type,extType:this.extType,from:this.from,data:this.data,to:this.to,timestamp:this.timestamp,state:this.state,name:this.name,title:this.title,company:this.company,resumeUrl:this.resumeUrl,jobId:this.jobId,jobName:this.jobName,jobHref:this.jobHref,salary:this.salary,dqName:this.dqName,sex:this.sex,dq:this.dq,workyear:this.workyear,res_edulevel:this.res_edulevel,res_id_encode:this.res_id_encode,exist:this.exist,jobKind:this.jobKind,isHandler:this.isHandler,reason:this.reason,senderKind:this.senderKind,receiverKind:this.receiverKind,messageSource:this.messageSource,visible:this.visible}}}]),HistoryMsg}()},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _Emotions,_enums2,_enums;Object.defineProperty(exports,"__esModule",{value:!0}),exports.enums=exports.Emotions=void 0,_Emotions=__webpack_require__(213),Object.defineProperty(exports,"Emotions",{enumerable:!0,get:function get(){return _Emotions.Emotions}}),_enums2=__webpack_require__(214),_enums=_interopRequireWildcard(_enums2),exports.enums=_enums},function(module,exports){"use strict";var dir,Emotions;Object.defineProperty(exports,"__esModule",{value:!0}),dir="//concat.lietou-static.com/dev/core/pc/v3/static/images/message/",Emotions=exports.Emotions={"[忧伤]":dir+"xhsemoji_1.png","[凝视]":dir+"xhsemoji_2.png","[崩溃]":dir+"xhsemoji_3.png","[晕菜]":dir+"xhsemoji_4.png","[色]":dir+"xhsemoji_5.png","[可爱]":dir+"xhsemoji_6.png","[口水]":dir+"xhsemoji_7.png","[财迷]":dir+"xhsemoji_8.png","[愤怒]":dir+"xhsemoji_9.png","[雷锋]":dir+"xhsemoji_10.png","[睡觉]":dir+"xhsemoji_11.png","[瞪眼]":dir+"xhsemoji_12.png","[如花]":dir+"xhsemoji_13.png","[得意]":dir+"xhsemoji_14.png","[疑问]":dir+"xhsemoji_15.png","[大哭]":dir+"xhsemoji_16.png","[太阳]":dir+"xhsemoji_17.png","[赞]":dir+"xhsemoji_18.png","[ok]":dir+"xhsemoji_19.png","[握手]":dir+"xhsemoji_20.png","[闭嘴]":dir+"xhsemoji_21.png","[呲牙]":dir+"xhsemoji_22.png","[干杯]":dir+"xhsemoji_23.png","[糕点]":dir+"xhsemoji_24.png","[鬼脸]":dir+"xhsemoji_25.png","[可怜]":dir+"xhsemoji_26.png","[恐惧]":dir+"xhsemoji_27.png","[冷汗]":dir+"xhsemoji_28.png","[礼物]":dir+"xhsemoji_29.png","[流泪]":dir+"xhsemoji_30.png","[卖萌]":dir+"xhsemoji_31.png","[佩服]":dir+"xhsemoji_32.png","[钱袋]":dir+"xhsemoji_33.png","[傻笑]":dir+"xhsemoji_34.png","[叹气]":dir+"xhsemoji_35.png","[微笑]":dir+"xhsemoji_36.png","[委屈]":dir+"xhsemoji_37.png","[耶]":dir+"xhsemoji_38.png","[月亮]":dir+"xhsemoji_39.png","[诅咒]":dir+"xhsemoji_40.png"}},function(module,exports){"use strict";var USER_TYPE_C,USER_TYPE_B,USER_TYPE_H,COOKIE_KEY_SETTING_MESSAGE,COOKIE_KEY_SETTING_DIALOG,DEFAULT_TOAST_TIME,HISTORY_PAGESIZE,COOKIE_KEY_SHIELD,COOKIE_KEY_DELETESHIELD,COOKIE_KEY_CUR_TAB;Object.defineProperty(exports,"__esModule",{value:!0}),USER_TYPE_C=exports.USER_TYPE_C=0,USER_TYPE_B=exports.USER_TYPE_B=1,USER_TYPE_H=exports.USER_TYPE_H=2,COOKIE_KEY_SETTING_MESSAGE=exports.COOKIE_KEY_SETTING_MESSAGE="fe_all_messageremind",COOKIE_KEY_SETTING_DIALOG=exports.COOKIE_KEY_SETTING_DIALOG="fe_all_sendmessage",DEFAULT_TOAST_TIME=exports.DEFAULT_TOAST_TIME=2500,HISTORY_PAGESIZE=exports.HISTORY_PAGESIZE=20,COOKIE_KEY_SHIELD=exports.COOKIE_KEY_SHIELD="fe_all_shield",COOKIE_KEY_DELETESHIELD=exports.COOKIE_KEY_DELETESHIELD="fe_all_deleteshield",COOKIE_KEY_CUR_TAB=exports.COOKIE_KEY_CUR_TAB="fe_all_activetab"},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}var _contacts,_contactsApi,_history,_historyApi,_message,_messageApi,_historyContacts,_historyContactsApi,_hcore,_hcoreApi;Object.defineProperty(exports,"__esModule",{value:!0}),exports.hcoreApi=exports.historyContactsApi=exports.messageApi=exports.historyApi=exports.contactsApi=void 0,_contacts=__webpack_require__(216),_contactsApi=_interopRequireWildcard(_contacts),_history=__webpack_require__(217),_historyApi=_interopRequireWildcard(_history),_message=__webpack_require__(218),_messageApi=_interopRequireWildcard(_message),_historyContacts=__webpack_require__(219),_historyContactsApi=_interopRequireWildcard(_historyContacts),_hcore=__webpack_require__(220),_hcoreApi=_interopRequireWildcard(_hcore),exports.contactsApi=_contactsApi,exports.historyApi=_historyApi,exports.messageApi=_messageApi,exports.historyContactsApi=_historyContactsApi,exports.hcoreApi=_hcoreApi},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}var _typeof,getContactList,getOneContact,simpleInfos,readed,getTotalUnread,_utils,_config,_config2,_utils2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.getTotalUnread=exports.readed=exports.simpleInfos=exports.getOneContact=exports.getContactList=void 0,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},getContactList=exports.getContactList=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(imcore,curPage){var imUserType,data,_ret,_this=this;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:imUserType=void 0,_context2.t0=imcore.env,_context2.next="c"===_context2.t0?4:"h"===_context2.t0?6:"b"===_context2.t0?8:10;break;case 4:return imUserType="0",_context2.abrupt("break",10);case 6:return imUserType="2",_context2.abrupt("break",10);case 8:return imUserType="3",_context2.abrupt("break",10);case 10:return _context2.next=12,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.mycontacts,type:"POST",data:{imUserType:imUserType,hasContact:!1,currentPage:curPage,pageSize:20,imApp:"1"}});case 12:if(data=_context2.sent,!data.flag){_context2.next=20;break}return _context2.delegateYield(regeneratorRuntime.mark(function _callee(){var userIdArr,userData,userArr;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return userIdArr=[],data.data.list.forEach(function(v,i){userIdArr.push({userId:v.oppositeUserId,userKind:v.oppositeUserKind})}),_context.next=4,simpleInfos(imcore,userIdArr);case 4:return userData=_context.sent,userArr=[],data.data.list.forEach(function(v,i){for(var m in userData)v.oppositeUserId===m&&userArr.push(Object.assign({},v,{oppositeMainUrl:userData[m].homePage||"",oppositeUserCompany:userData[m].company,oppositeUserName:userData[m].name,oppositeUserPhoto:userData[m].photo,oppositeUserTitle:userData[m].title,oppositeUserSexName:userData[m].sex||"",oppositeUserEdulevelName:userData[m].edulevel||"",oppositeWorkAge:userData[m].workage||"",oppositeUserDqName:userData[m].dq||""}))}),_context.abrupt("return",{v:userArr});case 8:case"end":return _context.stop()}},_callee,_this)})(),"t1",15);case 15:if(_ret=_context2.t1,"object"!==("undefined"==typeof _ret?"undefined":_typeof(_ret))){_context2.next=18;break}return _context2.abrupt("return",_ret.v);case 18:_context2.next=22;break;case 20:throw(0,_utils2.hKilledAccountAlert)(imcore,data),new Error(data.msg);case 22:case"end":return _context2.stop()}},_callee2,this)}));return function getContactList(_x,_x2){return _ref.apply(this,arguments)}}(),getOneContact=exports.getOneContact=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(imcore,senderInfo){var uid,contactOne,newcontact;return regeneratorRuntime.wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return uid=senderInfo.oppositeUserId,_context3.next=3,simpleInfos(imcore,[{userId:uid,userKind:senderInfo.oppositeUserKind}]);case 3:return contactOne=_context3.sent,newcontact=Object.assign({},senderInfo,{oppositeMainUrl:contactOne[uid].homePage||"",oppositeUserCompany:contactOne[uid].company,oppositeUserName:contactOne[uid].name,oppositeUserPhoto:contactOne[uid].photo,oppositeUserTitle:contactOne[uid].title,oppositeUserSexName:contactOne[uid].sex||"",oppositeUserEdulevelName:contactOne[uid].edulevel||"",oppositeWorkAge:contactOne[uid].workage||"",oppositeUserDqName:contactOne[uid].dq||""}),_context3.abrupt("return",newcontact);case 6:case"end":return _context3.stop()}},_callee3,this)}));return function getOneContact(_x3,_x4){return _ref2.apply(this,arguments)}}(),simpleInfos=exports.simpleInfos=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(imcore,userIdArr){var data;return regeneratorRuntime.wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.simpleInfos,type:"POST",data:{idsInJson:JSON.stringify(userIdArr)}});case 2:if(data=_context4.sent,!data.flag){_context4.next=7;break}return _context4.abrupt("return",data.data);case 7:throw(0,_utils2.hKilledAccountAlert)(imcore,data),new Error(data.msg);case 9:case"end":return _context4.stop()}},_callee4,this)}));return function simpleInfos(_x5,_x6){return _ref3.apply(this,arguments)}}(),readed=exports.readed=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(imcore,oppositeImId){var imUserType,data;return regeneratorRuntime.wrap(function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:imUserType=void 0,_context5.t0=imcore.env,_context5.next="c"===_context5.t0?4:"h"===_context5.t0?6:"b"===_context5.t0?8:10;break;case 4:return imUserType="0",_context5.abrupt("break",10);case 6:return imUserType="2",_context5.abrupt("break",10);case 8:return imUserType="3",_context5.abrupt("break",10);case 10:return _context5.next=12,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.readed,type:"post",data:{imUserType:imUserType,oppositeImId:oppositeImId,imClientId:imcore.userInfo.imClientId,imApp:"1"}});case 12:return data=_context5.sent,_context5.abrupt("return",data.flag);case 14:case"end":return _context5.stop()}},_callee5,this)}));return function readed(_x7,_x8){return _ref4.apply(this,arguments)}}(),getTotalUnread=exports.getTotalUnread=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee6(imcore){var imUserType,data;return regeneratorRuntime.wrap(function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:imUserType=void 0,_context6.t0=imcore.env,_context6.next="c"===_context6.t0?4:"h"===_context6.t0?6:"b"===_context6.t0?8:10;break;case 4:return imUserType="0",_context6.abrupt("break",10);case 6:return imUserType="2",_context6.abrupt("break",10);case 8:return imUserType="3",_context6.abrupt("break",10);case 10:return _context6.next=12,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.unreadcount,type:"post",data:{imUserType:imUserType,userId:imcore.userInfo.oppositeUserId,imApp:"1"}});case 12:return data=_context6.sent,_context6.abrupt("return",data);case 14:case"end":return _context6.stop()}},_callee6,this)}));return function getTotalUnread(_x9){return _ref5.apply(this,arguments)}}(),_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils2=__webpack_require__(180)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}var getHistoryFromServer,_utils,_constants,_config,_config2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.getHistoryFromServer=void 0,getHistoryFromServer=exports.getHistoryFromServer=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(imcore,oppositeImId){var imUserType,data,msgid=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,pageSize=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_constants.enums.HISTORY_PAGESIZE;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:imUserType=void 0,_context.t0=imcore.env,_context.next="c"===_context.t0?4:"h"===_context.t0?6:"b"===_context.t0?8:10;break;case 4:return imUserType="0",_context.abrupt("break",10);case 6:return imUserType="2",_context.abrupt("break",10);case 8:return imUserType="3",_context.abrupt("break",10);case 10:return _context.next=12,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.chart,type:"POST",data:{oppositeImId:oppositeImId,maxMessageId:msgid,imUserType:imUserType,pageSize:20,imApp:"1"}});case 12:if(data=_context.sent,!data.flag){_context.next=17;break}return _context.abrupt("return",data.data.list);case 17:throw new Error(data.msg);case 18:case"end":return _context.stop()}},_callee,this)}));return function getHistoryFromServer(_x,_x2){return _ref.apply(this,arguments)}}(),_utils=__webpack_require__(150),_constants=__webpack_require__(212),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function serverSendErr(imcore,_ref,state){var code=_ref.code,msg=_ref.msg;state.panel.activeContact&&("300050011"===code?_Dialog2["default"].alert({parent:"chat",width:300,content:React.createElement("p",null,"您的简历尚未完善，为了保证双方沟通效率，请先",React.createElement("a",{href:"https://c.liepin.com/resume/getdefaultresume/",target:"_blank"},"完善您的简历"))}):"300050015"===code?(window.tlog=window.tlog||[],window.tlog.push("s:S000011124"),_Dialog2["default"].confirm({parent:"chat",width:300,content:React.createElement("p",null,"请先提升职场信用分!"),onOk:function onOk(){window.tlog=window.tlog||[],window.tlog.push("c:C000011125"),window.location.href="https://c.liepin.com/resume/getdefaultresume/"}})):"300050017"===code?(window.tlog=window.tlog||[],window.tlog.push("s:S000011126"),_Dialog2["default"].confirm({parent:"chat",width:300,content:React.createElement("p",null,msg),onOk:function onOk(){window.location.href="https://c.liepin.com/profile/getsecret/"}})):"300330003"===code?_Dialog2["default"].confirm({parent:"chat",width:300,content:React.createElement("p",null,msg),onOk:function onOk(){location.reload()}}):_Dialog2["default"].alert({parent:"chat",width:300,text:msg}))}function checkIfCansend(imcore,contact,inBlack){if(inBlack&&contact.oppositeUserKind!=_constants.UserType.USER_TYPE_B){var dialogText=void 0;return"c"===imcore.env?contact.oppositeUserKind==_constants.UserType.USER_TYPE_C?dialogText="互为好友即可发送消息，请先添加好友！":contact.oppositeUserKind==_constants.UserType.USER_TYPE_H&&(dialogText="该猎头顾问已被屏蔽，操作已被限制！"):"b"===imcore.env&&(dialogText="您将该候选人屏蔽了，无法发送消息！"),_Dialog2["default"].alert({parent:"chat",width:300,text:dialogText}),!1}return!0}var _utils,_config,_config2,_constants,_Dialog,_Dialog2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.serverSendErr=serverSendErr,exports.checkIfCansend=checkIfCansend,_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_constants=__webpack_require__(156),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}var _typeof,getHistoryContactsAjax,_utils,_config,_config2,_utils2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.getHistoryContactsAjax=void 0,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},getHistoryContactsAjax=exports.getHistoryContactsAjax=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(imcore,curPage){var data,_ret;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.gethistorycontactlist,data:{curPage:curPage}});case 2:if(data=_context.sent,!data.flag){_context.next=9;break}if(_ret=function(){var newJson={};return newJson.curMonthContacts=[],newJson.earlierContacts=[],data.data.curMonthContacts&&data.data.curMonthContacts.forEach(function(v,i){newJson.curMonthContacts.push(Object.assign({},v,{oppositeMainUrl:v.homePage,oppositeUserCompany:v.company,oppositeUserName:v.name,oppositeUserPhoto:v.photo,oppositeUserTitle:v.title,oppositeUserSexName:v.sex,oppositeUserEdulevelName:v.edulevel,oppositeWorkAge:v.workage,oppositeUserDqName:v.dq}))}),data.data.earlierContacts&&data.data.earlierContacts.forEach(function(v,i){newJson.earlierContacts.push(Object.assign({},v,{oppositeMainUrl:v.homePage,oppositeUserCompany:v.company,oppositeUserName:v.name,oppositeUserPhoto:v.photo,oppositeUserTitle:v.title,oppositeUserSexName:v.sex,oppositeUserEdulevelName:v.edulevel,oppositeWorkAge:v.workage,oppositeUserDqName:v.dq}))}),{v:newJson}}(),"object"!==("undefined"==typeof _ret?"undefined":_typeof(_ret))){_context.next=7;break}return _context.abrupt("return",_ret.v);case 7:_context.next=11;break;case 9:throw(0,_utils2.hKilledAccountAlert)(imcore,data),new Error(data.msg);case 11:case"end":return _context.stop()}},_callee,this)}));return function getHistoryContactsAjax(_x,_x2){return _ref.apply(this,arguments)}}(),_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils2=__webpack_require__(180)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}var isAttention,_utils,_enums,_config,_config2,_utils2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.isAttention=void 0,isAttention=exports.isAttention=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(imcore,oppositeImId){var data;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.getonecontactotherinfo,type:"post",data:{oppositeImId:oppositeImId}});case 3:if(data=_context.sent,!data.flag){_context.next=8;break}return _context.abrupt("return",data.data);case 8:(0,_utils2.hKilledAccountAlert)(imcore,data);case 9:_context.next=14;break;case 11:_context.prev=11,_context.t0=_context["catch"](0),imcore.handleErr(_context.t0);case 14:case"end":return _context.stop()}},_callee,this,[[0,11]])}));return function isAttention(_x,_x2){return _ref.apply(this,arguments)}}(),_utils=__webpack_require__(150),_enums=__webpack_require__(162),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils2=__webpack_require__(180)},function(module,exports,__webpack_require__){"use strict";function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _objectWithoutProperties(obj,keys){var i,target={};for(i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function createSendMsg(_ref){var msg,from=_ref.from,to=_ref.to,_ref$data=_ref.data,data=void 0===_ref$data?"":_ref$data,_ref$dataType=_ref.dataType,dataType=void 0===_ref$dataType?"txt":_ref$dataType,_ref$extType=_ref.extType,extType=void 0===_ref$extType?1:_ref$extType,others=_objectWithoutProperties(_ref,["from","to","data","dataType","extType"]);if(!from||!to)return void console.log("from or to should not be empty!");switch(msg=void 0,dataType){case"img":return msg=new ImgMsg,msg.set(_extends({from:from,to:to,data:data,extType:1,dataType:"img"},others));default:return msg=new TxtMsg,msg.set({from:from,to:to,data:data,extType:extType,dataType:"txt"})}}function createSendMsgByPlainMsg(message){var msg=void 0;switch(message.type){case"img":return msg=new ImgMsg,msg.setByPlainMsg(message);default:return msg=new TxtMsg,msg.setByPlainMsg(message)}}function uuid(id){var cdate,offdate,offset,hexd,random;return id?id:(cdate=new Date,offdate=new Date(2010,1,1),offset=cdate.getTime()-offdate.getTime(),hexd=parseInt(offset).toString(16),random=(""+Math.random()).replace(/\./,"_"),"LP_WEBIM_"+hexd+"_"+random)}var _get,_createClass,_extends,_enums,_constants,_utils,getFileUrl,Msg,ImgMsg,TxtMsg;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TxtMsg=exports.ImgMsg=exports.Msg=void 0,_get=function get(object,property,receiver){var desc,parent,getter;return null===object&&(object=Function.prototype),desc=Object.getOwnPropertyDescriptor(object,property),void 0===desc?(parent=Object.getPrototypeOf(object),null===parent?void 0:get(parent,property,receiver)):"value"in desc?desc.value:(getter=desc.get,void 0!==getter?getter.call(receiver):void 0)},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports.createSendMsg=createSendMsg,exports.createSendMsgByPlainMsg=createSendMsgByPlainMsg,_enums=__webpack_require__(162),_constants=__webpack_require__(156),_utils=__webpack_require__(150),getFileUrl=WebIM.utils.getFileUrl,Msg=exports.Msg=function(){function Msg(){return _classCallCheck(this,Msg),this}return _createClass(Msg,[{key:"set",value:function set(_ref2){var from=_ref2.from,to=_ref2.to,data=_ref2.data,extType=_ref2.extType,dataType=_ref2.dataType,id=_ref2.id;return this.id=uuid(id),this.type=dataType,this.state=_enums.MsgState.INITIAL,this.msgBody={id:this.id,type:this.type,from:from.oppositeImId,fromtype:from.oppositeImUserType,to:to.oppositeImId,totype:to.oppositeImUserType,timestamp:Date.now(),ext:{id:this.id,extType:extType,extBody:{messageSource:_constants.MESSAGE_SOURCE,senderUserId:from.oppositeUserId,senderKind:from.oppositeUserKind,receiverUserId:to.oppositeUserId,receiverKind:to.oppositeUserKind,sign:"1"}}},this}},{key:"setByPlainMsg",value:function setByPlainMsg(message){return Object.assign(this,message)}},{key:"reset",value:function reset(){return this.id=this.msgBody.id=this.msgBody.ext.id=uuid(this.id||""),this.state=_enums.MsgState.INITIAL,this.setSign(""),this.status=this.status,this}},{key:"setSign",value:function setSign(sign){return this.msgBody.ext.extBody.sign=sign,this}},{key:"getSign",value:function getSign(){return this.msgBody&&this.msgBody.ext&&this.msgBody.extBody&&this.msgBody.ext.extBody.sign}},{key:"onSuccess",value:function onSuccess(func){return"function"==typeof func&&(this.msgBody.success=func),this}},{key:"onFail",value:function onFail(func){return"function"==typeof func&&(this.msgBody.fail=func),this}},{key:"getTo",value:function getTo(){return this.msgBody.to}},{key:"getFrom",value:function getFrom(){return this.msgBody.from}},{key:"getValue",value:function getValue(){return this.value}},{key:"getParamForSign",value:function getParamForSign(){var jobId=this.fillInfo?this.fillInfo.jobId:"";return this.getExtType()===_enums.ExtType.MESSAGE_SEND_JOB?jobId:""}},{key:"getType",value:function getType(){return this.type}},{key:"getExtType",value:function getExtType(){return this.msgBody.ext.extType}},{key:"getTimestamp",value:function getTimestamp(){return this.msgBody.timestamp}},{key:"setState",value:function setState(state){var err=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return state&&(this.state=state),this.err=err,this}},{key:"setServerId",value:function setServerId(serverId){return this.msgBody.id=serverId,this.msgBody.ext.id=serverId,this}},{key:"getBody",value:function getBody(){return this.msgBody}},{key:"getPublish",value:function getPublish(){return"img"===this.type?Object.assign({},this,{file:null,fileInput:null,fileInputId:null,onFileUploadComplete:null,onFileUploadError:null,onFileAppend:null}):this}},{key:"getStorageBody",value:function getStorageBody(){var msgBody=this.msgBody;return Object.assign({id:this.id,from:msgBody.from,to:msgBody.to,ext:msgBody.ext,state:this.state,err:this.err,type:this.type,timestamp:msgBody.timestamp,read:!0,data:this.value,status:this.status,serverId:this.msgBody.ext.id,extType:this.msgBody.ext.extType,totype:this.msgBody.totype,sign:this.msgBody.ext.extBody.sign},this.fillInfo)}},{key:"getLastMsgFormat",value:function getLastMsgFormat(){var content={ext:{extType:this.msgBody.ext.extType,extBody:this.msgBody.ext.extBody},bodies:[{msg:this.value,type:this.type}]};return{latestMsgId:"",lastPayload:JSON.stringify(content),latestMsgTime:this.getTimestamp()}}},{key:"getSaveFormat",value:function getSaveFormat(serverId){var fmt={from:this.msgBody.from,to:this.msgBody.to,bodies:[{type:this.type}],ext:{extType:this.msgBody.ext.extType,extBody:_extends({},this.msgBody.ext.extBody,{saveStatus:"2"})},emMessageId:serverId};return"img"==this.type?fmt.bodies[0].url=this.value:fmt.bodies[0].msg=this.value,fmt}}]),Msg}(),ImgMsg=exports.ImgMsg=function(_Msg){function ImgMsg(){var _ret,_this;return _classCallCheck(this,ImgMsg),_this=_possibleConstructorReturn(this,(ImgMsg.__proto__||Object.getPrototypeOf(ImgMsg)).call(this)),_ret=_this,_possibleConstructorReturn(_this,_ret)}return _inherits(ImgMsg,_Msg),_createClass(ImgMsg,[{key:"set",value:function set(_ref3){var file,from=_ref3.from,to=_ref3.to,data=_ref3.data,_ref3$onFileUploadErr=_ref3.onFileUploadError,onFileUploadError=void 0===_ref3$onFileUploadErr?_utils.emptyFn:_ref3$onFileUploadErr,_ref3$onFileUploadCom=_ref3.onFileUploadComplete,onFileUploadComplete=void 0===_ref3$onFileUploadCom?_utils.emptyFn:_ref3$onFileUploadCom,_ref3$onFileAppend=_ref3.onFileAppend,onFileAppend=void 0===_ref3$onFileAppend?_utils.emptyFn:_ref3$onFileAppend;_get(ImgMsg.prototype.__proto__||Object.getPrototypeOf(ImgMsg.prototype),"set",this).call(this,{from:from,to:to,data:data,extType:1,dataType:"img"}),file=data.file||WebIM.utils.getFileUrl(data.fileInputId),this.msgBody.flashUpload=data.flashUpload,this.msgBody.file=file,this.onFileUploadError=onFileUploadError,this.onFileUploadComplete=onFileUploadComplete,this.onFileAppend=onFileAppend,this.filename=file.filename,this.fileInputId=data.fileInputId,this.file=file}},{key:"setData",value:function setData(data){this.value=data}}]),ImgMsg}(Msg),TxtMsg=exports.TxtMsg=function(_Msg2){function TxtMsg(){var _ret2,_this2;return _classCallCheck(this,TxtMsg),_this2=_possibleConstructorReturn(this,(TxtMsg.__proto__||Object.getPrototypeOf(TxtMsg)).call(this)),_ret2=_this2,_possibleConstructorReturn(_this2,_ret2)}return _inherits(TxtMsg,_Msg2),_createClass(TxtMsg,[{key:"set",value:function set(_ref4){var userId,rest,from=_ref4.from,to=_ref4.to,data=_ref4.data,_ref4$extType=_ref4.extType,extType=void 0===_ref4$extType?1:_ref4$extType,others=_objectWithoutProperties(_ref4,["from","to","data","extType"]);switch(_get(TxtMsg.prototype.__proto__||Object.getPrototypeOf(TxtMsg.prototype),"set",this).call(this,{
from:from,to:to,extType:extType,dataType:"txt"}),this.value=this.msgBody.msg="string"==typeof data?data:"",extType){case _enums.ExtType.MESSAGE_RESUME:userId=others.userId,rest=_objectWithoutProperties(others,["userId"]),this.msgBody.ext.extBody.userInfo={userId:others.userId},this.fillInfo=rest;break;case _enums.ExtType.MESSAGE_SEND_JOB:this.fillInfo=others,this.msgBody.ext.extBody.jobKind=others.jobKind,this.msgBody.ext.extBody.jobId=others.jobId;break;case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:this.fillInfo=others,this.msgBody.ext.extBody.jobId=others.jobId;break;case _enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK:this.fillInfo=others,this.msgBody.ext.extBody.jobKind=others.jobKind,this.msgBody.ext.extBody.jobId=others.jobId,this.msgBody.ext.extBody.reason=others.reason;break;case _enums.ExtType.MESSAGE_SEND_NAMECARD:this.msgBody.ext.extBody.jobId=others.jobId,this.msgBody.ext.extBody.jobKind=others.jobKind,this.fillInfo=others;break;case _enums.ExtType.MESSAGE_ASK_RESUME:this.msgBody.ext.extBody.jobId=others.jobId,this.msgBody.ext.extBody.jobKind=others.jobKind;break;case _enums.ExtType.MESSAGE_SEND_TOOLTIP:}}}]),TxtMsg}(Msg)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function getHistoryContactsList(imcore,hasConnect,fristLoad){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){var state,newPageList,curPage,pageList;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(state=getState().historyContacts,!state.loading&&!state.nomore){_context.next=3;break}return _context.abrupt("return");case 3:return dispatch({type:ActionType.GET_HISTORYCONTACTS_START,payload:{loading:!0}}),_context.prev=4,newPageList=[],curPage=0,hasConnect||(curPage=state.curPage),_context.next=10,_api.historyContactsApi.getHistoryContactsAjax(imcore,curPage);case 10:if(pageList=_context.sent,!pageList.curMonthContacts&&(pageList.curMonthContacts=[]),!pageList.earlierContacts&&(pageList.earlierContacts=[]),hasConnect?(newPageList.curMonthContacts=pageList.curMonthContacts,newPageList.earlierContacts=pageList.earlierContacts):(newPageList.curMonthContacts=state.curMonthContacts.concat(pageList.curMonthContacts),newPageList.earlierContacts=state.earlierContacts.concat(pageList.earlierContacts)),(0,_utils2.publish)(imcore,dispatch,{type:ActionType.GET_HISTORYCONTACTS_SUCC,payload:{curMonthContacts:newPageList.curMonthContacts,earlierContacts:newPageList.earlierContacts,loading:!1,curPage:curPage+1,nomore:pageList.curMonthContacts.length+pageList.earlierContacts.length===0,firstLoaded:!0}}),!fristLoad){_context.next=17;break}return _context.abrupt("return",{curMonthContacts:newPageList.curMonthContacts,earlierContacts:newPageList.earlierContacts,loading:!1,curPage:curPage+1,nomore:pageList.curMonthContacts.length+pageList.earlierContacts.length===0,firstLoaded:!0});case 17:_context.next=22;break;case 19:_context.prev=19,_context.t0=_context["catch"](4),dispatch({type:ActionType.GET_HISTORYCONTACTS_FAIL,payload:{loading:!1}});case 22:case"end":return _context.stop()}},_callee,_this,[[4,19]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}function changeContactsBySendMsg(imcore,msg){var _this2=this;return function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(dispatch,getState){var state,contact;return regeneratorRuntime.wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(state=getState(),contact=[],getState().historyContacts.firstLoaded&&msg.state!==_enums.MsgState.SEND_FAILED){_context3.next=3;break}return _context3.abrupt("return");case 3:if(state.panel.activeContact){_context3.next=7;break}return _context3.delegateYield(regeneratorRuntime.mark(function _callee2(){var receiver,senderInfo;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(receiver=msg.msgBody.to,senderInfo={oppositeUserId:msg.msgBody.ext.extBody.receiverUserId,oppositeUserKind:msg.msgBody.ext.extBody.receiverKind},contact=state.historyContacts.curMonthContacts.concat(state.historyContacts.earlierContacts).filter(function(v){return v.oppositeImId===receiver}),0!==contact.length){_context2.next=11;break}return _context2.next=6,_api.contactsApi.getOneContact(imcore,senderInfo);case 6:contact=_context2.sent,msg.oppositeImId=msg.msgBody.to,contact=_extends({},msg,contact,{unReadCnt:0}),_context2.next=12;break;case 11:contact=_extends({},msg,contact[0],{unReadCnt:0});case 12:case"end":return _context2.stop()}},_callee2,_this2)})(),"t0",5);case 5:_context3.next=9;break;case 7:contact=getState().panel.activeContact,contact=_extends({},msg,contact,{unReadCnt:0});case 9:(0,_utils2.publish)(imcore,dispatch,{type:ActionType.UPDATE_HISTORYCONTACTS_BY_SEND_MSG,payload:{lastMsg:msg.getLastMsgFormat(),contact:contact}});case 10:case"end":return _context3.stop()}},_callee3,_this2)}));return function(_x3,_x4){return _ref2.apply(this,arguments)}}()}function changeContactsByReceiveMsg(imcore,msg){var _this3=this;return function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(dispatch,getState){var _ret2;return regeneratorRuntime.wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(_context4.prev=0,_ret2=function(){var state=getState(),sender=msg.getFrom(),senderInfo=msg.getOppositeUserInfo(imcore),receiver=msg.getTo(),unReadCnt=0,isfirstLost=!0,newcontact=void 0;return sender===imcore.userInfo.oppositeImId&&(sender=receiver),state.panel.activeContact&&state.panel.activeContact.oppositeImId===sender?(unReadCnt=0,(0,_utils2.publish)(imcore,dispatch,{type:ActionType.UPDATE_CONTACTS_BY_RECEIVE_MSG,payload:Object.assign(state.panel.activeContact,msg.getLastMsgFormat(),{unReadCnt:unReadCnt})}),(0,_utils2.publish)(imcore,dispatch,{type:ActionType.UPDATE_HISTORYCONTACTS_BY_RECEIVE_MSG,payload:Object.assign(state.panel.activeContact,msg.getLastMsgFormat(),{unReadCnt:unReadCnt})}),{v:void 0}):(newcontact=state.historyContacts.curMonthContacts.concat(state.historyContacts.earlierContacts).filter(function(v){return v.oppositeImId===sender}),void(0===newcontact.length||(unReadCnt=msg.getFrom()===imcore.userInfo.oppositeImId?0:newcontact[0].unReadCnt+1,(0,_utils2.publish)(imcore,dispatch,{type:ActionType.UPDATE_HISTORYCONTACTS_BY_RECEIVE_MSG,payload:Object.assign(newcontact[0],msg.getLastMsgFormat(),{unReadCnt:unReadCnt})}))))}(),"object"!==("undefined"==typeof _ret2?"undefined":_typeof(_ret2))){_context4.next=4;break}return _context4.abrupt("return",_ret2.v);case 4:_context4.next=9;break;case 6:_context4.prev=6,_context4.t0=_context4["catch"](0),imcore.handleErr(_context4.t0);case 9:case"end":return _context4.stop()}},_callee4,_this3,[[0,6]])}));return function(_x5,_x6){return _ref3.apply(this,arguments)}}()}var _typeof,_extends,_constants,_enums,_utils,_config,_config2,_ActionType,ActionType,_contacts,contactsActions,_panel,panelActions,_api,_utils2;Object.defineProperty(exports,"__esModule",{value:!0}),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports.getHistoryContactsList=getHistoryContactsList,exports.changeContactsBySendMsg=changeContactsBySendMsg,exports.changeContactsByReceiveMsg=changeContactsByReceiveMsg,_constants=__webpack_require__(156),_enums=__webpack_require__(162),_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_contacts=__webpack_require__(175),contactsActions=_interopRequireWildcard(_contacts),_panel=__webpack_require__(174),panelActions=_interopRequireWildcard(_panel),_api=__webpack_require__(215),_utils2=__webpack_require__(180)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function getNoticeList(imcore,isNewSys){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){var state,curPage,data,sysList,newSysList;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.prev=0,state=getState().notice,!state.loading&&!state.nomoreNotice){_context.next=4;break}return _context.abrupt("return");case 4:return dispatch({type:ActionType.GET_NOTICELIST_START,payload:{loading:!0}}),curPage=state.curPage,_context.next=8,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.getsysmsglist4im+"?curPage="+curPage});case 8:data=_context.sent,data.flag?(sysList=data.data.sysMsgList,newSysList=[],newSysList=isNewSys?sysList:state.sysMsgList.concat(sysList),dispatch({type:ActionType.GET_NOTICELIST_SUCC,payload:{sysMsgList:newSysList,totalCnt:data.data.totalCnt,curPage:curPage+1,loading:!1,nomoreNotice:0===sysList.length,firstLoaded:!0}})):dispatch({type:ActionType.GET_NOTICELIST_FAIL,payload:{loading:!1,failMsg:data.msg}}),_context.next=16;break;case 12:_context.prev=12,_context.t0=_context["catch"](0),dispatch({type:ActionType.GET_NOTICELIST_FAIL,payload:{loading:!1}}),imcore.handleErr(_context.t0);case 16:case"end":return _context.stop()}},_callee,_this,[[0,12]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}function deleteNoticeItem(imcore,id,type){var _this2=this;return function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(dispatch,getState){var data;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.delsysmessagebyid+"?msgid="+id+"&messageType="+type});case 3:data=_context2.sent,data.flag&&dispatch({type:ActionType.DELETE_NOTICEITEM,payload:id}),_context2.next=10;break;case 7:_context2.prev=7,_context2.t0=_context2["catch"](0),imcore.handleErr(_context2.t0);case 10:case"end":return _context2.stop()}},_callee2,_this2,[[0,7]])}));return function(_x3,_x4){return _ref2.apply(this,arguments)}}()}function hasReadNotice(imcore,notice,index){var _this3=this;return function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(dispatch,getState){var data;return regeneratorRuntime.wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.prev=0,_context3.next=3,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.readedmessagebyid+"?msgid="+notice.id+"&messageType="+notice.type});case 3:data=_context3.sent,data.flag&&dispatch({type:ActionType.HASREAD_NOTICE,payload:{index:index,id:notice.id}}),_context3.next=10;break;case 7:_context3.prev=7,_context3.t0=_context3["catch"](0),imcore.handleErr(_context3.t0);case 10:case"end":return _context3.stop()}},_callee3,_this3,[[0,7]])}));return function(_x5,_x6){return _ref3.apply(this,arguments)}}()}function showNoticeTabUnread(imcore){return function(dispatch,getState){var state=getState();state.panel.opened&&"notice"===state.panel.activeTab.key||(dispatch(panelActions.setUnReadTabsToLocal(imcore,"notice",!0)),dispatch(panelActions.setPanelUnReadToLocal(imcore,!0)))}}var _utils,_config,_config2,_ActionType,ActionType,_panel,panelActions;Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNoticeList=getNoticeList,exports.deleteNoticeItem=deleteNoticeItem,exports.hasReadNotice=hasReadNotice,exports.showNoticeTabUnread=showNoticeTabUnread,_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_panel=__webpack_require__(174),panelActions=_interopRequireWildcard(_panel)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function getSnsList(imcore){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){var data,snsData;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.snsList});case 3:data=_context.sent,data.flag&&(snsData=[[{txt:"我的好友",url:"https://c.liepin.com/connection/connectionlistforc/",count:data.data.friendCnt,icon:"person"},{txt:"我的粉丝",url:"https://c.liepin.com/connection/fans/",count:data.data.myFansCnt,icon:"person"},{txt:"我的关注",url:"https://c.liepin.com/connection/follows/",count:data.data.myFollowCnt,icon:"concern"}],[{txt:"我关注的猎头",url:"https://c.liepin.com/connection/connectionlistforh/?direction=out",count:data.data.followingHCnt,icon:"person-arr"},{txt:"关注我的猎头",url:"https://c.liepin.com/connection/connectionlistforh/?direction=in",count:data.data.followHCnt,icon:"person-arrow"}],[{txt:"我关注的公司",url:"https://c.liepin.com/connection/connectionlistfore/?direction=out",count:data.data.followBCnt,icon:"building"}]],dispatch({type:ActionType.SELECT_SNS,payload:snsData})),_context.next=10;break;case 7:_context.prev=7,_context.t0=_context["catch"](0),imcore.handleErr(_context.t0);case 10:case"end":return _context.stop()}},_callee,_this,[[0,7]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}var _utils,_config,_config2,_ActionType,ActionType;Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSnsList=getSnsList,_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function inBlackStatusAjax(imcore,activeContact){var data={};return"c"===imcore.env?data={targetUserId:activeContact.oppositeUserId}:"b"===imcore.env&&(data={usercId:activeContact.oppositeUserId}),(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.infoBetweenUsers,type:"post",data:data})}function openDialog(){return function(dispatch,getState){dispatch({type:ActionType.INBLACK_DIALOG,payload:!0})}}function closeDialog(){return function(dispatch,getState){dispatch({type:ActionType.INBLACK_DIALOG,payload:!1})}}function addBlack(imcore,activeContact,inBlack,callback){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){var userId,cookie,ajaxData,url,data;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,userId=activeContact.oppositeUserId,cookie=!!LT.Cookie.get(_constants.enums.COOKIE_KEY_SHIELD)&&eval(LT.Cookie.get(_constants.enums.COOKIE_KEY_SHIELD)),ajaxData={},url=void 0,"c"===imcore.env?activeContact.oppositeUserKind==_constants2.UserType.USER_TYPE_C?(url=(0,_config2["default"])(imcore.env).urls.addCBl,ajaxData={usercId:userId}):activeContact.oppositeUserKind==_constants2.UserType.USER_TYPE_H&&(url=(0,_config2["default"])(imcore.env).urls.aadduserhblacklist,ajaxData={userHId:userId}):"b"===imcore.env&&(url=(0,_config2["default"])(imcore.env).urls.rejectreceivemsg,ajaxData={usercId:userId}),_context.next=5,(0,_utils.pajax)({url:url,type:"post",data:ajaxData});case 5:data=_context.sent,data.flag?((0,_utils2.publish)(imcore,dispatch,{type:ActionType.INBLACK_DIALOG,payload:!1}),callback&&callback(),_Dialog2["default"].alert({parent:"chat",text:"屏蔽成功！"})):(dispatch({type:ActionType.INBLACK_DIALOG,payload:!1}),_Dialog2["default"].alert({parent:"chat",text:data.msg})),_context.next=12;break;case 9:_context.prev=9,_context.t0=_context["catch"](0),imcore.handleErr(_context.t0);case 12:case"end":return _context.stop()}},_callee,_this,[[0,9]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}function removeBlack(imcore,activeContact,inBlack,callback){var _this2=this;return function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(dispatch,getState){var userId,ajaxData,url,data;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,userId=activeContact.oppositeUserId,ajaxData={},url=void 0,"c"===imcore.env?activeContact.oppositeUserKind==_constants2.UserType.USER_TYPE_C?(url=(0,_config2["default"])(imcore.env).urls.removeCBl,ajaxData={usercId:userId}):activeContact.oppositeUserKind==_constants2.UserType.USER_TYPE_H&&(url=(0,_config2["default"])(imcore.env).urls.removeuserhblacklist,ajaxData={userHId:userId}):"b"===imcore.env&&(url=(0,_config2["default"])(imcore.env).urls.cancelrejectreceivemsg,ajaxData={usercId:userId}),(0,_utils2.publish)(imcore,dispatch,{type:ActionType.INBLACK_DIALOG,payload:!1}),_context2.next=6,(0,_utils.pajax)({url:url,type:"post",data:ajaxData});case 6:data=_context2.sent,data.flag?(callback&&callback(),_Dialog2["default"].alert({parent:"chat",text:"已解除屏蔽！"})):_Dialog2["default"].alert({parent:"chat",text:data.msg}),_context2.next=13;break;case 10:_context2.prev=10,_context2.t0=_context2["catch"](0),imcore.handleErr(_context2.t0);case 13:case"end":return _context2.stop()}},_callee2,_this2,[[0,10]])}));return function(_x3,_x4){return _ref2.apply(this,arguments)}}()}function changeText(imcore,inBlack){return function(dispatch,getState){(0,_utils2.publish)(imcore,dispatch,{type:ActionType.INBLACK_DIALOG,payload:!1}),(0,_utils2.publish)(imcore,dispatch,{type:ActionType.INBLACK_STATUS,payload:!inBlack})}}var _utils,_config,_config2,_ActionType,ActionType,_constants,_constants2,_Dialog,_Dialog2,_utils2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.inBlackStatusAjax=inBlackStatusAjax,exports.openDialog=openDialog,exports.closeDialog=closeDialog,exports.addBlack=addBlack,exports.removeBlack=removeBlack,exports.changeText=changeText,_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_constants=__webpack_require__(212),_constants2=__webpack_require__(156),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog),_utils2=__webpack_require__(180)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function setReport(code){return function(dispatch,getState){dispatch({type:ActionType.REPORT_CODE,payload:code})}}function showReportDialog(){return function(dispatch,getState){dispatch({type:ActionType.REPORT_CODE,payload:5}),dispatch({type:ActionType.REPORT_DIALOG,payload:!0})}}function closeReportDialog(callback){return function(dispatch,getState){dispatch({type:ActionType.REPORT_DIALOG,payload:!1}),callback&&callback()}}function addReport(imcore,activeContact,code,msgList,callback){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(dispatch,getState){return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.delegateYield(regeneratorRuntime.mark(function _callee(){var userInfo,list,arr,data;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return userInfo=imcore.userInfo,list=msgList.filter(function(v){return v.data}),arr=[],list.slice(list.length-10).forEach(function(v,i){var str="";str+=v.from===userInfo.oppositeImId?userInfo.oppositeUserName+":":activeContact.oppositeUserName+":","img"===v.type?str+='<img src="'+v.data+'" />':"txt"===v.type&&(str+=v.data),arr.push(encodeURIComponent(str))}),_context.next=6,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.reportChat,type:"post",data:{targetUserId:activeContact.oppositeUserId,reportCode:code,msgsStr:arr.join(",")}});case 6:data=_context.sent,data.flag?(dispatch({type:ActionType.REPORT_DIALOG,payload:!1}),_Dialog2["default"].alert({parent:"chat",onOk:function onOk(){callback&&callback()},width:300,content:React.createElement("p",{className:"text-center"},"感谢您的举报，我会尽快处理！")})):_Dialog2["default"].alert({parent:"chat",text:data.msg});case 8:case"end":return _context.stop()}},_callee,_this)})(),"t0",2);case 2:_context2.next=7;break;case 4:_context2.prev=4,_context2.t1=_context2["catch"](0),imcore.handleErr(_context2.t1);case 7:case"end":return _context2.stop()}},_callee2,_this,[[0,4]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}var _utils,_config,_config2,_ActionType,ActionType,_constants,_constants2,_Dialog,_Dialog2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.setReport=setReport,exports.showReportDialog=showReportDialog,exports.closeReportDialog=closeReportDialog,exports.addReport=addReport,_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_constants=__webpack_require__(212),_constants2=__webpack_require__(156),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function greetingShow(show){return function(dispatch,getState){dispatch({type:ActionType.OPEN_SETGREETING,payload:show})}}function greetingStatus(imcore){return function(dispatch,getState){return"c"==imcore.env&&void dispatch({type:ActionType.SELECT_GREETING,payload:{greetingType:imcore.userInfo.chatSetting.sayHiType,greetingText:imcore.userInfo.chatSetting.sayHiText}})}}function greetingList(imcore){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){var data;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if("c"==imcore.env){_context.next=2;break}return _context.abrupt("return",!1);case 2:return _context.prev=2,_context.next=5,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.getHiList});case 5:data=_context.sent,data.flag&&dispatch({type:ActionType.SETGREETING_LIST,payload:data.data}),_context.next=12;break;case 9:_context.prev=9,_context.t0=_context["catch"](2),imcore.handleErr(_context.t0);case 12:case"end":return _context.stop()}},_callee,_this,[[2,9]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}function selectGreeting(imcore,code,name,greeting){var _this2=this;return function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(dispatch,getState){var data;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.saveChatSetting,type:"post",data:{sayHi:greeting,sayHiType:code}});case 3:data=_context2.sent,data.flag&&(0,_utils2.publish)(imcore,dispatch,{type:ActionType.SELECT_GREETING,payload:{greetingType:code,greetingText:name}}),_context2.next=10;break;case 7:_context2.prev=7,_context2.t0=_context2["catch"](0),imcore.handleErr(_context2.t0);case 10:case"end":return _context2.stop()}},_callee2,_this2,[[0,7]])}));return function(_x3,_x4){return _ref2.apply(this,arguments)}}()}var _utils,_config,_config2,_ActionType,ActionType,_constants,_utils2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.greetingShow=greetingShow,exports.greetingStatus=greetingStatus,exports.greetingList=greetingList,exports.selectGreeting=selectGreeting,_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_constants=__webpack_require__(212),_utils2=__webpack_require__(180)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function dragDistance(_ref){var _ref$distanceX=_ref.distanceX,distanceX=void 0===_ref$distanceX?0:_ref$distanceX,_ref$distanceY=_ref.distanceY,distanceY=void 0===_ref$distanceY?0:_ref$distanceY;return function(dispatch,getState){var wh=$(window).height(),ww=$(window).width(),top=Math.max(0,getState().drag.top+distanceY),right=Math.max(0,getState().drag.right-distanceX);right>ww-threshold.right&&(right=ww-threshold.right),top>wh-threshold.top&&(top=wh-threshold.top),dispatch({type:ActionType.DRAG_DISTANCE,payload:{top:top,right:right}})}}function dragWindowResize(){return function(dispatch,getState){var wh=$(window).height(),ww=$(window).width(),top=getState().drag.top,right=getState().drag.right;right>ww-threshold.right&&(right=ww-threshold.right),top>wh-threshold.top&&(top=wh-threshold.top),dispatch({type:ActionType.DRAG_DISTANCE,payload:{top:top,right:right}})}}var _ActionType,ActionType,threshold;Object.defineProperty(exports,"__esModule",{value:!0}),exports.dragDistance=dragDistance,exports.dragWindowResize=dragWindowResize,_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),threshold={top:120,right:380}},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function openDialog(){var parent=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"panel",content=arguments[1],payload={};return"panel"===parent?payload={panelVisible:!0,panelContent:content}:"chat"===parent&&(payload={chatVisible:!0,chatContent:content}),{type:ActionType.OPEN_DIALOG,payload:payload}}function closeDialog(){var parent=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"panel",payload={};return"panel"===parent?payload={panelVisible:!1,panelContent:null}:"chat"===parent&&(payload={chatVisible:!1,chatContent:null}),{type:ActionType.CLOSE_DIALOG,payload:payload}}var _ActionType,ActionType;Object.defineProperty(exports,"__esModule",{value:!0}),exports.openDialog=openDialog,exports.closeDialog=closeDialog,_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function sendMsg(imcore,msg){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},cb=arguments[3];return function(dispatch,getState){var contact,inBlack=options.inBlack,_options$cansendErrMs=options.cansendErrMsg,cansendErrMsg=void 0===_options$cansendErrMs?"":_options$cansendErrMs,_options$checkFirst=options.checkFirst,checkFirst=void 0===_options$checkFirst||_options$checkFirst,_options$success=options.success,success=void 0===_options$success?function(){}:_options$success,_options$fail=options.fail,fail=void 0===_options$fail?function(){
"img"===msg.type&&(cb&&cb(),_Dialog2["default"].alert({parent:"chat",width:300,content:React.createElement("p",{className:"text-center"},"图片上传失败，请刷新页面重试")}),dispatch({type:ActionType.SEND_IMG_FAIL,payload:{fileRefresh:!0,pictureDom:null}}))}:_options$fail;checkFirst?(inBlack=void 0===inBlack?getState().shield.inBlack:inBlack,contact=getState().panel.activeContact,_api.messageApi.checkIfCansend(imcore,contact,inBlack)&&(msg.status=!0,msg.isClick=!0,imcore.send(msg,success,fail,function(_ref){var code=_ref.code,msg=_ref.msg;_api.messageApi.serverSendErr(imcore,{code:code,msg:msg},getState())}))):imcore.send(msg,success,fail,function(_ref2){var code=_ref2.code,msg=_ref2.msg;_api.messageApi.serverSendErr(imcore,{code:code,msg:msg},getState())})}}function resendMsg(imcore,message){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(dispatch,getState){var _options$success2=options.success,success=void 0===_options$success2?function(){}:_options$success2,_options$fail2=options.fail,fail=void 0===_options$fail2?function(){}:_options$fail2,msgList=getState().panel.sendList,theMsg=msgList.find(function(v){return v.id===message.id}),newMsg=null;theMsg&&(theMsg.hasOwnProperty("set")||theMsg.isPrototypeOf("set")||(newMsg=new _send.ImgMsg,theMsg=$.extend(!0,newMsg,theMsg)),theMsg.status=!0,theMsg.isClick=!0,imcore.resend(theMsg,success,fail,function(_ref3){var code=_ref3.code,msg=_ref3.msg;_api.messageApi.serverSendErr(imcore,{code:code,msg:msg},getState())},!0))}}function cEntrustResume(imcore,oppositeImId){var _this=this;return function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:try{LT.Message=LT.Message||Apps.Message,LT.Message.entrustResume({id:oppositeImId})}catch(e){alert(e.description),imcore.handleErr(e)}case 1:case"end":return _context.stop()}},_callee,_this)}));return function(_x3,_x4){return _ref4.apply(this,arguments)}}()}function checkImageFile(imcore,pictureDom,activeContact,cb){var _this2=this;return function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(dispatch,getState){var imageWH;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(_context2.prev=0,(0,_checkFile.checkFileType)({fileInputId:pictureDom})){_context2.next=7;break}return cb&&cb(),dispatch({type:ActionType.SEND_IMG_FAIL,payload:{pictureDom:null}}),_Dialog2["default"].alert({parent:"chat",width:300,content:React.createElement("p",{className:"text-center"},_constants.ErrorType.UPLOAD_FILE_TYPE_ERROR)}),imcore.handleVisibleErr("UPLOAD_FILE_TYPE_ERROR"),_context2.abrupt("return");case 7:if((0,_checkFile.checkFileSize)({fileInputId:pictureDom})){_context2.next=13;break}return cb&&cb(),dispatch({type:ActionType.SEND_IMG_FAIL,payload:{pictureDom:null}}),_Dialog2["default"].alert({parent:"chat",width:300,content:React.createElement("p",{className:"text-center"},_constants.ErrorType.UPLOAD_FILE_OVERSIZE)}),imcore.handleVisibleErr("UPLOAD_FILE_OVERSIZE"),_context2.abrupt("return");case 13:return _context2.next=15,(0,_checkFile.checkFileWH)({fileInputId:pictureDom});case 15:if(imageWH=_context2.sent){_context2.next=22;break}return cb&&cb(),dispatch({type:ActionType.SEND_IMG_FAIL,payload:{pictureDom:null}}),_Dialog2["default"].alert({parent:"chat",width:300,content:React.createElement("p",{className:"text-center"},_constants.ErrorType.UPLOAD_FILE_WH)}),imcore.handleVisibleErr("UPLOAD_FILE_WH"),_context2.abrupt("return");case 22:console.log("图片快出来了"),dispatch(sendImage(imcore,pictureDom,activeContact,cb)),_context2.next=30;break;case 26:_context2.prev=26,_context2.t0=_context2["catch"](0),alert(_context2.t0.description),imcore.handleErr(_context2.t0);case 30:case"end":return _context2.stop()}},_callee2,_this2,[[0,26]])}));return function(_x5,_x6){return _ref5.apply(this,arguments)}}()}function sendImage(imcore,pictureDom,activeContact,cb){return function(dispatch,getState){var msg=new _send.ImgMsg;msg.set({from:imcore.userInfo,to:activeContact,dataType:"img",data:{fileInputId:pictureDom},onFileAppend:function onFileAppend(){dispatch({type:ActionType.SEND_IMG_FAIL,payload:{fileRefresh:!1}})},onFileUploadError:function onFileUploadError(error){dispatch({type:ActionType.SEND_IMG_FAIL,payload:{fileRefresh:!0}})},onFileUploadComplete:function onFileUploadComplete(data){dispatch({type:ActionType.SEND_IMG_SUCC,payload:{pictureDom:null,fileRefresh:!0}})}}),dispatch(sendMsg(imcore,msg,{},cb))}}var _utils,_send,_config,_config2,_checkFile,_ActionType,ActionType,_api,_constants,_Dialog,_Dialog2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.sendMsg=sendMsg,exports.resendMsg=resendMsg,exports.cEntrustResume=cEntrustResume,exports.checkImageFile=checkImageFile,exports.sendImage=sendImage,_utils=__webpack_require__(150),_send=__webpack_require__(221),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_checkFile=__webpack_require__(155),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_api=__webpack_require__(215),_constants=__webpack_require__(156),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function settingShow(show){return function(dispatch,getState){dispatch({type:ActionType.OPEN_SETTING,payload:!show})}}function settingList(imcore){return function(dispatch,getState){var messageStatus=!LT.Cookie.get(_constants.enums.COOKIE_KEY_SETTING_MESSAGE)||eval(LT.Cookie.get(_constants.enums.COOKIE_KEY_SETTING_MESSAGE)),dialogStatus=!LT.Cookie.get(_constants.enums.COOKIE_KEY_SETTING_DIALOG)||eval(LT.Cookie.get(_constants.enums.COOKIE_KEY_SETTING_DIALOG)),list={message:messageStatus,dialog:dialogStatus,greeting:imcore.userInfo.chatSetting&&imcore.userInfo.chatSetting.sayHi};dispatch({type:ActionType.SELECT_SETTING,payload:list})}}function settingSelect(event,icon,setting,imcore,greetingType,tlogs){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch,getState){var list,settingData,data;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:_context.prev=0,list={},list[event]=icon,settingData=$.extend(!0,{},setting,list),window.tlog=window.tlog||[],_context.t0=event,_context.next="message"===_context.t0?8:"dialog"===_context.t0?11:"greeting"===_context.t0?14:18;break;case 8:return icon?tlog.push(tlogs.SELECT_REMIND):tlog.push(tlogs.SELECT_NOREMIND),LT.Cookie.set(_constants.enums.COOKIE_KEY_SETTING_MESSAGE,icon,360,"/"),_context.abrupt("break",18);case 11:return"h"!==imcore.env&&(icon?tlog.push(tlogs.SELECT_DIALOG_ENTER):tlog.push(tlogs.SELECT_DIALOG_CTRLENTER)),LT.Cookie.set(_constants.enums.COOKIE_KEY_SETTING_DIALOG,icon,360,"/"),_context.abrupt("break",18);case 14:return _context.next=16,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.saveChatSetting,type:"post",data:{sayHi:settingData.greeting,sayHiType:greetingType}});case 16:return data=_context.sent,_context.abrupt("break",18);case 18:(0,_utils2.publish)(imcore,dispatch,{type:ActionType.SELECT_SETTING,payload:settingData}),_context.next=24;break;case 21:_context.prev=21,_context.t1=_context["catch"](0),imcore.handleErr(_context.t1);case 24:case"end":return _context.stop()}},_callee,_this,[[0,21]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}var _utils,_config,_config2,_ActionType,ActionType,_constants,_utils2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.settingShow=settingShow,exports.settingList=settingList,exports.settingSelect=settingSelect,_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_constants=__webpack_require__(212),_utils2=__webpack_require__(180)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function openToast(_ref){var text=_ref.text,_ref$time=_ref.time,time=void 0===_ref$time?_constants.enums.DEFAULT_TOAST_TIME:_ref$time,top=_ref.top;return function(dispatch,getState){var timer=getState().toast.timer;timer&&clearTimeout(timer),0!==time&&(timer=setTimeout(function(){return dispatch(closeToast())},time)),dispatch({type:ActionType.OPEN_TOAST,payload:{text:text,time:time,timer:timer,top:top,mask:!1,show:!0}})}}function closeToast(){return{type:ActionType.CLOSE_TOAST,payload:{text:"",timer:null,show:!1}}}var _ActionType,ActionType,_constants;Object.defineProperty(exports,"__esModule",{value:!0}),exports.openToast=openToast,exports.closeToast=closeToast,_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_constants=__webpack_require__(212)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function showUserSetting(){return function(dispatch,getState){dispatch({type:ActionType.USERSETTING_DIALOG,payload:!0})}}function hideUserSetting(){return function(dispatch,getState){dispatch({type:ActionType.USERSETTING_DIALOG,payload:!1})}}var _utils,_config,_config2,_ActionType,ActionType,_constants,_constants2;Object.defineProperty(exports,"__esModule",{value:!0}),exports.showUserSetting=showUserSetting,exports.hideUserSetting=hideUserSetting,_utils=__webpack_require__(150),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_constants=__webpack_require__(212),_constants2=__webpack_require__(156)},function(module,exports,__webpack_require__){"use strict";function dragReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dragInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.DRAG_DISTANCE:return Object.assign({},state,action.payload);case _actions.ActionType.DRAG_DONE:return Object.assign({},state,action.payload);default:return state}}var _actions,dragInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.dragInitialState=void 0,exports.dragReducer=dragReducer,_actions=__webpack_require__(173),dragInitialState=exports.dragInitialState={top:0,right:300}},function(module,exports,__webpack_require__){"use strict";function historyReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:historyInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.GET_INITIAL_SERVER_HISTORY_START:return Object.assign({},state,{loadingInitialHistory:!0});case _actions.ActionType.GET_INITIAL_SERVER_HISTORY_FAIL:return Object.assign({},state,{loadingInitialHistory:!1});case _actions.ActionType.GET_INITIAL_SERVER_HISTORY:return Object.assign({},state,{initialServerHistory:action.payload,loadingInitialHistory:!1});case _actions.ActionType.CLEAR_INITIAL_SERVER_HISTORY:return Object.assign({},state,{initialServerHistory:[]});case _actions.ActionType.SHOW_HISTORY:case _actions.ActionType.HIDE_HISTORY:return Object.assign({},state,action.payload);case _actions.ActionType.GET_SERVER_HISTORY_STARTED:case _actions.ActionType.GET_SERVER_HISTORY_FAILED:return Object.assign({},state,action.payload);case _actions.ActionType.GET_SERVER_HISTORY_SUCCESS:return Object.assign({},state,{loading:action.payload.loading,lastmsgid:action.payload.lastmsgid,serverHistory:action.payload.newpage.concat(state.serverHistory),nomore:action.payload.nomore});case _actions.ActionType.UPDATE_INITIAL_SERVER_HISTORY:return action.payload?Object.assign({},state,{initialServerHistory:action.payload}):state;default:return state}}var _actions,historyInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.historyInitialState=void 0,exports.historyReducer=historyReducer,_actions=__webpack_require__(173),historyInitialState=exports.historyInitialState={visible:!1,initialServerHistory:[],serverHistory:[],loading:!1,lastmsgid:-1,nomore:!1,loadingInitialHistory:!1}},function(module,exports,__webpack_require__){"use strict";function addToTop(list1,list2,item,condition){var index1=list1.findIndex(function(v,i,arr){return condition(v,i,arr)}),index2=list2.findIndex(function(v,i,arr){return condition(v,i,arr)});return index1>-1?{curMonthContacts:[_extends({},list1[index1],item)].concat(list1.slice(0,index1)).concat(list1.slice(index1+1))}:index2>-1?{curMonthContacts:[_extends({},list2[index2],item)].concat(list1),earlierContacts:list2.slice(0,index2).concat(list2.slice(index2+1))}:(list1.unshift(item),{curMonthContacts:list1})}function updateList(list,item,condition){if("[object Array]"===Object.prototype.toString.call(list)){var i=list.findIndex(function(v,i,arr){return condition(v,i,arr)});return i===-1?list:list.slice(0,i).concat([_extends({},list[i],item)]).concat(list.slice(i+1))}}function historyContactsReducer(){var newcontacts,newEarlyContacts,state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState,action=arguments[1],pageList=void 0,contact=void 0,indexCur=void 0,indexEarly=void 0;switch(action.type){case _actions.ActionType.GET_HISTORYCONTACTS_START:case _actions.ActionType.GET_HISTORYCONTACTS_FAIL:case _actions.ActionType.GET_HISTORYCONTACTS_SUCC:return Object.assign({},state,action.payload);case _actions.ActionType.DELETE_CONTACT:if(contact=action.payload,indexCur=state.curMonthContacts.findIndex(function(v){return v.oppositeImId===contact.oppositeImId}),indexEarly=state.earlierContacts.findIndex(function(v){return v.oppositeImId===contact.oppositeImId}),indexCur===-1&&indexEarly===-1)return state;if(indexCur>-1)return Object.assign({},state,{curMonthContacts:state.curMonthContacts.slice(0,indexCur).concat(state.curMonthContacts.slice(indexCur+1))});if(indexEarly>-1)return Object.assign({},state,{earlierContacts:state.earlierContacts.slice(0,indexEarly).concat(state.earlierContacts.slice(indexEarly+1))});case _actions.ActionType.SELECT_CONTACT:return newcontacts=updateList(state.curMonthContacts,{unReadCnt:0},function(v){return action.payload.contact.oppositeImId===v.oppositeImId}),newEarlyContacts=updateList(state.earlierContacts,{unReadCnt:0},function(v){return action.payload.contact.oppositeImId===v.oppositeImId}),Object.assign({},state,{curMonthContacts:newcontacts,earlierContacts:newEarlyContacts});case _actions.ActionType.UPDATE_HISTORYCONTACTS_BY_SEND_MSG:return Object.assign({},state,addToTop(state.curMonthContacts,state.earlierContacts,_extends({},action.payload.contact,action.payload.lastMsg),function(v){return v.oppositeImId===action.payload.contact.oppositeImId}));case _actions.ActionType.UPDATE_HISTORYCONTACTS_BY_RECEIVE_MSG:return Object.assign({},state,addToTop(state.curMonthContacts,state.earlierContacts,action.payload,function(v){return v.oppositeImId===action.payload.oppositeImId}));case _actions.ActionType.UPDATE_HISTORYCONTACT_READED_MSG:return imcore.handleLog("msgReaded--- UPDATE_HISTORYCONTACT_READED_MSG ----->",action.payload),Object.assign({},state,action.payload);default:return state}}var _extends,_actions,initialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.initialState=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports.historyContactsReducer=historyContactsReducer,_actions=__webpack_require__(173),initialState=exports.initialState={firstLoaded:!1,curMonthContacts:[],earlierContacts:[],loading:!1,curPage:0,nomore:!1}},function(module,exports,__webpack_require__){"use strict";function noticeReducer(){var newList,state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:noticeInitialState,action=arguments[1],i=void 0;switch(action.type){case _actions.ActionType.GET_NOTICELIST_START:case _actions.ActionType.GET_NOTICELIST_SUCC:case _actions.ActionType.GET_NOTICELIST_FAIL:return Object.assign({},state,action.payload);case _actions.ActionType.DELETE_NOTICEITEM:return i=state.sysMsgList.findIndex(function(v){return v.id===action.payload}),newList=state.sysMsgList.slice(0,i).concat(state.sysMsgList.slice(i+1)),_extends({},state,{totalCnt:state.totalCnt,sysMsgList:newList});case _actions.ActionType.READ_NOTICE:return state.sysMsgList.forEach(function(v,i){v.id===action.payload&&(v.readFlag="1")}),$.extend(!0,{},state,{sysMsgList:state.noticeList});case _actions.ActionType.HASREAD_NOTICE:return state.sysMsgList.forEach(function(v,i){v.id===action.payload.id&&(v.readFlag="1")}),$.extend(!0,{},state,{index:action.payload.index,sysMsgList:state.sysMsgList});case _actions.ActionType.UNSELECT_NOTICE:return _extends({},state,{noticeDetail:action.payload});case _actions.ActionType.CHANGE_TABS_UNREAD:return"notice"===action.payload.tab.key?Object.assign({},state,{unRead:action.payload.status}):state;default:return state}}var _extends,_actions,noticeInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.noticeInitialState=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports.noticeReducer=noticeReducer,_actions=__webpack_require__(173),noticeInitialState=exports.noticeInitialState={noticeList:{},noticeDetail:null,unRead:!1,firstLoaded:!1,totalCnt:0,curPage:0,sysMsgList:[],nomoreNotice:!1}},function(module,exports,__webpack_require__){"use strict";function panelReducer(){var newMsgArr,state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:panelInitialState,action=arguments[1],sendMsg=void 0,msgList=void 0,newMsgList=[],newSendList=[];switch(action.type){case _actions.ActionType.PANEL_RECEIVE_MSG:return Object.assign({},state,{msgList:state.msgList.concat(action.payload)});case _actions.ActionType.PANEL_SEND_MSG:return sendMsg=(0,_send.createSendMsgByPlainMsg)(action.payload),state.msgList.length>0&&state.msgList.some(function(v){return v.ext.id===sendMsg.msgBody.id})?(newMsgList=state.msgList.map(function(v){return v.ext.id===sendMsg.msgBody.id&&(v=_extends({},v,sendMsg)),v}),newSendList=state.sendList.map(function(v){return v.id===sendMsg.msgBody.id&&(v=sendMsg),v})):(newMsgList=state.msgList.concat(sendMsg.getStorageBody()),newSendList=state.sendList.concat(sendMsg)),Object.assign({},state,{msgList:newMsgList,sendList:newSendList});case _actions.ActionType.PANEL_UPDATE_MSG:return newMsgArr=[],msgList=state.msgList.map(function(v,i){return v.id===action.payload.id?action.payload:v.ext&&v.ext.id===action.payload.ext.id?v=action.payload:v}),Object.assign({},state,{msgList:msgList});case _actions.ActionType.PANEL_CONN_MSG:return msgList=state.msgList.slice(0),Object.assign({},state,{msgList:msgList.concat(action.payload)});case _actions.ActionType.INIT_TAB:case _actions.ActionType.SELECT_TAB:return Object.assign({},state,{activeTab:action.payload});case _actions.ActionType.SELECT_CONTACT_START:return Object.assign({},state,action.payload);case _actions.ActionType.UPDATE_ATTENTION:return Object.assign({},state,{activeContact:action.payload.contact});case _actions.ActionType.SELECT_CONTACT:return Object.assign({},state,{activeContact:action.payload.contact,msgList:[],loadingActiveContact:!1});case _actions.ActionType.UNSELECT_ACTIVE_CONTACT:return Object.assign({},state,{activeContact:null,loadingActiveContact:!1});case _actions.ActionType.OPEN_PANEL:return Object.assign({},state,{opened:!0});case _actions.ActionType.CLOSE_PANEL:return Object.assign({},state,{opened:!1});case _actions.ActionType.SET_TABS_UNREAD:return Object.assign({},state,{unReadTabs:action.payload});case _actions.ActionType.SET_PANEL_UNREAD:return Object.assign({},state,{unRead:action.payload});case _actions.ActionType.UPDATE_MSGLIST:return action.payload?Object.assign({},state,{msgList:action.payload}):state;default:return state}}var _extends,_actions,_send,panelInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.panelInitialState=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports.panelReducer=panelReducer,_actions=__webpack_require__(173),_send=__webpack_require__(221),panelInitialState=exports.panelInitialState={msgList:[],sendList:[],activeTab:null,activeContact:null,unRead:!1,unReadTabs:[0,!1,!1],contactUnread:0,opened:!1,loadingActiveContact:!1}},function(module,exports,__webpack_require__){"use strict";function snsReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:snsInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.SELECT_SNS:return Object.assign({},state,{sns:action.payload});default:return state}}var _actions,snsInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.snsInitialState=void 0,exports.snsReducer=snsReducer,_actions=__webpack_require__(173),snsInitialState=exports.snsInitialState={sns:[],unRead:!1}},function(module,exports,__webpack_require__){"use strict";function dialogReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dialogInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.OPEN_DIALOG:return _extends({},state,action.payload);case _actions.ActionType.CLOSE_DIALOG:return _extends({},state,action.payload);default:return state}}var _extends,_actions,dialogInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.dialogInitialState=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports.dialogReducer=dialogReducer,_actions=__webpack_require__(173),dialogInitialState=exports.dialogInitialState={panelVisible:!1,panelContent:null,chatVisible:!1,chatContent:null}},function(module,exports,__webpack_require__){"use strict";function settingReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:settingInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.OPEN_SETTING:return Object.assign({},state,{show:action.payload});case _actions.ActionType.SELECT_SETTING:return Object.assign({},state,{setting:action.payload});default:return state}}var _actions,settingInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.settingInitialState=void 0,exports.settingReducer=settingReducer,_actions=__webpack_require__(173),settingInitialState=exports.settingInitialState={show:!1,setting:{message:!0,dialog:!0,greeting:!0}}},function(module,exports,__webpack_require__){"use strict";function setGreetingReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:setGreetingInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.OPEN_SETGREETING:return Object.assign({},state,{show:action.payload});case _actions.ActionType.SETGREETING_LIST:return Object.assign({},state,{greetingList:action.payload});case _actions.ActionType.SELECT_GREETING:return $.extend({},!0,state,action.payload);default:return state}}var _actions,setGreetingInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.setGreetingInitialState=void 0,exports.setGreetingReducer=setGreetingReducer,_actions=__webpack_require__(173),setGreetingInitialState=exports.setGreetingInitialState={show:!1,greetingList:[],greetingType:1,greetingText:""}},function(module,exports,__webpack_require__){"use strict";function format(top){var formatted=parseInt(top);return isNaN(formatted)&&(formatted=150),formatted}function initToast(_ref){var _ref$text=_ref.text,text=void 0===_ref$text?"加载中":_ref$text,time=_ref.time,top=_ref.top,_ref$timer=_ref.timer,timer=void 0===_ref$timer?null:_ref$timer;return{text:text,time:time,timer:timer,show:!0,top:format(top)}}function toastReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState,action=arguments[1];switch(action.type){case _actions.ActionType.OPEN_TOAST:return Object.assign({},state,initToast(action.payload));case _actions.ActionType.CLOSE_TOAST:return Object.assign({},state,action.payload);default:return state}}var _actions,initialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.initialState=void 0,exports.toastReducer=toastReducer,_actions=__webpack_require__(173),initialState=exports.initialState={time:0,text:"",show:!1,timer:null,top:150}},function(module,exports,__webpack_require__){"use strict";function userSettingReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:userSettingInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.USERSETTING_DIALOG:return Object.assign({},state,{dialogVisible:action.payload});default:return state}}var _actions,userSettingInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.userSettingInitialState=void 0,exports.userSettingReducer=userSettingReducer,_actions=__webpack_require__(173),userSettingInitialState=exports.userSettingInitialState={dialogVisible:!1}},function(module,exports,__webpack_require__){"use strict";function shieldReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:shieldInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.INBLACK_STATUS:return Object.assign({},state,{inBlack:action.payload});case _actions.ActionType.INBLACK_DIALOG:return Object.assign({},state,{dialogVisible:action.payload});default:return state}}var _actions,shieldInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.shieldInitialState=void 0,exports.shieldReducer=shieldReducer,_actions=__webpack_require__(173),shieldInitialState=exports.shieldInitialState={inBlack:!1,dialogVisible:!1}},function(module,exports,__webpack_require__){"use strict";function reportReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:reportInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.REPORT_CODE:return Object.assign({},state,{reportCode:action.payload});case _actions.ActionType.REPORT_DIALOG:return Object.assign({},state,{dialogVisible:action.payload});default:return state}}var _actions,reportInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.reportInitialState=void 0,exports.reportReducer=reportReducer,_actions=__webpack_require__(173),reportInitialState=exports.reportInitialState={reportCode:5,dialogVisible:!1}},function(module,exports,__webpack_require__){"use strict";function sendMsgReducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sendMsgInitialState,action=arguments[1];switch(action.type){case _actions.ActionType.SEND_IMG_START:case _actions.ActionType.SEND_IMG_FAIL:case _actions.ActionType.SEND_IMG_SUCC:return _extends({},state,action.payload);default:return state}}var _extends,_actions,sendMsgInitialState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.sendMsgInitialState=void 0,_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},exports.sendMsgReducer=sendMsgReducer,_actions=__webpack_require__(173),sendMsgInitialState=exports.sendMsgInitialState={fileRefresh:!0,pictureDom:null}},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _objectWithoutProperties(obj,keys){var i,target={};for(i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_redux,_reactRedux,_constants,_ActionType,ActionType,_actions,_ChatWin,_ChatWin2,_Setting,_Setting2,_config,_config2,_addTlog,_classnames,_classnames2,_utils,Panel,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_constants=__webpack_require__(156),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_actions=__webpack_require__(173),_ChatWin=__webpack_require__(249),_ChatWin2=_interopRequireDefault(_ChatWin),_Setting=__webpack_require__(278),_Setting2=_interopRequireDefault(_Setting),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_addTlog=__webpack_require__(182),__webpack_require__(282),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_utils=__webpack_require__(180),Panel=function(_Component){function Panel(props){_classCallCheck(this,Panel);var _this=_possibleConstructorReturn(this,(Panel.__proto__||Object.getPrototypeOf(Panel)).call(this,props));
return _this.config=(0,_config2["default"])(props.imcore.env),_this.state={dialogVisible:!1},_this.ie9=navigator.userAgent.indexOf("MSIE 9.0")>0,_this}return _inherits(Panel,_Component),_createClass(Panel,[{key:"componentDidMount",value:function componentDidMount(){var actionTypes,_this2=this,that=this,_props=this.props,imcore=_props.imcore,actions=_props.actions,unRead=_props.unRead,toggleUnRead=_props.toggleUnRead,openPanel=_props.openPanel,opened=_props.opened,wrap=_props.wrap,dispatch=_props.dispatch,componentDidMounted=_props.componentDidMounted,settingShow=_props.settingShow,onSelectContact=_props.onSelectContact;openPanel(function(){window.tlog=window.tlog||[],tlog.push(_this2.config.tlogs.OPEN_PANEL),$(wrap).addClass("move-to-show"),actions.openPanel(imcore)}),actions.initPanel(imcore),imcore.event.on(_constants.MsgEvent.SEND_MSG,function(msg){actions.panelSendMsg(imcore,msg)}),imcore.event.on(_constants.MsgEvent.RECEIVE_MSG,function(msg){actions.panelReceiveMsg(imcore,msg)}),imcore.event.on(_constants.MsgEvent.UPDATE_MSG,function(msg){actions.panelUpdateMsg(imcore,msg)}),imcore.event.on(_constants.MsgEvent.UPDATE_LIST_MSG,function(msg){actions.panelUpdateListMsg(imcore,msg)}),imcore.event.on(_constants.MsgEvent.UPDATE_READED_MSG,function(toImId){actions.panelUpdateReadedMsg(imcore,toImId)}),imcore.event.on(_constants.MsgEvent.CONN_MSG,function(hasConnect){actions.initPanel(imcore,hasConnect,!0)}),actionTypes=Object.keys(ActionType),actionTypes.forEach(function(v){imcore.subscribe(v,function(type,action){action.pageId!==imcore.pageId&&dispatch({type:action.type,payload:action.payload})})}),componentDidMounted&&componentDidMounted({imcore:imcore,actions:actions,dispatch:dispatch}),imcore.event.on("selectContact",function(contact){onSelectContact&&onSelectContact(contact)})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){nextProps.unRead!==this.props.unRead&&this.props.toggleUnRead(nextProps.unRead)}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(nextProps,nextState){var _props2=this.props,allstate=_props2.allstate,thisOthers=_objectWithoutProperties(_props2,["allstate"]),_nextProps=nextProps,allstate2=_nextProps.allstate,nextOthers=_objectWithoutProperties(_nextProps,["allstate"]),thisProps=thisOthers;return nextProps=nextOthers,(0,_utils.comparePropsState)(thisProps,this.state,nextProps,nextState)}},{key:"openDialog",value:function openDialog(){this.setState({dialogVisible:!0})}},{key:"closePanel",value:function closePanel(){var _props3=this.props,imcore=_props3.imcore,actions=_props3.actions,wrap=_props3.wrap;$(wrap).removeClass("move-to-show"),actions.closePanel(imcore)}},{key:"clickTab",value:function clickTab(v){var _props4=this.props,actions=_props4.actions,imcore=_props4.imcore;actions.selectTab(imcore,v)}},{key:"renderChatWin",value:function renderChatWin(){return this.props.activeContact||this.props.loadingActiveContact?_react2["default"].createElement(_ChatWin2["default"],{imcore:this.props.imcore,msgcard:this.props.msgcard}):null}},{key:"clickSetting",value:function clickSetting(){var _props5=this.props,actions=_props5.actions,settingShow=_props5.settingShow;actions.settingShow(settingShow)}},{key:"render",value:function render(){var _this3=this,_props6=this.props,imcore=_props6.imcore,actions=_props6.actions,activeTab=_props6.activeTab,unReadTabs=_props6.unReadTabs,greetingType=_props6.greetingType,opened=_props6.opened,allstate=_props6.allstate,style=this.ie9?{}:{zIndex:3};return _react2["default"].createElement("div",null,_react2["default"].createElement(_Setting2["default"],{greetingType:greetingType,imcore:imcore}),_react2["default"].createElement("aside",null,_react2["default"].createElement(_addTlog.Atlog,{href:"javascript:;",className:"link-close-panel",onClick:function onClick(){return _this3.closePanel()},pushStr:this.config.tlogs.CLOSE_PANEL},_react2["default"].createElement("i",{className:"webim-icons16 icons16-arrow"})),_react2["default"].createElement("ul",null,activeTab&&this.config.tabs.map(function(v,i){return _react2["default"].createElement("li",{key:i},_react2["default"].createElement(_addTlog.Atlog,{href:"javascript:;",onClick:function onClick(){return _this3.clickTab(v)},pushStr:_this3.config.tlogs["OPEN_"+v.key.toUpperCase()]},_react2["default"].createElement("i",{className:"side-icon side-icon-"+v.key+(v.key===activeTab.key?" active":"")}),_react2["default"].createElement("span",null,v.name),"contacts"===v.key?_react2["default"].createElement("em",{className:(0,_classnames2["default"])({contactsdot:!0,hide:0===parseInt(unReadTabs[0])})},parseInt(unReadTabs[0])>99?"99+":unReadTabs[0]):_react2["default"].createElement("em",{className:(0,_classnames2["default"])({dot:!0,hide:!unReadTabs[i]})})))})),_react2["default"].createElement(_addTlog.Atlog,{href:"javascript:;",onClick:function onClick(){return _this3.clickSetting()},pushStr:this.config.tlogs.PANEL_SETTING,className:"link-open-setting"},_react2["default"].createElement("i",{className:"webim-icons16 icons16-setting-white"}))),_react2["default"].createElement("div",{className:"main-content"},activeTab&&this.config.tabs.map(function(v,i){var Main=v.comp;return _react2["default"].createElement(Main,{key:i,imcore:imcore})}),_react2["default"].createElement("div",{id:"main-dialog-container"})),this.renderChatWin(),_react2["default"].createElement("div",{id:"panel-dialog-container"}))}}]),Panel}(_react.Component),mapStateToProps=function mapStateToProps(state,props){return{allstate:state,activeTab:state.panel.activeTab,activeContact:state.panel.activeContact,unRead:state.panel.unRead,unReadTabs:state.panel.unReadTabs,opened:state.panel.opened,settingShow:state.setting.show,greeting:state.setting.setting.greeting,greetingType:state.setGreeting.greetingType,greetingText:state.setGreeting.greetingText,loadingActiveContact:state.panel.loadingActiveContact}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.panelActions,_actions.contactsActions,_actions.historyActions,_actions.historyContactsActions,_actions.settingActions,_actions.setGreetingActions,_actions.messageActions),dispatch),dispatch:dispatch}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Panel)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_constants,_send,_addTlog,_utils,_classnames,_classnames2,_redux,_reactRedux,_actions,_dragResize,_ChatForm,_ChatForm2,_ChatTitle,_ChatTitle2,_ChatHistory,_ChatHistory2,_config,_config2,_Message,_Message2,_Report,_Report2,_Toast,_Toast2,ChatWin,msgListFilterByContact,mapStateToProps,mapDispatchToProps,ChatWin1;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_constants=__webpack_require__(156),_send=__webpack_require__(221),_addTlog=__webpack_require__(182),_utils=__webpack_require__(180),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_actions=__webpack_require__(173),_dragResize=__webpack_require__(250),_ChatForm=__webpack_require__(251),_ChatForm2=_interopRequireDefault(_ChatForm),_ChatTitle=__webpack_require__(253),_ChatTitle2=_interopRequireDefault(_ChatTitle),_ChatHistory=__webpack_require__(262),_ChatHistory2=_interopRequireDefault(_ChatHistory),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_Message=__webpack_require__(268),_Message2=_interopRequireDefault(_Message),_Report=__webpack_require__(260),_Report2=_interopRequireDefault(_Report),_Toast=__webpack_require__(275),_Toast2=_interopRequireDefault(_Toast),__webpack_require__(277),ChatWin=function(_Component){function ChatWin(props){_classCallCheck(this,ChatWin);var _this=_possibleConstructorReturn(this,(ChatWin.__proto__||Object.getPrototypeOf(ChatWin)).call(this,props));return _this.chatlistDom=null,_this.config=(0,_config2["default"])(props.imcore.env),_this.state={inputHeight:40},_this}return _inherits(ChatWin,_Component),_createClass(ChatWin,[{key:"componentDidMount",value:function componentDidMount(){this.scrollToBottom()}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){this.props.msgList.length!==nextProps.msgList.length&&this.scrollToBottom(),this.props.loadingActiveContact!==nextProps.loadingActiveContact&&this.scrollToBottom()}},{key:"setInputHeight",value:function setInputHeight(inputHeight){this.setState({inputHeight:inputHeight})}},{key:"scrollToBottom",value:function scrollToBottom(){var _this2=this;setTimeout(function(){_this2.chatlistDom&&$(_this2.chatlistDom).scrollTop(_this2.chatlistDom.scrollHeight)},100)}},{key:"renderMsg",value:function renderMsg(msg,index){var _this3=this,_props=this.props,imcore=_props.imcore,activeContact=_props.activeContact,msgcard=_props.msgcard;return _react2["default"].createElement("div",{key:index},msg.time&&_react2["default"].createElement("p",{className:"time"},msg.time),_react2["default"].createElement(_Message2["default"],{message:msg,imcore:imcore,scrollToBottom:function scrollToBottom(){return _this3.scrollToBottom()},activeContact:activeContact,msgcard:msgcard}))}},{key:"render",value:function render(){var _this4=this,_props2=this.props,imcore=_props2.imcore,activeContact=_props2.activeContact,actions=_props2.actions,style=_props2.style,msgList=_props2.msgList,historyVisible=_props2.historyVisible,loadingActiveContact=_props2.loadingActiveContact,loadingInitialHistory=_props2.loadingInitialHistory,msgcard=_props2.msgcard;return loadingActiveContact||activeContact?loadingActiveContact||!activeContact?_react2["default"].createElement("div",_defineProperty({className:"chatwin",style:{background:"#fff"}},"style",style),_react2["default"].createElement("a",{href:"javascript:;",className:(0,_classnames2["default"])("close-chat",{blur:historyVisible}),onClick:function onClick(){return actions.unselectActiveContact(imcore)}},"×"),_react2["default"].createElement("div",{className:"chatwin-loading"},_react2["default"].createElement("em",null))):_react2["default"].createElement("div",{className:(0,_classnames2["default"])("chatwin",{hide:!activeContact}),style:style},_react2["default"].createElement("a",{href:"javascript:;",className:(0,_classnames2["default"])("close-chat",{blur:historyVisible}),onClick:function onClick(){return actions.unselectActiveContact(imcore)}},"×"),_react2["default"].createElement(_ChatTitle2["default"],{imcore:imcore,activeContact:activeContact}),_react2["default"].createElement("div",{className:(0,_classnames2["default"])("chat-main",{blur:historyVisible}),style:{height:"calc(100% - "+(66+this.state.inputHeight)+"px)"}},_react2["default"].createElement("div",{className:"chat-list",ref:function ref(dom){_this4.chatlistDom=dom}},_react2["default"].createElement("p",{className:"check-all-history"},_react2["default"].createElement(_addTlog.Atlog,{href:"javascript:;",pushStr:this.config.tlogs.CLICK_HISTORY_LINK,onClick:function onClick(){return actions.showHistory(imcore)}},"查看全部历史消息")),loadingInitialHistory&&_react2["default"].createElement("div",{className:"msg-list-loading"},_react2["default"].createElement("em",null)),msgList&&msgList.map(function(msgWrap,index){return _this4.renderMsg(msgWrap,index)})),_react2["default"].createElement(_ChatForm2["default"],{imcore:imcore,setInputHeight:function setInputHeight(height){return _this4.setInputHeight(height)}})),_react2["default"].createElement(_ChatHistory2["default"],{imcore:imcore}),_react2["default"].createElement("div",{id:"chat-dialog-container"}),_react2["default"].createElement(_Toast2["default"],null)):null}}]),ChatWin}(_react.Component),msgListFilterByContact=function msgListFilterByContact(contact,msgList,initialServerHistory,activeContact,loadingActiveContact){var formattedMsgList,allArr;return loadingActiveContact?[]:(formattedMsgList=msgList.filter(function(v){return"err"===v.type||v.from===activeContact.oppositeImId||v.to===activeContact.oppositeImId}),allArr=initialServerHistory.concat(formattedMsgList),allArr=(0,_utils.timeVisibleFormat)(allArr))},mapStateToProps=function mapStateToProps(state){return{activeContact:state.panel.activeContact,top:state.drag.top,right:state.drag.right,msgList:msgListFilterByContact(state.panel.activeContact,state.panel.msgList,state.history.initialServerHistory,state.panel.activeContact,state.panel.loadingActiveContact),historyVisible:state.history.visible,loadingActiveContact:state.panel.loadingActiveContact,loadingInitialHistory:state.history.loadingInitialHistory}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.contactsActions,_actions.panelActions,_actions.historyActions),dispatch)}},ChatWin1=(0,_dragResize.dragMove)()(ChatWin),exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(ChatWin1)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _objectWithoutProperties(obj,keys){var i,target={};for(i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function drag(){return function(Comp){return function(_Component){function _class(props){_classCallCheck(this,_class);var _this=_possibleConstructorReturn(this,(_class.__proto__||Object.getPrototypeOf(_class)).call(this,props));return _this.originCX=null,_this.originCY=null,_this.state={draging:!1},_this.onMouseUp=_this.onMouseUp.bind(_this),_this.onMouseMove=_this.onMouseMove.bind(_this),_this.setAgain=_this.setAgain.bind(_this),_this}return _inherits(_class,_Component),_createClass(_class,[{key:"componentDidMount",value:function componentDidMount(){var that=this;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("resize",this.setAgain)}},{key:"componentWillUnmount",value:function componentWillUnmount(){var that=this;window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("resize",this.setAgain)}},{key:"setAgain",value:function setAgain(){this.props.actions.dragWindowResize()}},{key:"onMouseMove",value:function onMouseMove(e){var distanceX,distanceY;this.state.draging&&(distanceX=e.clientX-this.originCX,distanceY=e.clientY-this.originCY,this.props.actions.dragDistance({distanceX:distanceX,distanceY:distanceY}),this.originCX=e.clientX,this.originCY=e.clientY)}},{key:"onMouseUp",value:function onMouseUp(e){this.state.draging&&this.setState({draging:!1})}},{key:"onMousedown",value:function onMousedown(e){2!==e.button&&(this.originCX=e.clientX,this.originCY=e.clientY,this.setState({draging:!0}))}},{key:"render",value:function render(){var _this2=this,_props=this.props,_props$style=_props.style,style=void 0===_props$style?{}:_props$style,rest=_objectWithoutProperties(_props,["style"]);return _react2["default"].createElement(Comp,_extends({style:Object.assign.apply(Object,[{}].concat(_toConsumableArray(style),[{cursor:this.state.draging?"all-scroll":"auto"}]))},rest,{onMouseDown:function onMouseDown(e){_this2.onMousedown(e)}}))}}]),_class}(_react.Component)}}function dragMove(){return function(Comp){return function(_Component2){function _class2(){return _classCallCheck(this,_class2),_possibleConstructorReturn(this,(_class2.__proto__||Object.getPrototypeOf(_class2)).apply(this,arguments))}return _inherits(_class2,_Component2),_createClass(_class2,[{key:"render",value:function render(){var _props2=this.props,_props2$style=_props2.style,style=void 0===_props2$style?{}:_props2$style,top=_props2.top,right=_props2.right,rest=_objectWithoutProperties(_props2,["style","top","right"]),newStyle=Object.assign.apply(Object,[{}].concat(_toConsumableArray(style),[{top:top,right:right}]));return _react2["default"].createElement(Comp,_extends({style:newStyle},rest))}}]),_class2}(_react.Component)}}var _extends,_createClass,_react,_react2;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),exports.drag=drag,exports.dragMove=dragMove,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_constants,_send,_constants2,_addTlog,_redux,_reactRedux,_actions,_config,_config2,_classnames,_classnames2,emotionArr,i,ChatForm,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_constants=__webpack_require__(156),_send=__webpack_require__(221),_constants2=__webpack_require__(212),_addTlog=__webpack_require__(182),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_actions=__webpack_require__(173),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),__webpack_require__(252),emotionArr=[];for(i in _constants2.Emotions)emotionArr.push({key:i,url:_constants2.Emotions[i]});ChatForm=function(_Component){function ChatForm(props){_classCallCheck(this,ChatForm);var _this=_possibleConstructorReturn(this,(ChatForm.__proto__||Object.getPrototypeOf(ChatForm)).call(this,props));return _this.state={emojiActive:!1,historyActive:!1,entrustActive:!1,recommendActive:!1,inputValue:"",messageVisible:!1,clipboardImg:"",placeholderVisible:!0,fileRefresh:!0},_this.config=(0,_config2["default"])(props.imcore.env),_this.textarea=null,_this.emojiEntrance=null,_this.fakeDom=null,_this.iconSendPicDom=null,_this.sendBtnDom=null,_this.userSettingDom=null,_this.blob=null,_this.ie9=navigator.userAgent.indexOf("MSIE 9.0")>0,_this.sending=!1,_this}return _inherits(ChatForm,_Component),_createClass(ChatForm,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this,that=this,actions=this.props.actions,sendBtn=this.refs.sendBtn;$(document).on("click.emoji",function(e){return e.target!==that.sendBtnDom&&0===$(that.sendBtnDom).has(e.target).length&&e.target!==that.userSettingDom&&0===$(that.userSettingDom).has(e.target).length&&_this2.setState({messageVisible:!1}),e.target!==that.userSettingDom&&(e.target!==that.emojiEntrance&&void that.disactiveEmoji())}),this.textarea.style.height="40px",this.textarea.focus(),$(document).on("keydown.clipboardImg",function(e){_this2.state.clipboardImg&&_this2.handleKeyDown(e)})}},{key:"componentWillUnmount",value:function componentWillUnmount(){$(document).off("click.emoji"),$(document).off("keydown.clipboardImg")}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){var sendMsg=nextProps.sendMsg;!sendMsg.pictureDom}},{key:"openMessage",value:function openMessage(status){this.setState({messageVisible:!status})}},{key:"sendHandler",value:function sendHandler(){var value,_this3=this,_props=this.props,imcore=_props.imcore,activeContact=_props.activeContact,actions=_props.actions,userInfo=imcore.userInfo,msg=void 0;this.state.clipboardImg?this.sending||(this.sending=!0,msg=new _send.ImgMsg,msg.set({from:imcore.userInfo,to:activeContact,dataType:"img",data:{file:{data:this.blob,url:this.state.clipboardImg,filetype:"jpg"}}}),actions.sendMsg(imcore,msg),this.onClearClipboardImg(),setTimeout(function(){_this3.sending=!1},300)):(value=this.state.inputValue.trim(),value&&!this.sending&&(this.sending=!0,msg=new _send.TxtMsg,msg.set({from:userInfo,to:activeContact,data:value}),this.textarea.value="",this.textarea.style.height="40px",this.setState({inputValue:""}),this.props.setInputHeight(40),actions.sendMsg(imcore,msg),setTimeout(function(){_this3.sending=!1},100),this.setState({placeholderVisible:!0})))}},{key:"handleChange",value:function handleChange(){var _this4=this;this.setState({inputValue:this.textarea.value},function(){var inputHeight=$(_this4.fakeDom).height();_this4.textarea.style.height=inputHeight+"px",_this4.props.setInputHeight(inputHeight)})}},{key:"handleKeyDown",value:function handleKeyDown(e){var dialog,keyDown;this.sending||(this.ie9&&this.state.placeholderVisible&&this.setState({placeholderVisible:!1}),dialog=this.props.dialog,keyDown=void 0,keyDown=dialog?13===e.keyCode&&!e.ctrlKey:13==e.keyCode&&e.ctrlKey,keyDown&&(this.sendHandler(),e.preventDefault()))}},{key:"toggleEmoji",value:function toggleEmoji(e){this.state.emojiActive?this.disactiveEmoji():(this.setState({emojiActive:!0}),window.tlog=window.tlog||[],tlog.push(this.config.tlogs.OPEN_EMOJI)),e.nativeEvent.stopImmediatePropagation()}},{key:"disactiveEmoji",value:function disactiveEmoji(){this.setState({emojiActive:!1})}},{key:"activeHistory",value:function activeHistory(){this.setState({historyActive:!0})}},{key:"disactiveHistory",value:function disactiveHistory(){this.setState({historyActive:!1})}},{key:"activeEntrust",value:function activeEntrust(){this.setState({entrustActive:!0})}},{key:"disactiveEntrust",value:function disactiveEntrust(){this.setState({entrustActive:!1})}},{key:"activeRecommend",value:function activeRecommend(){this.setState({recommendActive:!0})}},{key:"disactiveRecommend",value:function disactiveRecommend(){this.setState({recommendActive:!1})}},{key:"onIconSendPicClick",value:function onIconSendPicClick(){var pictureDom=this.props.sendMsg.pictureDom;window.tlog=window.tlog||[],tlog.push(this.config.tlogs.SEND_IMAGE),pictureDom.click()}},{key:"onImageFileChange",value:function onImageFileChange(){var _props2=this.props,imcore=_props2.imcore,activeContact=_props2.activeContact,actions=_props2.actions,sendMsg=_props2.sendMsg,that=this;actions.checkImageFile(imcore,sendMsg.pictureDom,activeContact,function(){sendMsg.pictureDom.value=""})}},{key:"selectEmotion",value:function selectEmotion(emotion){this.textarea&&(this.textarea.value+=emotion.key),this.ie9&&this.state.placeholderVisible&&this.setState({placeholderVisible:!1}),this.handleChange(),this.textarea.focus()}},{key:"handleClickEntrust",value:function handleClickEntrust(){var _props3=this.props,actions=_props3.actions,imcore=_props3.imcore,activeContact=_props3.activeContact;actions.cEntrustResume(imcore,activeContact.oppositeImId)}},{key:"setMessage",value:function setMessage(status){var that=this,_props4=this.props,actions=_props4.actions,imcore=_props4.imcore,setting=_props4.setting;actions.settingSelect("dialog",status,setting,imcore,"",that.config.tlogs)}},{key:"recommendJob",value:function recommendJob(){Apps.Recommend.hjob(this.props.activeContact.usercEncodeId)}},{key:"renderCustomBtn",value:function renderCustomBtn(){var _this5=this,_state=this.state,entrustActive=_state.entrustActive,recommendActive=_state.recommendActive;return"c"===this.props.imcore.env&&this.props.activeContact.oppositeUserKind==_constants.UserType.USER_TYPE_H?_react2["default"].createElement(_addTlog.Atlog,{href:"javascript:;",className:"link-entrust",pushStr:this.config.tlogs.CLICK_ENTRUST_ICON,onMouseEnter:function onMouseEnter(){_this5.activeEntrust()},onMouseLeave:function onMouseLeave(){return _this5.disactiveEntrust()},onClick:function onClick(){return _this5.handleClickEntrust()}},_react2["default"].createElement("em",{className:(0,_classnames2["default"])({"webim-icons16":!0,"icons16-arr-gray":entrustActive===!1,"icons16-arr-orange":entrustActive===!0})})," 委托简历"):"h"===this.props.imcore.env?_react2["default"].createElement(_addTlog.Atlog,{href:"javascript:;","data-nick":"link-recommend",className:"link-recommend",pushStr:this.config.tlogs.CLICK_RECOMMEND_ICON,onMouseEnter:function onMouseEnter(){_this5.activeRecommend()},onMouseLeave:function onMouseLeave(){return _this5.disactiveRecommend()},onClick:function onClick(){return _this5.recommendJob()}},_react2["default"].createElement("em",{className:(0,_classnames2["default"])({"webim-icons16":!0,"icons16-recommend-resume":recommendActive===!1,"icons16-recommend-orange":recommendActive===!0})})," 推荐职位"):null}},{key:"onPaste",value:function onPaste(event){var clipboardData,items,v,_i,blob,url;if((event.clipboardData||event.originalEvent)&&(clipboardData=event.clipboardData||event.originalEvent.clipboardData,clipboardData.items)){if(items=clipboardData.items,v=void 0,!items.length)return;for(_i=0;_i<items.length;_i++)if(v=items[_i],v.type.indexOf("image")!==-1){if(blob=v.getAsFile(),0===blob.size)return;return url=window.URL.createObjectURL(blob),this.setState({clipboardImg:url}),void(this.blob=blob)}}}},{key:"onClearClipboardImg",value:function onClearClipboardImg(){this.setState({clipboardImg:""}),this.props.setInputHeight(40),this.textarea.value="",this.setState({inputValue:""}),this.textarea.style.height="40px",this.blob=null}},{key:"onLoadClipboardImg",value:function onLoadClipboardImg(){this.props.setInputHeight(this.refs.cbimg.height+5)}},{key:"onTextareaBlur",value:function onTextareaBlur(){this.textarea.value||this.setState({placeholderVisible:!0})}},{key:"setTextareaFocus",value:function setTextareaFocus(){this.textarea.focus()}},{key:"render",value:function render(){var _this6=this,_props5=this.props,activeContact=_props5.activeContact,imcore=_props5.imcore,actions=_props5.actions,dialog=_props5.dialog,sendMsg=_props5.sendMsg,_state2=this.state,emojiActive=_state2.emojiActive,historyActive=_state2.historyActive,inputData=_state2.inputData,messageVisible=_state2.messageVisible;return _react2["default"].createElement("div",{className:"chat-form"},_react2["default"].createElement("div",{className:"top-options clearfix"},sendMsg.fileRefresh&&_react2["default"].createElement("div",{className:(0,_classnames2["default"])({"upload-wrap":!0})},_react2["default"].createElement("input",{id:"uploadImg",name:"file",type:"file",ref:function ref(dom){sendMsg.pictureDom=dom},className:"file",onChange:function onChange(){return _this6.onImageFileChange()}}),_react2["default"].createElement("input",{id:"uploadShim",className:"hide"}),_react2["default"].createElement("a",{href:"javascript:;",ref:function ref(dom){_this6.iconSendPicDom=dom},onClick:function onClick(){_this6.onIconSendPicClick()}},_react2["default"].createElement("em",{className:"webim-icons16 icons16-picture"}))),_react2["default"].createElement("div",{className:(0,_classnames2["default"])({"emoji-wrap":!0,"emoji-wrap-ie9":this.ie9})},_react2["default"].createElement("em",{onClick:function onClick(e){return _this6.toggleEmoji(e)},className:(0,_classnames2["default"])({"webim-icons16":!0,"icons16-smile":emojiActive===!1,"icons16-smile-orange":emojiActive===!0}),ref:function ref(dom){_this6.emojiEntrance=dom}}),_react2["default"].createElement("ul",{className:(0,_classnames2["default"])({hide:emojiActive===!1})},emotionArr.map(function(emotion,index){return _react2["default"].createElement("li",{key:index,onClick:function onClick(){return _this6.selectEmotion(emotion)}},_react2["default"].createElement("img",{src:emotion.url,alt:""}))}))),_react2["default"].createElement(_addTlog.Atlog,{
href:"javascript:;",className:"link-history",onClick:function onClick(){return actions.showHistory(imcore)},pushStr:this.config.tlogs.CLICK_HISTORY_ICON,onMouseEnter:function onMouseEnter(){_this6.activeHistory()},onMouseLeave:function onMouseLeave(){return _this6.disactiveHistory()}},_react2["default"].createElement("em",{className:(0,_classnames2["default"])({"webim-icons16":!0,"icons16-history-gray":historyActive===!1,"icons16-history-orange":historyActive===!0})})," 历史消息"),this.renderCustomBtn()),_react2["default"].createElement("div",{className:"fake-textarea",ref:function ref(dom){_this6.fakeDom=dom}},this.state.inputValue),_react2["default"].createElement("div",{className:(0,_classnames2["default"])({"clipboard-img-wrap":!0,hide:""===this.state.clipboardImg})},_react2["default"].createElement("a",{href:"javascript:;",className:"close-btn",onClick:function onClick(){return _this6.onClearClipboardImg()}},"×"),_react2["default"].createElement("img",{src:this.state.clipboardImg,onLoad:function onLoad(){_this6.onLoadClipboardImg()},ref:"cbimg"})),_react2["default"].createElement("div",{className:"relative"},_react2["default"].createElement("textarea",{maxLength:"800",className:(0,_classnames2["default"])({textarea:!0,hide:""!==this.state.clipboardImg}),placeholder:"h"===imcore.env?"说点什么…":"说点什么…（为了您的个人隐私安全，请不要轻易向对方泄露您的联系方式）",onChange:function onChange(e){return _this6.handleChange(e)},onKeyDown:function onKeyDown(e){_this6.handleKeyDown(e)},ref:function ref(input){_this6.textarea=input},onBlur:function onBlur(){return _this6.onTextareaBlur()}}),this.ie9&&_react2["default"].createElement("div",{className:(0,_classnames2["default"])({"ie9-placeholder":!0,hide:!this.state.placeholderVisible}),onClick:function onClick(){_this6.setTextareaFocus()}},"h"===imcore.env?"说点什么…":"说点什么…（为了您的个人隐私安全，请不要轻易向对方泄露您的联系方式）")),_react2["default"].createElement("div",{className:(0,_classnames2["default"])({"send-wrap":!0,"send-disabled":this.state.sending})},_react2["default"].createElement(_addTlog.Atlog,{className:"btn-send",href:"javascript:;",pushStr:this.config.tlogs.CLICK_SEND_BTN,onClick:function onClick(){return _this6.sendHandler()}},"发送"),_react2["default"].createElement("span",{ref:function ref(dom){_this6.sendBtnDom=dom},onClick:function onClick(){_this6.openMessage(messageVisible)}},_react2["default"].createElement("em",null)),_react2["default"].createElement("div",{ref:function ref(dom){_this6.userSettingDom=dom},className:(0,_classnames2["default"])("dialog-setting-box",{hide:!this.state.messageVisible})},_react2["default"].createElement("ul",null,_react2["default"].createElement("li",{onClick:function onClick(){_this6.setMessage(!0)}},_react2["default"].createElement("em",{className:(0,_classnames2["default"])("webim-icons16",{"icons16-radio":!dialog,"icons16-radio-checked":dialog})}),"按Enter发送消息"),_react2["default"].createElement("li",{onClick:function onClick(){_this6.setMessage(!1)}},_react2["default"].createElement("em",{className:(0,_classnames2["default"])("webim-icons16",{"icons16-radio":dialog,"icons16-radio-checked":!dialog})}),"按Ctrl+Enter发送消息")))))}}]),ChatForm}(_react.Component),mapStateToProps=function mapStateToProps(state){return{activeContact:state.panel.activeContact,setting:state.setting.setting,dialog:state.setting.setting.dialog,sendMsg:state.sendMsg}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.historyActions,_actions.messageActions,_actions.settingActions,_actions.userSettingActions),dispatch),dispatch:dispatch}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(ChatForm)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function Btitle(props){var imcore=props.imcore,activeContact=props.activeContact,titlePushStr=props.titlePushStr;switch(activeContact.oppositeImUserType){case"0":return _react2["default"].createElement("div",null,_react2["default"].createElement(_addTlog.Atlog,{href:"https://lpt.liepin.com/resume/showresumecarte4im?usercId="+activeContact.oppositeUserId+"&oppositeImId="+activeContact.oppositeImId,target:"_blank",className:"link-img",pushStr:titlePushStr},_react2["default"].createElement("img",{src:"//image0.lietou-static.com/normal/"+activeContact.oppositeUserPhoto,className:"tinyFace circle"})),_react2["default"].createElement("div",{className:"target-info"},_react2["default"].createElement("h3",null,_react2["default"].createElement(_addTlog.Atlog,{href:"https://lpt.liepin.com/resume/showresumecarte4im?usercId="+activeContact.oppositeUserId+"&oppositeImId="+activeContact.oppositeImId,target:"_blank",pushStr:titlePushStr},activeContact.oppositeUserName),_react2["default"].createElement("span",{className:"job-info"},activeContact.oppositeUserSexName?_react2["default"].createElement("em",null,activeContact.oppositeUserSexName):"",activeContact.oppositeUserEdulevelName?_react2["default"].createElement("em",null,activeContact.oppositeUserEdulevelName):"",_react2["default"].createElement("em",null,"工作",activeContact.oppositeWorkAge,"年"),_react2["default"].createElement("em",{title:activeContact.oppositeUserDqName},(0,_utils.getBrief)(activeContact.oppositeUserDqName,4)))),_react2["default"].createElement("p",{className:"title-company"},_react2["default"].createElement(_addTlog.Atlog,{href:"https://lpt.liepin.com/resume/showresumecarte4im?usercId="+activeContact.oppositeUserId+"&oppositeImId="+activeContact.oppositeImId,target:"_blank",pushStr:titlePushStr},_react2["default"].createElement("span",null,_react2["default"].createElement("i",null,(0,_utils.getBrief)(activeContact.oppositeUserTitle,10)),_react2["default"].createElement("i",null,"|"),_react2["default"].createElement("i",null,(0,_utils.getBrief)(activeContact.oppositeUserCompany,15))))),_react2["default"].createElement("p",{className:"homepage"},_react2["default"].createElement(_addTlog.Atlog,{href:"https://lpt.liepin.com/resume/showresumecarte4im?usercId="+activeContact.oppositeUserId+"&oppositeImId="+activeContact.oppositeImId,target:"_blank",pushStr:titlePushStr},"查看简历")),_react2["default"].createElement(_Shield2["default"],{imcore:imcore})));case"3":return _react2["default"].createElement("div",{style:{minHeight:50}},_react2["default"].createElement(_addTlog.Atlog,{className:"link-img",pushStr:titlePushStr},_react2["default"].createElement("img",{src:"//image0.lietou-static.com/normal/"+activeContact.oppositeUserPhoto,className:"tinyFace circle"})),_react2["default"].createElement("div",{className:"target-info"},_react2["default"].createElement("h3",null,_react2["default"].createElement(_addTlog.Atlog,{pushStr:titlePushStr},activeContact.oppositeUserName))))}}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_config,_config2,_utils,_addTlog,_constants,_dragResize,_actions,_redux,_reactRedux,_ChatTitleHattention,_ChatTitleHattention2,_ChatTitleCattention,_ChatTitleCattention2,_UserSetting,_UserSetting2,_Shield,_Shield2,ChatTitle,mapStateToProps,mapDispatchToProps,ChatTitle1;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),exports.Btitle=Btitle,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_utils=__webpack_require__(180),_addTlog=__webpack_require__(182),_constants=__webpack_require__(156),_dragResize=__webpack_require__(250),_actions=__webpack_require__(173),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),__webpack_require__(254),_ChatTitleHattention=__webpack_require__(255),_ChatTitleHattention2=_interopRequireDefault(_ChatTitleHattention),_ChatTitleCattention=__webpack_require__(257),_ChatTitleCattention2=_interopRequireDefault(_ChatTitleCattention),_UserSetting=__webpack_require__(258),_UserSetting2=_interopRequireDefault(_UserSetting),_Shield=__webpack_require__(259),_Shield2=_interopRequireDefault(_Shield),ChatTitle=function(_Component){function ChatTitle(props){_classCallCheck(this,ChatTitle);var _this=_possibleConstructorReturn(this,(ChatTitle.__proto__||Object.getPrototypeOf(ChatTitle)).call(this,props));return _this.config=(0,_config2["default"])(props.imcore.env),_this}return _inherits(ChatTitle,_Component),_createClass(ChatTitle,[{key:"componentDidMount",value:function componentDidMount(){var actions=this.props.actions,_refs=this.refs,usersettingBtn=_refs.usersettingBtn,usersettingBOX=_refs.usersettingBOX;$(document).on("click.usersetting",function(e){e.target!==usersettingBtn&&0===$(usersettingBtn).has(e.target).length&&0===$(usersettingBOX).has(e.target).length&&actions.hideUserSetting()})}},{key:"componentWillUnmount",value:function componentWillUnmount(){$(document).off("click.usersetting")}},{key:"userSettingVisible",value:function userSettingVisible(status){var _props=this.props,imcore=_props.imcore,actions=_props.actions;status?actions.hideUserSetting():actions.showUserSetting()}},{key:"closeDialog",value:function closeDialog(){var _props2=this.props,imcore=_props2.imcore,actions=_props2.actions;actions.hideUserSetting()}},{key:"render",value:function render(){var _this2=this,env=this.props.imcore.env.toLowerCase(),config=(0,_config2["default"])(env),_props3=this.props,activeContact=_props3.activeContact,style=_props3.style,_onMouseDown=_props3.onMouseDown,historyVisible=_props3.historyVisible,dialogVisible=_props3.dialogVisible,inBlack=_props3.inBlack,rootClassName=(0,_classnames2["default"])({"chat-title":!0,blur:historyVisible}),titlePushStr=void 0;if(!activeContact)return _react2["default"].createElement("div",{className:rootClassName},"没有聊天信息");switch(env){case"c":return titlePushStr=config.tlogs.OPEN_CPAGE,activeContact.oppositeUserKind==_constants.UserType.USER_TYPE_B?titlePushStr=config.tlogs.OPEN_BPAGE:activeContact.oppositeUserKind==_constants.UserType.USER_TYPE_H&&(titlePushStr=config.tlogs.OPEN_HPAGE),_react2["default"].createElement("div",{className:rootClassName,style:style,onMouseDown:function onMouseDown(e){return _onMouseDown(e)}},_react2["default"].createElement(_addTlog.Atlog,{href:activeContact.oppositeMainUrl,target:"_blank",className:"link-img",pushStr:titlePushStr},_react2["default"].createElement("img",{src:"//image0.lietou-static.com/normal/"+activeContact.oppositeUserPhoto,className:"tinyFace circle"})),_react2["default"].createElement("div",{className:"target-info"},_react2["default"].createElement("h3",null,_react2["default"].createElement(_addTlog.Atlog,{href:activeContact.oppositeMainUrl,target:"_blank",pushStr:titlePushStr},activeContact.oppositeUserName),activeContact.oppositeUserKind==_constants.UserType.USER_TYPE_B&&_react2["default"].createElement("em",{className:"webim-icons24 icons24-hr"}),activeContact.oppositeUserKind==_constants.UserType.USER_TYPE_H&&_react2["default"].createElement("em",{className:"webim-icons24 icons24-lietou"}),_react2["default"].createElement("a",{ref:"usersettingBtn",onClick:function onClick(){return _this2.userSettingVisible(dialogVisible)},href:"javascript:;",className:"usersetting-btn"},_react2["default"].createElement("em",null)),_react2["default"].createElement("div",{ref:"usersettingBOX"},_react2["default"].createElement(_UserSetting2["default"],{imcore:imcore}))),_react2["default"].createElement("p",{className:"title-company"},_react2["default"].createElement(_addTlog.Atlog,{href:activeContact.oppositeMainUrl,target:"_blank",pushStr:titlePushStr},(0,_utils.getBrief)(activeContact.oppositeUserCompany,15))),_react2["default"].createElement("p",{className:"homepage"},_react2["default"].createElement(_addTlog.Atlog,{href:activeContact.oppositeMainUrl,target:"_blank",pushStr:titlePushStr},"查看主页")),activeContact.oppositeUserKind==_constants.UserType.USER_TYPE_H&&_react2["default"].createElement(_ChatTitleCattention2["default"],{imcore:imcore,oppositeImId:activeContact.oppositeImId,uid:activeContact.oppositeUserId})));case"b":return _react2["default"].createElement("div",{className:rootClassName,style:style,onMouseDown:function onMouseDown(e){return _onMouseDown(e)}},_react2["default"].createElement(Btitle,{activeContact:activeContact,titlePushStr:titlePushStr,imcore:imcore}));case"h":return titlePushStr=config.tlogs.CLICK_DIALOG_RESUMEBTN,_react2["default"].createElement("div",{className:rootClassName,style:style,onMouseDown:function onMouseDown(e){return _onMouseDown(e)}},_react2["default"].createElement(_addTlog.Atlog,{href:"https://h.liepin.com/im/showresumedetail4im/?oppositeImId="+activeContact.oppositeImId,target:"_blank",className:"link-img",pushStr:titlePushStr},_react2["default"].createElement("img",{src:"//image0.lietou-static.com/normal/"+activeContact.oppositeUserPhoto,className:"tinyFace circle"})),_react2["default"].createElement("div",{className:"target-info"},_react2["default"].createElement("h3",null,_react2["default"].createElement(_addTlog.Atlog,{href:"https://h.liepin.com/im/showresumedetail4im/?oppositeImId="+activeContact.oppositeImId,target:"_blank",pushStr:config.tlogs.CLICK_DIALOG_CONTACTSINFO},activeContact.oppositeUserName),_react2["default"].createElement("span",{className:"job-info"},activeContact.oppositeUserSexName?_react2["default"].createElement("em",null,activeContact.oppositeUserSexName):"",activeContact.oppositeUserEdulevelName?_react2["default"].createElement("em",null,activeContact.oppositeUserEdulevelName):"",_react2["default"].createElement("em",null,"工作",activeContact.oppositeWorkAge,"年"),_react2["default"].createElement("em",{title:activeContact.oppositeUserDqName},(0,_utils.getBrief)(activeContact.oppositeUserDqName,4)))),_react2["default"].createElement("p",{className:"title-company"},_react2["default"].createElement(_addTlog.Atlog,{href:"https://h.liepin.com/im/showresumedetail4im/?oppositeImId="+activeContact.oppositeImId,target:"_blank",pushStr:config.tlogs.CLICK_DIALOG_CONTACTSINFO},_react2["default"].createElement("span",null,_react2["default"].createElement("i",null,(0,_utils.getBrief)(activeContact.oppositeUserTitle,10)),_react2["default"].createElement("i",null,"|"),_react2["default"].createElement("i",null,(0,_utils.getBrief)(activeContact.oppositeUserCompany,15))))),_react2["default"].createElement("p",{className:"homepage"},_react2["default"].createElement(_addTlog.Atlog,{href:"https://h.liepin.com/im/showresumedetail4im/?oppositeImId="+activeContact.oppositeImId,target:"_blank",pushStr:titlePushStr},"查看简历")),_react2["default"].createElement("div",{className:"attention-wrap"},_react2["default"].createElement(_ChatTitleHattention2["default"],{imcore:imcore}))))}}}]),ChatTitle}(_react.Component),mapStateToProps=function mapStateToProps(state){return{historyVisible:state.history.visible,dialogVisible:state.userSetting.dialogVisible,inBlack:state.shield.inBlack}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.dragActions,_actions.userSettingActions),dispatch)}},ChatTitle1=(0,_dragResize.drag)()(ChatTitle),exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(ChatTitle1)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){var newObj,key;if(obj&&obj.__esModule)return obj;if(newObj={},null!=obj)for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_config,_config2,_actions,_addTlog,_redux,_ActionType,ActionType,_utils,_reactRedux,ChatTitleHattention,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_actions=__webpack_require__(173),_addTlog=__webpack_require__(182),_redux=__webpack_require__(120),_ActionType=__webpack_require__(143),ActionType=_interopRequireWildcard(_ActionType),_utils=__webpack_require__(180),_reactRedux=__webpack_require__(134),__webpack_require__(256),ChatTitleHattention=function(_Component){function ChatTitleHattention(props){_classCallCheck(this,ChatTitleHattention);var _this=_possibleConstructorReturn(this,(ChatTitleHattention.__proto__||Object.getPrototypeOf(ChatTitleHattention)).call(this,props));return _this.config=(0,_config2["default"])(props.imcore.env),_this.state={showHdrop:!1},_this}return _inherits(ChatTitleHattention,_Component),_createClass(ChatTitleHattention,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;$(document).on("click.showAttention",function(e){return!(e.target===_this2.attentionBtn||e.target===_this2.attentionSelect||$(_this2.attentionSelect).has(e.target).length>0)&&void _this2.closeAttentionDrop()})}},{key:"componentWillUnmount",value:function componentWillUnmount(){$(document).off("click.showAttention")}},{key:"showAttentionDrop",value:function showAttentionDrop(e){e.nativeEvent.stopImmediatePropagation(),this.setState({showHdrop:!0})}},{key:"closeAttentionDrop",value:function closeAttentionDrop(){this.setState({showHdrop:!1})}},{key:"attention",value:function attention(e){e.stopPropagation();var _props=this.props,imcore=_props.imcore,actions=_props.actions,dispatch=_props.dispatch,activeContact=_props.activeContact;window.tlog=window.tlog||[],tlog.push(this.config.tlogs.ATTENTION_BTN),Apps.Attention&&Apps.Attention.add({ids:this.props.activeContact.usercEncodeId},function(){actions.updateHattention(imcore,!0)})}},{key:"cancelAttention",value:function cancelAttention(e){var _props2,imcore,actions,dispatch,activeContact,_this3=this;e.stopPropagation(),_props2=this.props,imcore=_props2.imcore,actions=_props2.actions,dispatch=_props2.dispatch,activeContact=_props2.activeContact,window.tlog=window.tlog||[],tlog.push(this.config.tlogs.CANCEL_ATTENTION_BTN),Apps.Attention&&Apps.Attention.remove(this.props.activeContact.usercEncodeId,function(){_this3.setState({showHdrop:!1}),actions.updateHattention(imcore,!1)})}},{key:"changeGroup",value:function changeGroup(e){e.stopPropagation(),Apps.Attention.add({ids:this.props.activeContact.usercEncodeId,mend:!0},function(){})}},{key:"render",value:function render(){var _this4=this,activeContact=this.props.activeContact;return _react2["default"].createElement("div",{className:"attention-wrap"},_react2["default"].createElement(_addTlog.Atlog,{href:"javascript:;"},_react2["default"].createElement("em",{ref:function ref(dom){_this4.attentionBtn=dom},"data-uid":activeContact.usercEncodeId,className:(0,_classnames2["default"])("btn-controller","btn-attention",{"btn-attention-add":!activeContact.isAttention,"btn-attention-cancel":activeContact.isAttention}),"data-selector":"attention",onClick:activeContact.isAttention?function(e){return _this4.showAttentionDrop(e)}:function(e){return _this4.attention(e)}},activeContact.isAttention?"取消关注":"关注")),this.state.showHdrop?_react2["default"].createElement("section",{ref:function ref(dom){_this4.attentionSelect=dom},className:"attention-drop"},_react2["default"].createElement("a",{href:"javascript:;",className:"change-group",onClick:function onClick(e){return _this4.changeGroup(e)}},"调整分组"),_react2["default"].createElement("a",{href:"javascript:;",className:"cancel-attention",onClick:function onClick(e){return _this4.cancelAttention(e)}},"取消关注")):"")}}]),ChatTitleHattention}(_react.Component),mapStateToProps=function mapStateToProps(state){return{activeContact:state.panel.activeContact}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.panelActions),dispatch),dispatch:dispatch}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(ChatTitleHattention)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _createClass,_react,_react2,_classnames,_classnames2,_config,_config2,_addTlog,_reactRedux,ChatTitleCattention;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_addTlog=__webpack_require__(182),_reactRedux=__webpack_require__(134),ChatTitleCattention=function(_Component){function ChatTitleCattention(props){_classCallCheck(this,ChatTitleCattention);var _this=_possibleConstructorReturn(this,(ChatTitleCattention.__proto__||Object.getPrototypeOf(ChatTitleCattention)).call(this,props));return _this.config=(0,_config2["default"])(props.imcore.env),_this}return _inherits(ChatTitleCattention,_Component),_createClass(ChatTitleCattention,[{key:"componentDidMount",value:function componentDidMount(){this.initAttention(this.props)}},{key:"initAttention",value:function initAttention(props){LT.Attention=LT.Attention||Apps.Attention,LT.Attention.get(props.uid)}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){this.initAttention(nextProps)}},{key:"attention",value:function attention(e){var _props=this.props,imcore=_props.imcore,uid=_props.uid,that=this;window.tlog=window.tlog||[],$('#im-root [data-selector="attention"]').hasClass("btn-attention-cancel")?(tlog.push(that.config.tlogs.ATTENTION_BTN),LT.Attention.remove(uid)):(tlog.push(that.config.tlogs.CANCEL_ATTENTION_BTN),LT.Attention.add(uid))}},{key:"render",value:function render(){var _this2=this,uid=this.props.uid;return _react2["default"].createElement(_addTlog.Atlog,{href:"javascript:;","data-uid":uid,className:"btn-controller btn-attention btn-attention-add","data-selector":"attention",ref:"attention",onClick:function onClick(){return _this2.attention()}},"关注")}}]),ChatTitleCattention}(_react.Component),exports["default"]=(0,_reactRedux.connect)(null,null)(ChatTitleCattention)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_actions,_constants,_Dialog,_Shield,_Shield2,_Report,_Report2,UserSetting,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_actions=__webpack_require__(173),_constants=__webpack_require__(156),_Dialog=__webpack_require__(119),_Shield=__webpack_require__(259),_Shield2=_interopRequireDefault(_Shield),_Report=__webpack_require__(260),_Report2=_interopRequireDefault(_Report),__webpack_require__(261),UserSetting=function(_Component){function UserSetting(props){return _classCallCheck(this,UserSetting),_possibleConstructorReturn(this,(UserSetting.__proto__||Object.getPrototypeOf(UserSetting)).call(this,props))}return _inherits(UserSetting,_Component),_createClass(UserSetting,[{key:"componentDidMount",value:function componentDidMount(){}},{key:"render",value:function render(){var _props=this.props,imcore=_props.imcore,actions=_props.actions,activeContact=_props.activeContact,dialogVisible=_props.dialogVisible;return _react2["default"].createElement("div",{ref:"usersettingBtn",className:(0,_classnames2["default"])("shield-box",{hide:!dialogVisible})},activeContact.oppositeUserKind!=_constants.UserType.USER_TYPE_B&&_react2["default"].createElement(_Shield2["default"],{imcore:imcore}),"c"===imcore.env&&_react2["default"].createElement(_Report2["default"],{imcore:imcore}))}}]),UserSetting}(_react.Component),mapStateToProps=function mapStateToProps(state){return{activeContact:state.panel.activeContact,dialogVisible:state.userSetting.dialogVisible}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.userSettingActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(UserSetting)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_actions,_constants,_Dialog,_constants2,_config,_config2,Shield,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor);
}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_actions=__webpack_require__(173),_constants=__webpack_require__(156),_Dialog=__webpack_require__(119),_constants2=__webpack_require__(212),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),Shield=function(_Component){function Shield(props){_classCallCheck(this,Shield);var _this=_possibleConstructorReturn(this,(Shield.__proto__||Object.getPrototypeOf(Shield)).call(this,props));return _this.state={tipDialog:!1},_this}return _inherits(Shield,_Component),_createClass(Shield,[{key:"componentDidMount",value:function componentDidMount(){var _props=this.props,imcore=_props.imcore,actions=_props.actions,activeContact=_props.activeContact,inBlack=_props.inBlack}},{key:"setBlack",value:function setBlack(){var that=this,_props2=this.props,imcore=_props2.imcore,actions=_props2.actions,activeContact=_props2.activeContact,inBlack=_props2.inBlack,dialog=_props2.dialog,tipDialog=this.state.tipDialog;inBlack?"c"===imcore.env?actions.removeBlack(imcore,activeContact,inBlack,function(){actions.hideUserSetting(),actions.changeText(imcore,inBlack)}):"b"===imcore.env&&(window.tlog=window.tlog||[],tlog.push((0,_config2["default"])(imcore.env).tlogs.SHIELD_MSG_RELIVE),!LT.Cookie.get(_constants2.enums.COOKIE_KEY_DELETESHIELD)||eval(LT.Cookie.get(_constants2.enums.COOKIE_KEY_DELETESHIELD))?(actions.openDialog(),this.setState({tipDialog:!1})):actions.removeBlack(imcore,activeContact,inBlack,function(){actions.hideUserSetting(),actions.changeText(imcore,inBlack)})):("b"===imcore.env&&(window.tlog=window.tlog||[],tlog.push((0,_config2["default"])(imcore.env).tlogs.SHIELD_MSG)),!LT.Cookie.get(_constants2.enums.COOKIE_KEY_SHIELD)||eval(LT.Cookie.get(_constants2.enums.COOKIE_KEY_SHIELD))?(actions.openDialog(),this.setState({tipDialog:!1})):actions.addBlack(imcore,activeContact,inBlack,function(){actions.hideUserSetting(),actions.changeText(imcore,inBlack)}))}},{key:"toggleBlack",value:function toggleBlack(){var _tlog,that=this,_props3=this.props,imcore=_props3.imcore,actions=_props3.actions,activeContact=_props3.activeContact,inBlack=_props3.inBlack;"b"===imcore.env&&(_tlog=inBlack?(0,_config2["default"])(imcore.env).tlogs.SHIELD_MSG_WINDOW:(0,_config2["default"])(imcore.env).tlogs.SHIELD_MSG_RELIVE_WINDOW,window.tlog=window.tlog||[],window.tlog.push((0,_config2["default"])(imcore.env).tlogs.SHIELD_MSG)),inBlack?actions.removeBlack(imcore,activeContact,inBlack,function(){actions.hideUserSetting()}):actions.addBlack(imcore,activeContact,inBlack,function(){actions.hideUserSetting()}),actions.changeText(imcore,inBlack)}},{key:"shieldDialogTips",value:function shieldDialogTips(){var _props4=this.props,imcore=_props4.imcore,actions=_props4.actions,activeContact=_props4.activeContact,inBlack=_props4.inBlack,text=void 0;return"c"===imcore.env?activeContact.oppositeUserKind==_constants.UserType.USER_TYPE_H?text="屏蔽后，你将无法应聘对方发布的职位，对方将不能查看你的简历信息以及给你发送消息。":activeContact.oppositeUserKind==_constants.UserType.USER_TYPE_C&&(text="屏蔽后，将解除双方现有关系，对方将不能给你发消息。"):"b"===imcore.env&&(text=inBlack?"是否确认解除对该候选职聊消息的屏蔽？":"屏蔽后您将不会再收到候选人的职聊信息！"),text}},{key:"showShielddialog",value:function showShielddialog(status){var _props5=this.props,imcore=_props5.imcore,inBlack=_props5.inBlack;this.setState({tipDialog:!status}),inBlack?LT.Cookie.set(_constants2.enums.COOKIE_KEY_DELETESHIELD,status,360,"/"):LT.Cookie.set(_constants2.enums.COOKIE_KEY_SHIELD,status,360,"/")}},{key:"closeShieldDialog",value:function closeShieldDialog(){var _props6=this.props,imcore=_props6.imcore,actions=_props6.actions,activeContact=_props6.activeContact,inBlack=_props6.inBlack,dialogVisible=_props6.dialogVisible;actions.closeDialog(),actions.hideUserSetting()}},{key:"render",value:function render(){var _this2=this,_props7=this.props,imcore=_props7.imcore,actions=_props7.actions,activeContact=_props7.activeContact,inBlack=_props7.inBlack,dialogVisible=_props7.dialogVisible,tipDialog=this.state.tipDialog;return _react2["default"].createElement("a",{className:(0,_classnames2["default"])({"btn-controller":"b"===imcore.env,"sheild-resume":"b"===imcore.env}),href:"javascript:;",onClick:function onClick(){return _this2.setBlack()}},inBlack?"解除屏蔽":"c"===imcore.env?"屏蔽":"屏蔽消息",_react2["default"].createElement(_Dialog.ChatDialog,{id:"shield",visible:dialogVisible,onClose:function onClose(){_this2.closeShieldDialog()},header:!0,backBtn:!1,footer:!1,title:"温馨提示",position:"bottom",width:"100%"},_react2["default"].createElement("div",{className:"shield-dialog-box"},_react2["default"].createElement("p",{className:"text-center"},this.shieldDialogTips()),_react2["default"].createElement("div",{className:"btns-group"},_react2["default"].createElement("label",{onClick:function onClick(){return _this2.showShielddialog(tipDialog)}},_react2["default"].createElement("em",{className:(0,_classnames2["default"])("webim-icons16",{"icons16-checkbox":!tipDialog,"icons16-checkbox-checked":tipDialog})}),"不再显示"),_react2["default"].createElement("a",{href:"javascript:;",onClick:function onClick(){return _this2.toggleBlack()},className:"btn btn-primary btn-mini"},"c"===imcore.env?"确认屏蔽":inBlack?"解除屏蔽":"确认屏蔽")))))}}]),Shield}(_react.Component),mapStateToProps=function mapStateToProps(state){return{activeContact:state.panel.activeContact,inBlack:state.shield.inBlack,dialogVisible:state.shield.dialogVisible}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.shieldActions,_actions.userSettingActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Shield)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_actions,_constants,_Dialog,_constants2,Report,msgListFilterByContact,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_actions=__webpack_require__(173),_constants=__webpack_require__(156),_Dialog=__webpack_require__(119),_constants2=__webpack_require__(212),Report=function(_Component){function Report(props){_classCallCheck(this,Report);var _this=_possibleConstructorReturn(this,(Report.__proto__||Object.getPrototypeOf(Report)).call(this,props));return _this.state={reportList:[{code:5,text:"虚假信息"},{code:3,text:"广告、非法、色情内容"},{code:7,text:"其他"}]},_this}return _inherits(Report,_Component),_createClass(Report,[{key:"componentDidMount",value:function componentDidMount(){}},{key:"showReportDialog",value:function showReportDialog(){var _props=this.props,imcore=_props.imcore,actions=_props.actions;actions.showReportDialog()}},{key:"closeReportDialog",value:function closeReportDialog(status){var _props2=this.props,imcore=_props2.imcore,actions=_props2.actions;actions.closeReportDialog(function(){actions.hideUserSetting()})}},{key:"setReport",value:function setReport(code){var _props3=this.props,imcore=_props3.imcore,actions=_props3.actions;actions.setReport(code)}},{key:"addReport",value:function addReport(){var that=this,_props4=this.props,imcore=_props4.imcore,actions=_props4.actions,activeContact=_props4.activeContact,reportCode=_props4.reportCode,msgList=_props4.msgList;actions.addReport(imcore,activeContact,reportCode,msgList,function(){that.closeReportDialog()})}},{key:"render",value:function render(){var _this2=this,_props5=this.props,imcore=_props5.imcore,actions=_props5.actions,reportCode=_props5.reportCode,dialogVisible=_props5.dialogVisible,reportList=this.state.reportList;return _react2["default"].createElement("a",{href:"javascript:;",onClick:function onClick(){return _this2.showReportDialog()}},"举报",_react2["default"].createElement(_Dialog.ChatDialog,{id:"report",visible:dialogVisible,onClose:function onClose(){_this2.closeReportDialog()},header:!0,backBtn:!1,footer:!1,title:"请在下方选取您的举报类型",position:"bottom",width:"100%"},_react2["default"].createElement("div",{className:"report-dialog-box"},_react2["default"].createElement("p",null,reportList.map(function(v,i){return _react2["default"].createElement("a",{key:i,className:(0,_classnames2["default"])({active:reportCode===v.code}),onClick:function onClick(){return _this2.setReport(v.code)},href:"javascript:;"},v.text)})),_react2["default"].createElement("div",{className:"btns-group"},_react2["default"].createElement("a",{href:"javascript:;",className:"btn btn-primary btn-mini",onClick:function onClick(){return _this2.addReport()}},"提交举报")))))}}]),Report}(_react.Component),msgListFilterByContact=function msgListFilterByContact(contact,msgList,initialServerHistory,activeContact){var formattedMsgList=msgList.filter(function(v){return v.to===activeContact.oppositeImId}),allArr=initialServerHistory.concat(formattedMsgList);return allArr},mapStateToProps=function mapStateToProps(state){return{activeContact:state.panel.activeContact,reportCode:state.report.reportCode,dialogVisible:state.report.dialogVisible,msgList:msgListFilterByContact(state.panel.activeContact,state.panel.msgList,state.history.initialServerHistory,state.panel.activeContact)}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.reportActions,_actions.userSettingActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Report)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_addTlog,_utils,_classnames,_classnames2,_redux,_reactRedux,_actions,_HistoryMsg,_HistoryMsg2,ChatHistory,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_addTlog=__webpack_require__(182),_utils=__webpack_require__(180),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_actions=__webpack_require__(173),_HistoryMsg=__webpack_require__(263),_HistoryMsg2=_interopRequireDefault(_HistoryMsg),__webpack_require__(267),ChatHistory=function(_Component){function ChatHistory(props){_classCallCheck(this,ChatHistory);var _this=_possibleConstructorReturn(this,(ChatHistory.__proto__||Object.getPrototypeOf(ChatHistory)).call(this,props));return _this.historylistDom=null,_this.ie9=navigator.userAgent.indexOf("MSIE 9.0")>0,_this}return _inherits(ChatHistory,_Component),_createClass(ChatHistory,[{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){var _props=this.props,imcore=_props.imcore,visible=_props.visible,actions=_props.actions,history=_props.history,lastmsgid=_props.lastmsgid,activeContact=_props.activeContact;visible!==nextProps.visible&&nextProps.visible===!0&&actions.getServerHistory(imcore,activeContact),history.length!==nextProps.history.length&&lastmsgid===-1&&this.scrollToBottom()}},{key:"clickMore",value:function clickMore(){var _props2=this.props,actions=_props2.actions,imcore=_props2.imcore,loading=_props2.loading,nomore=_props2.nomore,activeContact=_props2.activeContact;!loading&&actions.getServerHistory(imcore,activeContact)}},{key:"renderMoreLink",value:function renderMoreLink(){var _this2=this,_props3=this.props,loading=_props3.loading,nomore=_props3.nomore,lastmsgid=_props3.lastmsgid;return loading?_react2["default"].createElement("p",{className:"history-loading"},_react2["default"].createElement("em",null)):nomore&&lastmsgid!==-1?_react2["default"].createElement("p",{className:"history-nomore"},"没有更多历史记录"):nomore||loading||lastmsgid===-1?void 0:_react2["default"].createElement("p",{className:"history-more"},_react2["default"].createElement("a",{href:"javascript:;",onClick:function onClick(){return _this2.clickMore()}},"更多历史记录"))}},{key:"scrollToBottom",value:function scrollToBottom(){var _this3=this;setTimeout(function(){_this3.historylistDom&&$(_this3.historylistDom).scrollTop(_this3.historylistDom.scrollHeight)},100)}},{key:"render",value:function render(){var _this4=this,_props4=this.props,visible=_props4.visible,actions=_props4.actions,imcore=_props4.imcore,history=_props4.history,nomore=_props4.nomore,activeContact=_props4.activeContact,style={};return this.ie9&&(style=Object.assign({},{background:"rgba(243,252,255,0.95)"})),_react2["default"].createElement("div",{className:(0,_classnames2["default"])("chat-history",{hide:!visible}),style:style},_react2["default"].createElement("div",{className:"history-content",ref:function ref(dom){_this4.historylistDom=dom}},this.renderMoreLink(),_react2["default"].createElement("div",{className:"history-list"},history.map(function(v,i){return _react2["default"].createElement(_HistoryMsg2["default"],{env:imcore.env.toLowerCase(),message:v,key:v.id,isSend:!0,userInfo:imcore.userInfo,targetInfo:activeContact})}))),0===history.length&&_react2["default"].createElement("div",{className:"no-history"},_react2["default"].createElement("span",null,"暂无历史消息记录")),_react2["default"].createElement("a",{href:"javascript:;",className:"close-history",onClick:function onClick(){actions.hideHistory(imcore)}},"返回聊天页面"))}}]),ChatHistory}(_react.Component),mapStateToProps=function mapStateToProps(state){return{visible:state.history.visible,history:(0,_utils.historyTimeVisibleFormat)(state.history.serverHistory),nomore:state.history.nomore,loading:state.history.loading,lastmsgid:state.history.lastmsgid,activeContact:state.panel.activeContact}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.historyActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(ChatHistory)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function HistoryMsg(props){var env=props.env,userInfo=props.userInfo,targetInfo=props.targetInfo,message=props.message,day=message.day,time=message.time,from=message.from,isSend=from===userInfo.oppositeImId,historyContent=void 0;return historyContent=(0,_history.messageHistoryFilter)(message)?"c"==env?renderContentC(message):"b"==env?renderContentB(message):renderContentH(message):"c"==env?_react2["default"].createElement("div",{className:"content"},_enums.CompatibleExtType.CANNOT_SHOW_CIMG):"b"==env?_react2["default"].createElement("div",{className:"content"},_enums.CompatibleExtType.CANNOT_SHOW_BIMG):_react2["default"].createElement("div",{className:"content"},_enums.CompatibleExtType.CANNOT_SHOW_HIMG),_react2["default"].createElement("div",{className:"historymsg"},day&&_react2["default"].createElement("h4",null,day),_react2["default"].createElement("p",{className:isSend?"send":"receive"},_react2["default"].createElement("label",null,isSend?userInfo.oppositeUserName:targetInfo.oppositeUserNameShow||targetInfo.oppositeUserName),_react2["default"].createElement("time",null,time)),historyContent)}var _react,_react2,_utils,_classnames,_classnames2,_constants,_enums,_history,_imgPreview,_imgPreview2,renderContentC,renderContentB,renderContentH;Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=HistoryMsg,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_utils=__webpack_require__(180),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_constants=__webpack_require__(156),_enums=__webpack_require__(162),_history=__webpack_require__(211),_imgPreview=__webpack_require__(264),_imgPreview2=_interopRequireDefault(_imgPreview),__webpack_require__(266),renderContentC=function renderContentC(message){var data=message.data,type=message.type,extType=message.extType,name=message.name,resumeUrl=message.resumeUrl,senderKind=message.senderKind,company=message.company,dqName=message.dqName,salary=message.salary,title=message.title,jobHref=message.jobHref,jobLabel=void 0;if("img"===type)return _react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("a",{href:"javascript:;",onClick:function onClick(){(0,_imgPreview2["default"])({src:data})},className:"preview-image"},_react2["default"].createElement("img",{src:data})));switch(extType){case _enums.ExtType.MESSAGE_RESUME:return _react2["default"].createElement("div",{className:"content"},"[委托的简历] ",_react2["default"].createElement("a",{href:resumeUrl,target:"_blank"},name+"的简历"));case _enums.ExtType.MESSAGE_SEND_JOB:return jobLabel=senderKind==_constants.UserType.USER_TYPE_C?"[我感兴趣的职位] ":senderKind==_constants.UserType.USER_TYPE_B?"[邀您应聘的职位] ":senderKind==_constants.UserType.USER_TYPE_H?"[为你推荐的职位] ":"[职位] ",_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("div",{className:"job"},_react2["default"].createElement("p",null,jobLabel,_react2["default"].createElement("a",{href:jobHref,target:"_blank"},title,_react2["default"].createElement("span",{className:"text-warning"}," [",salary,"]"))),_react2["default"].createElement("p",null,_react2["default"].createElement("label",null,company),_react2["default"].createElement("label",null,dqName))));case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:if(senderKind==_constants.UserType.USER_TYPE_C)return _react2["default"].createElement("div",{className:"content"},"[您的简历已发送至对方]");if(senderKind==_constants.UserType.USER_TYPE_H)return _react2["default"].createElement("div",{className:"content"},"[应聘的简历] ",_react2["default"].createElement("a",{href:resumeUrl,target:"_blank"},name+"的简历"));break;case _enums.ExtType.MESSAGE_SEND_NAMECARD:return _react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("p",null,"建议您发送简历后再沟通，提高求职效率。"),"[发送名片]");case _enums.ExtType.MESSAGE_ASK_RESUME:return _react2["default"].createElement("div",{className:"content"},"[索要简历]我想要一份你的简历，你是否同意？");case _enums.ExtType.MESSAGE_SEND_RATINGBAR:return _react2["default"].createElement("div",{className:"content"},"[请为猎头服务做出评价]");case _enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK:return _react2["default"].createElement("div",{className:"content"},"[已拒绝推荐职位]");case _enums.ExtType.MESSAGE_SEND_APPLYSUCFEEDBACK:return _react2["default"].createElement("div",{className:"content"},"[已接受推荐职位]");default:return _react2["default"].createElement("div",{className:"content"},data)}},renderContentB=function renderContentB(message){var data=message.data,type=message.type,extType=message.extType,name=message.name,resumeUrl=message.resumeUrl,senderKind=message.senderKind,company=message.company,dqName=message.dqName,dq=message.dq,salary=message.salary,title=message.title,jobHref=message.jobHref,workyear=message.workyear,res_edulevel=message.res_edulevel,jobLabel=void 0;if("img"===type)return _react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("a",{href:"javascript:;",onClick:function onClick(){(0,_imgPreview2["default"])({src:data})},className:"preview-image"},_react2["default"].createElement("img",{src:data})));switch(extType){case _enums.ExtType.MESSAGE_SEND_JOB:return jobLabel=senderKind==_constants.UserType.USER_TYPE_C?"[我感兴趣的职位] ":"[邀请您应聘的职位] ",_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("div",{className:"job"},_react2["default"].createElement("p",null,jobLabel,_react2["default"].createElement("a",{href:jobHref,target:"_blank"},title,_react2["default"].createElement("span",{className:"text-warning"}," [",salary,"]"))),_react2["default"].createElement("p",null,_react2["default"].createElement("label",null,company),_react2["default"].createElement("label",null,dqName))));case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:return _react2["default"].createElement("div",{className:"content"},"[应聘的简历] ",_react2["default"].createElement("a",{href:resumeUrl,target:"_blank"},name+"的简历"));case _enums.ExtType.MESSAGE_SEND_NAMECARD:return _react2["default"].createElement("div",{className:"content"},"[发送名片] ",name,"的名片");case _enums.ExtType.MESSAGE_ASK_RESUME:return _react2["default"].createElement("div",{className:"content"},"索要简历的请求已发送");default:return _react2["default"].createElement("div",{className:"content"},data)}},renderContentH=function renderContentH(message){var data=message.data,type=message.type,extType=message.extType,name=message.name,resumeUrl=message.resumeUrl,senderKind=message.senderKind,company=message.company,dqName=message.dqName,dq=message.dq,salary=message.salary,title=message.title,jobHref=message.jobHref,workyear=message.workyear,res_edulevel=message.res_edulevel,jobLabel=void 0;if("img"===type)return _react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("a",{href:"javascript:;",onClick:function onClick(){(0,_imgPreview2["default"])({src:data})},className:"preview-image"},_react2["default"].createElement("img",{src:data})));switch(extType){case _enums.ExtType.MESSAGE_RESUME:return _react2["default"].createElement("div",{className:"content"},"[委托的简历] ",_react2["default"].createElement("a",{href:resumeUrl,target:"_blank"},name+"的简历"));case _enums.ExtType.MESSAGE_SEND_JOB:return jobLabel=senderKind==_constants.UserType.USER_TYPE_C?"[我感兴趣的职位] ":"[职位] ",_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("div",{className:"job"},_react2["default"].createElement("p",null,jobLabel,_react2["default"].createElement("a",{href:jobHref,target:"_blank"},title,_react2["default"].createElement("span",{className:"text-warning"}," [",salary,"]"))),_react2["default"].createElement("p",null,_react2["default"].createElement("label",null,company),_react2["default"].createElement("label",null,dqName))));case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:return _react2["default"].createElement("div",{className:"content"},"[应聘的简历] ",_react2["default"].createElement("a",{href:resumeUrl,target:"_blank"},name+"的简历"));case _enums.ExtType.MESSAGE_SEND_NAMECARD:return _react2["default"].createElement("div",{className:"content"},"[发送名片] ",name,"的名片");case _enums.ExtType.MESSAGE_ASK_RESUME:return _react2["default"].createElement("div",{className:"content"},"索要简历的请求已发送");case _enums.ExtType.MESSAGE_SEND_RATINGBAR:return _react2["default"].createElement("div",{className:"content"},"[请为猎头服务做出评价]");case _enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK:return _react2["default"].createElement("div",{className:"content"},"[已拒绝推荐职位]");case _enums.ExtType.MESSAGE_SEND_APPLYSUCFEEDBACK:return _react2["default"].createElement("div",{className:"content"},"[已接受推荐职位]");default:return _react2["default"].createElement("div",{className:"content"},data)}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function imgPreview(props){var _onClose,_props$parent=props.parent,parent=void 0===_props$parent?"panel":_props$parent,$dialog=$("#im-image-preview-dialog");$dialog.length||($dialog=$('<div id="im-image-preview-dialog"></div>'),$dialog.appendTo("body")),_onClose=function _onClose(){$dialog.length&&ReactDOM.unmountComponentAtNode($dialog[0])},ReactDOM.render(_react2["default"].createElement(ImgContent,_extends({onClose:function onClose(){return _onClose()}},props)),$dialog[0])}var _extends,_createClass,_react,_react2,ImgContent;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),exports["default"]=imgPreview,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),__webpack_require__(265),ImgContent=function(_Component){function ImgContent(props){return _classCallCheck(this,ImgContent),_possibleConstructorReturn(this,(ImgContent.__proto__||Object.getPrototypeOf(ImgContent)).call(this,props))}return _inherits(ImgContent,_Component),_createClass(ImgContent,[{key:"componentDidMount",value:function componentDidMount(){}},{key:"componentWillUnMount",value:function componentWillUnMount(){}},{key:"render",value:function render(){var _props=this.props,src=_props.src,onClose=_props.onClose;return _react2["default"].createElement("div",{className:"im-image-preview-container"},_react2["default"].createElement("a",{className:"close-preview",href:"javascript:;",onClick:function onClick(){onClose()}},"×"),_react2["default"].createElement("div",{className:"im-image-preview-wrap"},_react2["default"].createElement("img",{src:src})))}}]),ImgContent}(_react.Component)},function(module,exports){},function(module,exports){},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function Err(props){var message=props.message;return _react2["default"].createElement("div",{className:"err-msg",dangerouslySetInnerHTML:{__html:message.data}})}var _extends,_createClass,_react,_react2,_enums,_constants,_history,_actions,_redux,_reactRedux,_classnames,_classnames2,_imgPreview,_imgPreview2,_MsgCards,Message,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_enums=__webpack_require__(162),_constants=__webpack_require__(212),_history=__webpack_require__(211),_actions=__webpack_require__(173),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),
_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_imgPreview=__webpack_require__(264),_imgPreview2=_interopRequireDefault(_imgPreview),__webpack_require__(269),_MsgCards=__webpack_require__(270),Message=function(_Component){function Message(props){return _classCallCheck(this,Message),_possibleConstructorReturn(this,(Message.__proto__||Object.getPrototypeOf(Message)).call(this,props))}return _inherits(Message,_Component),_createClass(Message,[{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){nextProps.message.state!==this.props.message.state&&this.props.scrollToBottom()}},{key:"resendMsg",value:function resendMsg(imcore,message){var sendMsg=this.props.allstate.sendMsg;this.props.actions.resendMsg(imcore,message)}},{key:"rendermessage",value:function rendermessage(ifISend){var _props=this.props,message=_props.message,msgcard=_props.msgcard,extType=message.extType||"",type=message.type,MsgCard=msgcard;return"img"===type?_react2["default"].createElement(_MsgCards.Image,this.props):"err"===type?_react2["default"].createElement(Err,this.props):(0,_history.messageHistoryFilter)(message)?MsgCard?_react2["default"].createElement(MsgCard,_extends({},this.props,{ifISend:ifISend})):_react2["default"].createElement(_MsgCards.Txt,this.props):"c"==imcore.env?_react2["default"].createElement("div",{className:"content"},_enums.CompatibleExtType.CANNOT_SHOW_CIMG):"b"==imcore.env?_react2["default"].createElement("div",{className:"content"},_enums.CompatibleExtType.CANNOT_SHOW_BIMG):_react2["default"].createElement("div",{className:"content"},_enums.CompatibleExtType.CANNOT_SHOW_HIMG)}},{key:"render",value:function render(){var _this2=this,_props2=this.props,message=_props2.message,actions=_props2.actions,imcore=_props2.imcore,activeContact=_props2.activeContact,ifISend=message.from===imcore.userInfo.oppositeImId;return _react2["default"].createElement("div",{className:(0,_classnames2["default"])({message:!0,send:ifISend,receive:!ifISend})},_react2["default"].createElement("div",{className:"header"}),_react2["default"].createElement("div",{className:"body clearfix"},this.rendermessage(ifISend),_react2["default"].createElement("i",{className:(0,_classnames2["default"])({loadingicon:!0,sendloading:ifISend,receiveloading:!ifISend,hide:!message.status})})),_react2["default"].createElement("div",{className:"footer"},message.state==_enums.MsgState.PREPROCESS_FAILED&&_react2["default"].createElement("p",{className:"resend"},_react2["default"].createElement("em",{className:"webim-icons16 icons16-error-red"}),"发送失败，点击 ",message.isClick?_react2["default"].createElement("span",{className:"disabled"},"重新发送"):_react2["default"].createElement("a",{href:"javascript:;",onClick:function onClick(){_this2.resendMsg(imcore,message)}},"重新发送")),message.state===_enums.MsgState.SEND_FAILED&&_react2["default"].createElement("p",{className:"resend"},_react2["default"].createElement("em",{className:"webim-icons16 icons16-error-red"}),"发送失败")))}}]),Message}(_react.Component),mapStateToProps=function mapStateToProps(state){return{allstate:state}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.messageActions,_actions.panelActions,_actions.historyActions),dispatch),dispatch:dispatch}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Message)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _Txt2,_Txt3,_Image2,_Image3;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Image=exports.Txt=void 0,_Txt2=__webpack_require__(271),_Txt3=_interopRequireDefault(_Txt2),_Image2=__webpack_require__(272),_Image3=_interopRequireDefault(_Image2),exports.Txt=_Txt3["default"],exports.Image=_Image3["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function Txt(props){var message=props.message,imcore=props.imcore,str="";return message.data&&(str=message.data.replace(/[<>]/g,function(str){switch(str){case"<":return"&lt;";case">":return"&gt;"}}).replace(/\[[^\[\]]+\]/g,function(str){return _constants.Emotions[str]?'<img class="emoji" src='+_constants.Emotions[str]+" title="+str+">":str||""}).replace(/\n/g,"<br/>")),_react2["default"].createElement("div",{className:"content",dangerouslySetInnerHTML:{__html:str}})}var _constants,_enums,_history,_react,_react2;Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Txt,_constants=__webpack_require__(212),_enums=__webpack_require__(162),_history=__webpack_require__(211),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function Image(props){var message=props.message,scrollToBottom=props.scrollToBottom;return message.state===_enums.MsgState.INITIAL?_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("img",{src:_sending2["default"]})):message.data?_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("a",{href:"javascript:;",onClick:function onClick(){(0,_imgPreview2["default"])({src:message.data})},className:"preview-image"},_react2["default"].createElement("img",{src:message.data,onLoad:function onLoad(){return scrollToBottom()}}))):_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("img",{src:_2["default"],style:{width:36,height:36}}))}var _react,_react2,_constants,_enums,_imgPreview,_imgPreview2,_sending,_sending2,_,_2;Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Image,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_constants=__webpack_require__(212),_enums=__webpack_require__(162),_imgPreview=__webpack_require__(264),_imgPreview2=_interopRequireDefault(_imgPreview),_sending=__webpack_require__(273),_sending2=_interopRequireDefault(_sending),_=__webpack_require__(274),_2=_interopRequireDefault(_)},function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"modules/@liepin/imui/images/sending.gif"},function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"modules/@liepin/imui/images/404.png"},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _createClass,_react,_react2,_redux,_reactRedux,Toast,mapStateToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),__webpack_require__(276),Toast=function(_Component){function Toast(){return _classCallCheck(this,Toast),_possibleConstructorReturn(this,(Toast.__proto__||Object.getPrototypeOf(Toast)).apply(this,arguments))}return _inherits(Toast,_Component),_createClass(Toast,[{key:"render",value:function render(){var _props$toast=this.props.toast,text=_props$toast.text,top=_props$toast.top,show=_props$toast.show,compstyle=Object.assign({},{top:top}),visible="undefined"==typeof show||show?"block":"none",mergedStyles=Object.assign(compstyle,{display:visible});return _react2["default"].createElement("div",null,_react2["default"].createElement("div",{style:mergedStyles,className:"toast"},text))}}]),Toast}(_react.Component),mapStateToProps=function mapStateToProps(state){return{toast:state.toast}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,null)(Toast)},function(module,exports){},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_actions,_SetGreeting,_SetGreeting2,_Dialog,_config,_config2,Setting,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_actions=__webpack_require__(173),__webpack_require__(279),_SetGreeting=__webpack_require__(280),_SetGreeting2=_interopRequireDefault(_SetGreeting),_Dialog=__webpack_require__(119),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),Setting=function(_Component){function Setting(props){_classCallCheck(this,Setting);var _this=_possibleConstructorReturn(this,(Setting.__proto__||Object.getPrototypeOf(Setting)).call(this,props));return _this.state={settingDate:[]},_this.config=(0,_config2["default"])(props.imcore.env),_this}return _inherits(Setting,_Component),_createClass(Setting,[{key:"componentDidMount",value:function componentDidMount(){var _props=this.props,imcore=_props.imcore,actions=_props.actions,setting=_props.setting,show=_props.show,_refs=this.refs,settingDom=_refs.settingDom,greetingBtn=_refs.greetingBtn;actions.settingList(imcore),setting&&this.setState({settingDate:this.settingDate(setting)}),$(document).on("click.setting",function(event){0===$(settingDom).has(event.target).length&&0===$(".link-open-setting").has(event.target).length&&actions.settingShow(!0)})}},{key:"componentWillUnmount",value:function componentWillUnmount(){$(document).off("click.setting")}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){var _props2=this.props,imcore=_props2.imcore,actions=_props2.actions,setting=_props2.setting;this.setState({settingDate:this.settingDate(nextProps.setting)})}},{key:"settingDate",value:function settingDate(options){var imcore=this.props.imcore,settingDataBH=[{title:"消息提醒设置",event:"message",option:[{icon:options.message,text:"接收消息并且提醒",status:!0},{icon:!options.message,text:"接收消息但不提醒",status:!1}]},{title:"对话框设置",event:"dialog",option:[{icon:options.dialog,text:"按Enter发送消息",status:!0},{icon:!options.dialog,text:"按Ctrl+Enter发送消息",status:!1}]}],settingDataC=[{title:"自动打招呼设置",event:"greeting",option:[{icon:options.greeting,text:"开启",status:!0,tips:"设置打招呼语"},{icon:!options.greeting,text:"关闭",status:!1}]}];return"c"===imcore.env?settingDataBH.concat(settingDataC):"b"===imcore.env||"h"===imcore.env?settingDataBH:void 0}},{key:"clickSelect",value:function clickSelect(event,icon){var _props3=this.props,imcore=_props3.imcore,actions=_props3.actions,setting=_props3.setting,greetingType=_props3.greetingType;setting[event]!==icon&&actions.settingSelect(event,icon,setting,imcore,greetingType,this.config.tlogs)}},{key:"showGreeting",value:function showGreeting(status){var _props4=this.props,imcore=_props4.imcore,actions=_props4.actions;status&&(actions.greetingShow(!0),actions.settingShow(!0))}},{key:"closeDialog",value:function closeDialog(){var _props5=this.props,imcore=_props5.imcore,actions=_props5.actions;actions.greetingShow(!1),actions.settingShow(!1)}},{key:"render",value:function render(){var _this2=this,_props6=this.props,imcore=_props6.imcore,actions=_props6.actions,setting=_props6.setting,show=_props6.show,setGreetingShow=_props6.setGreetingShow,settingDate=this.state.settingDate;return _react2["default"].createElement("div",{className:(0,_classnames2["default"])("set-box",{hide:!show}),ref:"settingDom"},setting&&settingDate.map(function(v,i){return _react2["default"].createElement("dl",{key:i},_react2["default"].createElement("dt",null,v.title),v.option&&v.option.map(function(m,n){return _react2["default"].createElement("dd",{key:n},_react2["default"].createElement("label",{onClick:function onClick(){return _this2.clickSelect(v.event,m.status)}},_react2["default"].createElement("em",{className:(0,_classnames2["default"])("webim-icons16",{"icons16-radio":!m.icon,"icons16-radio-checked":m.icon})}),m.text),m.tips&&_react2["default"].createElement("a",{ref:"greetingBtn",onClick:function onClick(){return _this2.showGreeting(m.icon)},className:(0,_classnames2["default"])({muted:!m.icon}),href:"javascript:;"},m.tips))}))}),_react2["default"].createElement("span",{className:"triangle"}),_react2["default"].createElement(_Dialog.PanelDialog,{id:"greeting",visible:setGreetingShow,onClose:function onClose(){_this2.closeDialog()},header:!0,backBtn:!0,footer:!1,title:"请选择打招呼语",position:"bottom",width:"100%"},_react2["default"].createElement(_SetGreeting2["default"],{imcore:imcore})))}}]),Setting}(_react.Component),mapStateToProps=function mapStateToProps(state){return{setting:state.setting.setting,show:state.setting.show,setGreetingShow:state.setGreeting.show}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.settingActions,_actions.setGreetingActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Setting)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_classnames,_classnames2,_redux,_reactRedux,_actions,SetGreeting,mapStateToProps,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_actions=__webpack_require__(173),__webpack_require__(281),SetGreeting=function(_Component){function SetGreeting(props){return _classCallCheck(this,SetGreeting),_possibleConstructorReturn(this,(SetGreeting.__proto__||Object.getPrototypeOf(SetGreeting)).call(this,props))}return _inherits(SetGreeting,_Component),_createClass(SetGreeting,[{key:"componentDidMount",value:function componentDidMount(){var _props=this.props,imcore=_props.imcore,actions=_props.actions,setting=_props.setting}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){}},{key:"selectGreeting",value:function selectGreeting(code,name){var _props2=this.props,imcore=_props2.imcore,actions=_props2.actions,greeting=_props2.greeting;actions.selectGreeting(imcore,code,name,greeting)}},{key:"render",value:function render(){var _this2=this,_props3=this.props,imcore=_props3.imcore,actions=_props3.actions,greetingList=_props3.greetingList,greetingType=_props3.greetingType;return _react2["default"].createElement("div",{className:"greeting-box"},_react2["default"].createElement("ul",null,greetingList&&greetingList.map(function(v,i){return _react2["default"].createElement("li",{key:i},_react2["default"].createElement("label",{onClick:function onClick(){return _this2.selectGreeting(v.code,v.name)}},_react2["default"].createElement("em",{className:(0,_classnames2["default"])("webim-icons16",{"icons16-radio":v.code!==greetingType,"icons16-radio-checked":v.code===greetingType})}),v.name))})))}}]),SetGreeting}(_react.Component),mapStateToProps=function mapStateToProps(state){return{greetingList:state.setGreeting.greetingList,greetingType:state.setGreeting.greetingType,greeting:state.setting.setting.greeting}},mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.setGreetingActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(SetGreeting)},function(module,exports){},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function ShowDialogFriends(subscribe,publish){var $friendsBox,$friendsBtn=$("#header-c-beta2").find('[data-selector="drop-menu-friends"]'),$dot=$friendsBtn.find(".red-dot"),$friendsWrap=$('<div class="friends-wrap"><a href="javascript:;" class="chat-close">×</a><div class="friends-box"></div></div>');$friendsWrap.appendTo($("body")),$friendsBox=$friendsWrap.find(".friends-box"),subscribe("READ_NEW_FRIENDS",function(){$dot.addClass("hide")}),subscribe("UNREAD_NEW_FRIENDS",function(){$dot.removeClass("hide")}),$friendsBtn.on("click",function(event){LT.ajax({url:""+LT.Env.cRoot+"connection/new-friend.json",data:{currentPage:0},dataType:"jsonp",success:function success(_ref){var newFriends,flag=_ref.flag,data=_ref.data;1===flag&&(newFriends=__webpack_require__(284).render({list:data.datas,hasNextPage:data.hasNextPage,publish:publish,subscribe:subscribe}),$friendsBox.html(newFriends),$friendsWrap.find(".chat-close").click(function(event){$friendsBox.html("")}))}}),publish("READ_NEW_FRIENDS")}),LT.Comet.on("event_msg_newfrient_notice",function(_ref2){var flag=_ref2.flag,data=_ref2.data;1===flag&&publish("UNREAD_NEW_FRIENDS")}),LT.User.isLogin&&LT.ajax({type:"POST",url:LT.Env.cRoot+"message/unread/newfriendcnt.json",dataType:"json",cache:!1,success:function success(data){1===data.flag&&data.data>0&&publish("UNREAD_NEW_FRIENDS")}})}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=ShowDialogFriends},function(module,exports,__webpack_require__){(function(global){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),CoreClass=function(){function CoreClass(){return _classCallCheck(this,CoreClass),this.tpls={},this.scripts={},this.datas={},this._initTpls()._initScripts(),this}return _createClass(CoreClass,[{key:"_generate",value:function _generate(){return Math.random().toString().replace(".","")}},{key:"_initTpls",value:function _initTpls(){var $NODETPL=this;return this.tpls={main:function($DATA,guid){var _eqstring,_="",duid=$NODETPL.duid();guid=guid||$NODETPL.guid(),_+="<style>#"+guid+" {  height: 552px;}#"+guid+" .chat-title {  padding: 0 20px;  line-height: 48px;  font-size: 16px;  color: #fff;  background: #3689b3;}#"+guid+" .new-friends {  position: relative;  height: 504px;  overflow-y: auto;}#"+guid+" .new-friends span.no-friend {  position: absolute;  left: 0;  right: 0;  top: 50%;  margin-top: -45px;  padding-top: 74px;  text-align: center;  font-size: 16px;  color: #999;  background: url("+__webpack_require__(285)+") center 0 no-repeat;}#"+guid+" .new-friends ul li {  border-bottom: 1px solid #f6f6f6;}#"+guid+" .new-friends ul li:hover {  background: #f6f6f6;}#"+guid+' .new-friends ul li a {  display: block;  padding: 20px 20px 8px 0;  color: #333;  text-decoration: none;  outline: none;  font-family: "Microsoft Yahei";}#'+guid+" .new-friends ul li dl {  margin-left: 14px;}#"+guid+" .new-friends ul li dl dt {  display: inline-block;  margin: 2px 15px 0 0;  vertical-align: top;}#"+guid+" .new-friends ul li dl dd {  display: inline-block;  width: 81%;  vertical-align: middle;}#"+guid+" .new-friends ul li dl dd h4 {  margin: 0;  font-size: 12px;  font-weight: normal;}#"+guid+" .new-friends ul li dl dd h4 label {  float: left;  font-size: 14px;  cursor: pointer;}#"+guid+" .new-friends ul li dl dd h4 label .text-success {  color: #455fd1;}#"+guid+" .new-friends ul li dl dd h4 time {  float: right;  width: 72px;  text-align: center;  color: #999;}#"+guid+" .new-friends ul li dl dd p {  color: #999;}#"+guid+" .new-friends ul li dl dd p span {  float: left;  width: 252px;  margin-top: 8px;  overflow: hidden;  white-space: nowrap;  text-overflow: ellipsis;}#"+guid+" .new-friends ul li dl dd p span.text-success {  float: right;  width: 60px;  padding: 0;  margin-top: 5px;  line-height: 24px;  color: #fff;  border: 0;  cursor: pointer;  background-color: #2c99fe;}#"+guid+" .new-friends ul li dl dd p .btn {  float: right;  width: 60px;  padding: 0;  margin-top: 5px;  line-height: 24px;  color: #fff;  border: 0;  cursor: pointer;}#"+guid+" .new-friends ul li dl dd p .send-message {  background-color: #2c99fe;}#"+guid+" .new-friends .more-history {  line-height: 40px;  text-align: center;}#"+guid+" .new-friends .more-history span img {  vertical-align: middle;  margin-right: 5px;}</style>";try{_+='<div id="'+guid+'">\n    <div class="chat-title">新的朋友</div>\n    <div class="new-friends">\n      ',0===$DATA.list.length?_+='\n        <span class="no-friend">没有新朋友</span>\n      ':(_+='\n        <ul>\n        </ul>\n        <div class="more-history">\n          <span>\n            ',_+=$DATA.hasNextPage?'\n              <img src="'+__webpack_require__(286)+'" />加载中...\n            ':"\n              没有更多消息\n            ",_+="\n          </span>\n        </div>\n      "),_+="\n    </div>\n  </div>"}catch(e){console.log(e.stack)}return $DATA&&($NODETPL.datas[duid]=$DATA),function(scripts){var cache="undefined"!=typeof window?window:"undefined"!=typeof global?global:{};cache._nodetpl_=cache._nodetpl_||{},cache._nodetpl_[guid+"-"+duid]=scripts.main}($NODETPL.scripts),_+="<script>\n",_+="(function(){\n",_+="  var cache = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : {};\n",_+="  cache._nodetpl_['"+guid+"-"+duid+"']('"+guid+"', '"+duid+"');\n",_+="  delete cache._nodetpl_['"+guid+"-"+duid+"'];\n",_+="})();\n",_+="</script>\n"}.bind(this),morefriends:function($DATA,guid){var _eqstring,_="",duid=$NODETPL.duid();guid=guid||$NODETPL.guid();try{$DATA.datas&&$DATA.datas.forEach(function(v,i){_+="\n    <li data-id=",_eqstring=$NODETPL.escapeHtml(i),_+="undefined"==typeof _eqstring?"":_eqstring,_+=" data-uid=",_eqstring=$NODETPL.escapeHtml(v.userId),_+="undefined"==typeof _eqstring?"":_eqstring,_+=" data-imType=",_eqstring=$NODETPL.escapeHtml(v.imUserType),_+="undefined"==typeof _eqstring?"":_eqstring,_+=" data-name=",_eqstring=$NODETPL.escapeHtml(v.imId),_+="undefined"==typeof _eqstring?"":_eqstring,_+=" data-ukind=",_eqstring=$NODETPL.escapeHtml(v.userKind),_+="undefined"==typeof _eqstring?"":_eqstring,_+=' >\n      <a target="_blank" href="',_eqstring=$NODETPL.escapeHtml("0"===v.userKind?"https://c.liepin.com/main/"+v.encodeUserId:"2"===v.userKind?"https://www.liepin.com/LT"+v.userId:""),_+="undefined"==typeof _eqstring?"":_eqstring,_+='">\n        <dl>\n          <dt>\n            <img class="tinyFace circle" src=',_eqstring=$NODETPL.escapeHtml(v.icon?"https://image0.lietou-static.com/normal/"+v.icon:"../../images/tpls/new-friends/no-friend.png"),_+="undefined"==typeof _eqstring?"":_eqstring,_+=' />\n          </dt>\n          <dd>\n            <h4 class="clearfix">\n              <label>',_eqstring=$NODETPL.escapeHtml(v.name),_+="undefined"==typeof _eqstring?"":_eqstring,_+=" \n                ",1===v.relationCode||6===v.relationCode?_+='\n                  <span class="text-success">关注了你</span>\n                ':3===v.relationCode?_+='\n                 <span class="text-warning">申请添加您为好友</span>\n                ':2===v.relationCode?_+='\n                  <span class="text-success">已关注</span>\n                ':4===v.relationCode&&(_+='\n                  <span class="text-warning">已加好友</span>\n                '),_+="\n              </label>\n              <time>";var date=new Date(v.createTime);_eqstring=$NODETPL.escapeHtml(LT.Date.format(date,"MM-dd HH:mm")),_+="undefined"==typeof _eqstring?"":_eqstring,_+='</time>\n            </h4>\n            <p class="clearfix">\n              ',2===v.relationCode?_+="\n                <span>我们已经相互关注成功，很高兴认识您，欢迎随时与我交流~</span>\n              ":4===v.relationCode?_+="\n                <span>我们已经成为好友，很高兴认识您，欢迎随时与我交流~</span>\n              ":(_+="\n                <span>",_eqstring=$NODETPL.escapeHtml(v.addFriendExtInfo||v.companyName+"-"+v.title),_+="undefined"==typeof _eqstring?"":_eqstring,_+="</span>\n              "),_+="\n              \n              ",1===v.relationCode?(_+='\n                <em class="btn btn-primary btn-success" data-selector="add-attention">',_eqstring=$NODETPL.escapeHtml(v.relationDesc),_+="undefined"==typeof _eqstring?"":_eqstring,_+="</em>\n                \n              "):2===v.relationCode?_+='\n                <em class="btn btn-primary btn-success send-message" data-selector="add-attention">发消息</em>\n                \n              ':3===v.relationCode?(_+='\n                <em class="btn btn-primary btn-success" data-selector="accept-requests">',_eqstring=$NODETPL.escapeHtml(v.relationDesc),_+="undefined"==typeof _eqstring?"":_eqstring,_+="</em>\n                \n              "):4===v.relationCode?_+='\n                <em class="btn btn-primary btn-success send-message" data-selector="accept-requests">发消息</em>\n                \n              ':6===v.relationCode&&(_+='\n                <em class="btn btn-primary btn-success" data-selector="relation-attention">',_eqstring=$NODETPL.escapeHtml(v.relationDesc),_+="undefined"==typeof _eqstring?"":_eqstring,_+="</em>\n              "),_+="\n            </p>\n          </dd>\n        </dl>\n      </a>\n    </li>\n  "})}catch(e){console.log(e.stack)}return $DATA&&($NODETPL.datas[duid]=$DATA),_}.bind(this)},$NODETPL}},{key:"_initScripts",value:function _initScripts(){var $NODETPL=this;return this.scripts={main:function(guid,duid){function getMoreFriendList(options,callback){LT.ajax({url:LT.Env.cRoot+"connection/new-friend.json",data:{currentPage:options||0},success:function success(_ref){var flag=_ref.flag,data=_ref.data;1===flag&&callback(data)}})}var $moreHistory,dispatch,subscribe,currentPage,ROOT=document.getElementById(guid),SUBROOT=document.getElementById(guid+duid),$TPLS=$NODETPL.tpls,$DATA=$NODETPL.datas[duid],$ROOT=$(ROOT),newFriends=$TPLS.morefriends({datas:$DATA.list},guid);$(".new-friends ul",$ROOT).append(newFriends),$moreHistory=$(".more-history",$ROOT),dispatch=$DATA.dispatch,subscribe=$DATA.subscribe,LT.Attention=LT.Attention||Apps.Attention,LT.Message=LT.Message||Apps.Message,$(".new-friends ul",$ROOT).on("click",'[data-selector="accept-requests"]',function(e){var that,dataId,uid;return e.preventDefault(),that=$(this),dataId=that.closest("li").attr("data-name"),that.hasClass("send-message")?LT.Message.send({oppositeImId:dataId,oppositeImUserType:that.closest("li").attr("data-imType"),oppositeUserId:that.closest("li").attr("data-uid"),oppositeUserKind:that.closest("li").attr("data-ukind")}):(uid=that.closest("li").attr("data-uid"),LT.Relation.agree(uid,function(){that.addClass("send-message").text("发消息"),that.prev().text("我们已经成为好友，很高兴认识您，欢迎随时与我交流~"),that.closest("li").find("h4 label span").text("已加好友")})),!1}),$(".new-friends ul",$ROOT).on("click",'[data-selector="add-attention"]',function(e){var that,uid,dataId;return e.preventDefault(),that=$(this),uid=that.closest("li").attr("data-uid"),dataId=that.closest("li").attr("data-name"),that.hasClass("send-message")?LT.Message.send({oppositeImId:dataId,oppositeImUserType:that.closest("li").attr("data-imType"),oppositeUserId:that.closest("li").attr("data-uid"),oppositeUserKind:that.closest("li").attr("data-ukind")}):LT.Attention.add(uid,function(){that.addClass("send-message").text("发消息"),that.prev().text("我们已经相互关注成功，很高兴认识您，欢迎随时与我交流~"),that.closest("li").find("h4 label span").text("已关注")}),!1}),$(".new-friends ul",$ROOT).on("click",'[data-selector="relation-attention"]',function(e){
var that,dataId,uid;return e.preventDefault(),that=$(this),dataId=that.closest("li").attr("data-name"),that.hasClass("send-message")?LT.Message.send({oppositeImId:dataId,oppositeImUserType:that.closest("li").attr("data-imType"),oppositeUserId:that.closest("li").attr("data-uid"),oppositeUserKind:that.closest("li").attr("data-ukind")}):(uid=that.closest("li").attr("data-uid"),LT.Relation.addAttention(uid,!1,function(){that.addClass("send-message").text("发消息"),that.prev().text("我们已经相互关注成功，很高兴认识您，欢迎随时与我交流~"),that.closest("li").find("h4 label span").text("已关注")})),!1}),currentPage=0,$(".new-friends",$ROOT).on("scroll",function(){var that=$(this);that.scrollTop()+that.height()>=$("ul",that).outerHeight()&&(++currentPage,getMoreFriendList(currentPage,function(data){var newFriends=$TPLS.morefriends(data,guid);$(".new-friends ul",$ROOT).append(newFriends),data.hasNextPage||$("span",$moreHistory).html("没有更多消息")}))})}.bind(this)},$NODETPL}},{key:"duid",value:function duid(){return"nodetpl_d_"+this._generate()}},{key:"guid",value:function guid(){return"nodetpl_g_"+this._generate()}},{key:"escapeHtml",value:function escapeHtml(html){return html?html.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):html}},{key:"render",value:function render(data,guid){return this.tpls.main(data,guid||this.guid())}}]),CoreClass}();module.exports={render:function render(data){return(new CoreClass).render(data)}}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"images/tpls/new-friends/no-friend.png"},function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"images/message/loading.gif"},function(module,exports,__webpack_require__){"use strict";function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function cSendResume(imcore,info,text){var _this=this;return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(dispatch,getState){return regeneratorRuntime.wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.prev=0,_context3.delegateYield(regeneratorRuntime.mark(function _callee2(){var userInfo,contact;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(userInfo=imcore.userInfo,contact=getState().panel.activeContact,contact&&(info.id||info.oppositeImId===contact.oppositeImId)){_context2.next=6;break}return _context2.next=5,_api.contactsApi.getOneContact(imcore,info);case 5:contact=_context2.sent;case 6:dispatch(_actions.panelActions.selectContact(imcore,contact,function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee(contact,inBlack){var msg;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:msg=void 0,msg=new _send.TxtMsg,msg.set({from:userInfo,to:contact,data:"",extType:_enums.ExtType.MESSAGE_RESUME,title:userInfo.oppositeUserTitle,name:userInfo.oppositeUserName,userId:userInfo.oppositeImId,company:userInfo.oppositeUserCompany,resumeUrl:LT.Env.cRoot+"resume/getdefaultresume/"}),dispatch(_actions.messageActions.sendMsg(imcore,msg,{success:function success(){text&&(msg=new _send.TxtMsg,msg.set({from:userInfo,to:contact,extType:_enums.ExtType.MESSAGE_SEND_TOOLTIP,data:text}),dispatch(_actions.messageActions.sendMsg(imcore,msg))),dispatch(_actions.toastActions.openToast({text:"委托成功！"}))},fail:function fail(err){text&&(msg=new _send.TxtMsg,msg.set({from:userInfo,to:contact,extType:_enums.ExtType.MESSAGE_SEND_TOOLTIP,data:text}),dispatch(_actions.messageActions.sendMsg(imcore,msg)))}}));case 4:case"end":return _context.stop()}},_callee,_this)}));return function(_x3,_x4){return _ref2.apply(this,arguments)}}()));case 7:case"end":return _context2.stop()}},_callee2,_this)})(),"t0",2);case 2:_context3.next=7;break;case 4:_context3.prev=4,_context3.t1=_context3["catch"](0),imcore.handleErr(_context3.t1);case 7:case"end":return _context3.stop()}},_callee3,_this,[[0,4]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}function cSendJobCardAndApplyResume(imcore,options){var _this2=this;return function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(dispatch,getState){return regeneratorRuntime.wrap(function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:try{!function(){var jobDetail=options.jobDetail,oppositeImId=options.oppositeImId,jobKind=jobDetail.jobKind,jobId=jobDetail.jobId,userInfo=imcore.userInfo,greetingFlag=getState().setting.setting.greeting,greetingText=getState().setGreeting.greetingText,msg=void 0;dispatch(_actions.panelActions.selectContact(imcore,options,function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(contact,inBlack){var data;return regeneratorRuntime.wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,canSendExtType(imcore,jobKind,jobId);case 2:data=_context4.sent,data.flag?data.data.canSendJobCard&&dispatch(canSendJobCard(imcore,userInfo,contact,jobDetail,greetingFlag,greetingText,jobKind,jobId)):vdialog.error(data.msg);case 4:case"end":return _context4.stop()}},_callee4,_this2)}));return function(_x7,_x8){return _ref4.apply(this,arguments)}}()))}()}catch(e){imcore.handleErr(e)}case 1:case"end":return _context5.stop()}},_callee5,_this2)}));return function(_x5,_x6){return _ref3.apply(this,arguments)}}()}function canSendJobCard(imcore,userInfo,contact,jobDetail,greetingFlag,greetingText,jobKind,jobId){var _this3=this;return function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee7(dispatch,getState){var msg;return regeneratorRuntime.wrap(function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:msg=new _send.TxtMsg,msg.set({from:userInfo,to:contact,data:"",extType:_enums.ExtType.MESSAGE_SEND_JOB,dqName:jobDetail.dqName,title:jobDetail.title,salary:jobDetail.salary,jobId:jobDetail.jobId,jobKind:jobDetail.jobKind,company:jobDetail.company,jobHref:jobDetail.jobHref}),dispatch(_actions.messageActions.sendMsg(imcore,msg,{success:function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark(function _callee6(){return regeneratorRuntime.wrap(function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return greetingFlag&&(msg=new _send.TxtMsg,msg.set({from:userInfo,to:contact,data:greetingText,extType:_enums.ExtType.MESSAGE_SEND_TOOLTIP}),dispatch(_actions.messageActions.sendMsg(imcore,msg))),_context6.next=3,sendJobCardBack(imcore,jobKind,jobId);case 3:case"end":return _context6.stop()}},_callee6,_this3)}));return function success(){return _ref6.apply(this,arguments)}}()}));case 3:case"end":return _context7.stop()}},_callee7,_this3)}));return function(_x9,_x10){return _ref5.apply(this,arguments)}}()}function canSendUserCard(imcore,contact,jobKind,jobId){var _this4=this;return function(){var _ref7=_asyncToGenerator(regeneratorRuntime.mark(function _callee9(dispatch,getState){var userInfo,msg;return regeneratorRuntime.wrap(function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:userInfo=imcore.userInfo,msg=new _send.TxtMsg,msg.set({from:userInfo,to:contact,data:"",extType:_enums.ExtType.MESSAGE_SEND_NAMECARD,name:userInfo.oppositeUserName,sex:userInfo.oppositeUserGender,workyear:userInfo.oppositeUserWorkYears,dq:userInfo.oppositeUserDqName,title:userInfo.oppositeUserTitle,company:userInfo.oppositeUserCompany,resumeUrl:LT.Env.cRoot+"resume/getdefaultresume/",jobKind:jobKind,jobId:jobId}),dispatch(_actions.messageActions.sendMsg(imcore,msg,{success:function(){var _ref8=_asyncToGenerator(regeneratorRuntime.mark(function _callee8(){return regeneratorRuntime.wrap(function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,recordSendUserCard(imcore,contact);case 2:case"end":return _context8.stop()}},_callee8,_this4)}));return function success(){return _ref8.apply(this,arguments)}}()}));case 4:case"end":return _context9.stop()}},_callee9,_this4)}));return function(_x11,_x12){return _ref7.apply(this,arguments)}}()}function canApply(imcore,jobKind,jobId,_success){var _this5=this;return function(){var _ref9=_asyncToGenerator(regeneratorRuntime.mark(function _callee11(dispatch,getState){var inBlack,contact;return regeneratorRuntime.wrap(function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(inBlack=getState().shield.inBlack,contact=getState().panel.activeContact,!_api.messageApi.checkIfCansend(imcore,contact,inBlack)){_context11.next=4;break}return _context11.delegateYield(regeneratorRuntime.mark(function _callee10(){var arr,codesData,codesStr,canApplyData,userInfo,msg;return regeneratorRuntime.wrap(function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return arr=[],_context10.next=3,getResumesCodes(jobKind,jobId);case 3:if(codesData=_context10.sent,codesStr=void 0,window.tlog=window.tlog||[],tlog.push("c:c_jobdetail_applycv_apply"),!codesData.flag){_context10.next=17;break}return codesData.data.data.resume.forEach(function(item){item.default_res_encode&&(arr.includes(item.res_id_encode)||arr.push(item.res_id_encode))}),codesStr=arr.toString(),$('.send-message [data-selector="btn-send"]').LoadingUI("show"),_context10.next=13,saveApply(jobKind,jobId,codesStr);case 13:canApplyData=_context10.sent,$('.send-message [data-selector="btn-send"]').LoadingUI("hide"),userInfo=imcore.userInfo,canApplyData.flag?(msg=new _send.TxtMsg,msg.set({extType:_enums.ExtType.MESSAGE_SEND_APPLYRESUME,from:userInfo,to:contact,jobId:jobId,resCodes:codesStr,title:userInfo.oppositeUserTitle,name:userInfo.oppositeUserName,userId:userInfo.oppositeImId,company:userInfo.oppositeUserCompany,resumeUrl:LT.Env.cRoot+"resume/detail/?res_id_encode="+codesStr}),dispatch(_actions.messageActions.sendMsg(imcore,msg,{success:function success(){$("body .btn-apply").removeClass("btn-apply").removeAttr("data-selector").addClass("btn-apply-disabled").html("简历已发送"),_success&&_success()},fail:function fail(){console.log("fail")}}))):vdialog.error(canApplyData.msg);case 17:case"end":return _context10.stop()}},_callee10,_this5)})(),"t0",4);case 4:case"end":return _context11.stop()}},_callee11,_this5)}));return function(_x13,_x14){return _ref9.apply(this,arguments)}}()}function canSendExtType(imcore,jobKind,jobId){return(0,_utils.pajax)({url:LT.Env.cRoot+"msg/canSendExtType.json",data:{jobKind:jobKind,jobId:jobId},type:"post"})}function sendJobCardBack(imcore,jobKind,jobId){return(0,_utils.pajax)({url:LT.Env.cRoot+"msg/recordSendJobCard.json",data:{jobKind:jobKind,jobId:jobId},type:"post"})}function getResumesCodes(){return(0,_utils.pajax)({url:LT.Env.cRoot+"apply/getresumes.json",type:"post"})}function saveApply(jobKind,jobId,resCodes){return(0,_utils.pajax)({url:LT.Env.cRoot+"apply/saveapply.json",data:{res_id_encodes:resCodes,apply_prior:0,job_id:jobId,job_kind:jobKind},type:"post"})}function userCardInfo(imcore){return(0,_utils.pajax)({url:LT.Env.cRoot+"msg/user-card-info.json",type:"post"})}function recordSendUserCard(imcore,contact){return(0,_utils.pajax)({url:LT.Env.cRoot+"msg/recordSendUserCard.json",data:{otherId:contact.oppositeUserId},type:"post"})}var _api,_enums,_send,_utils,_actions;Object.defineProperty(exports,"__esModule",{value:!0}),exports.canApply=void 0,exports.cSendResume=cSendResume,exports.cSendJobCardAndApplyResume=cSendJobCardAndApplyResume,_api=__webpack_require__(215),_enums=__webpack_require__(162),_send=__webpack_require__(221),_utils=__webpack_require__(150),_actions=__webpack_require__(173),exports.canApply=canApply},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _extends,_createClass,_react,_react2,_enums,_MsgCards,_Resume,_Resume2,_Rating,_Rating2,_RecommendJob,_RecommendJob2,_ApplyResumeFeedback,_ApplyResumeFeedback2,_NameCard,_NameCard2,_AskResume,_AskResume2,MsgCards;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_enums=__webpack_require__(162),_MsgCards=__webpack_require__(270),_Resume=__webpack_require__(289),_Resume2=_interopRequireDefault(_Resume),_Rating=__webpack_require__(291),_Rating2=_interopRequireDefault(_Rating),_RecommendJob=__webpack_require__(293),_RecommendJob2=_interopRequireDefault(_RecommendJob),_ApplyResumeFeedback=__webpack_require__(295),_ApplyResumeFeedback2=_interopRequireDefault(_ApplyResumeFeedback),_NameCard=__webpack_require__(297),_NameCard2=_interopRequireDefault(_NameCard),_AskResume=__webpack_require__(299),_AskResume2=_interopRequireDefault(_AskResume),MsgCards=function(_React$Component){function MsgCards(props){return _classCallCheck(this,MsgCards),_possibleConstructorReturn(this,(MsgCards.__proto__||Object.getPrototypeOf(MsgCards)).call(this,props))}return _inherits(MsgCards,_React$Component),_createClass(MsgCards,[{key:"showMsgCards",value:function showMsgCards(){var _props=this.props,dispatch=_props.dispatch,allstate=_props.allstate,message=_props.message,ifISend=_props.ifISend,extType=message.extType||"",type=message.type;switch(extType){case _enums.ExtType.MESSAGE_RESUME:return _react2["default"].createElement(_Resume2["default"],this.props);case _enums.ExtType.MESSAGE_SEND_JOB:return _react2["default"].createElement(_RecommendJob2["default"],_extends({},this.props,{ifISend:ifISend}));case _enums.ExtType.MESSAGE_SEND_RATINGBAR:return _react2["default"].createElement(_Rating2["default"],this.props);case _enums.ExtType.MESSAGE_SEND_APPLYRESUME:return _react2["default"].createElement("div",null,_react2["default"].createElement("p",{className:"applyresume"},_react2["default"].createElement("span",{className:"applytips"},"您的简历已发送至对方")));case _enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK:return _react2["default"].createElement(_ApplyResumeFeedback2["default"],this.props);case _enums.ExtType.MESSAGE_ASK_RESUME:return _react2["default"].createElement(_AskResume2["default"],this.props);case _enums.ExtType.MESSAGE_SEND_NAMECARD:return _react2["default"].createElement("div",null,_react2["default"].createElement("p",{className:"name-card-tips"},_react2["default"].createElement("span",{className:"applytips"},"建议您发送简历后再沟通，提高求职效率。")),_react2["default"].createElement(_NameCard2["default"],this.props));default:return _react2["default"].createElement(_MsgCards.Txt,this.props)}}},{key:"render",value:function render(){return _react2["default"].createElement("div",null,this.showMsgCards())}}]),MsgCards}(_react2["default"].Component),exports["default"]=MsgCards},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function Resume(props){var message=props.message;return message.state===_enums.MsgState.INITIAL?_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("img",{src:"//concat.lietou-static.com/dev/c/pc/revs/v3/static/images/message/sending_56b2bf41.gif"})):_react2["default"].createElement("div",{className:"resume-card content"},_react2["default"].createElement("h3",null,"委托的简历："),_react2["default"].createElement("a",{className:"resume-card-main",onClick:function onClick(){window.tlog=window.tlog||[],tlog.push("c:C000010113")},href:message.resumeUrl,target:"_blank"},_react2["default"].createElement("dl",null,_react2["default"].createElement("dt",null,_react2["default"].createElement("i",{className:"webim-icons32 icons32-resume"})),_react2["default"].createElement("dd",null,_react2["default"].createElement("ul",null,_react2["default"].createElement("li",null,_react2["default"].createElement("span",{className:"title",title:message.name},message.name),_react2["default"].createElement("span",null,message.sex||""),_react2["default"].createElement("span",{className:"edulevel",title:message.res_edulevel},message.res_edulevel||""),_react2["default"].createElement("span",null,message.workyear?message.workyear+"年经验":""),_react2["default"].createElement("span",{className:"dq-name",title:message.dq||""},message.dq||"")),_react2["default"].createElement("li",null,_react2["default"].createElement("span",{className:"job-tit",title:message.title},message.title||""),_react2["default"].createElement("span",{className:"separator"},"|"),_react2["default"].createElement("span",{className:"cpy-tit",title:message.company},message.company||"")),_react2["default"].createElement("li",null,_react2["default"].createElement("em",null,"查看委托简历")))))))}var _react,_react2,_utils,_enums,_actions;Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Resume,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_utils=__webpack_require__(150),_enums=__webpack_require__(162),_actions=__webpack_require__(173),__webpack_require__(290)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function checkIfCanAssessH(imcore,userhId,messageId){return imcore.handleLog("check canAssessH-->"),(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.canAssessH,data:{userhId:userhId,messageId:messageId},type:"post"})}function AssessH(imcore,userhId,messageId,starScore){return imcore.handleLog("assessH-->"),(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.assessH,data:{userhId:userhId,messageId:messageId,level:starScore}})}var _extends,_createClass,_react,_react2,_utils,_reactRedux,_config,_config2,_actions,_redux,_classnames,_classnames2,stars,Rating,mapDispatchToProps;Object.defineProperty(exports,"__esModule",{value:!0}),_extends=Object.assign||function(target){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_utils=__webpack_require__(150),_reactRedux=__webpack_require__(134),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_actions=__webpack_require__(173),_redux=__webpack_require__(120),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),__webpack_require__(292),stars=[{score:1,desc:"不专业"},{score:2,desc:"需提高"},{score:3,desc:"一般般"},{score:4,desc:"较专业"},{score:5,desc:"很专业"}],Rating=function(_Component){function Rating(props){_classCallCheck(this,Rating);var _this=_possibleConstructorReturn(this,(Rating.__proto__||Object.getPrototypeOf(Rating)).call(this,props));return _this.state={canRate:!1,rated:!1,hoverScore:0},_this.starsDom=null,_this}return _inherits(Rating,_Component),_createClass(Rating,[{key:"componentDidMount",value:function componentDidMount(){var that=this;$(this.starsDom).find("span").hover(function(){that.setState({hoverScore:$(this).index()+2})},function(){that.setState({hoverScore:0})})}},{key:"nowRate",value:function(){function nowRate(_x,_x2,_x3){return _ref.apply(this,arguments)}var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(imcore,userId,messageId){var actions,data,rate=arguments.length>3&&void 0!==arguments[3]&&arguments[3],starScore=arguments[4];return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,actions=this.props.actions,_context.next=4,checkIfCanAssessH(imcore,userId,messageId);case 4:if(data=_context.sent,data.flag){_context.next=10;break}this.setState({canRate:!1}),actions.openToast({text:data.data.msg}),_context.next=21;break;case 10:if(0===data.data.status){_context.next=15;break}actions.openToast({text:data.data.msg}),this.setState({canRate:!1}),_context.next=21;break;case 15:if(this.setState({canRate:!0}),!rate){_context.next=21;break}return _context.next=19,AssessH(imcore,userId,messageId,starScore);case 19:data=_context.sent,data.flag?this.setState({rated:!0}):(this.setState({rated:!1}),actions.openToast({text:data.data.msg}));case 21:_context.next=26;break;case 23:_context.prev=23,_context.t0=_context["catch"](0),imcore.handleErr(_context.t0);case 26:case"end":return _context.stop()}},_callee,this,[[0,23]])}));return nowRate}()},{key:"render",value:function render(){var _this2=this,_props=this.props,message=_props.message,activeContact=_props.activeContact,id=message.id,_state=this.state,rated=_state.rated,canRate=_state.canRate,hoverScore=_state.hoverScore;return rated?_react2["default"].createElement("div",{className:"rating-card"},_react2["default"].createElement("section",{className:"rating-success"},_react2["default"].createElement("h3",null),_react2["default"].createElement("hr",null),_react2["default"].createElement("ul",null,_react2["default"].createElement("li",null,"您已完成评价，非常感谢")))):_react2["default"].createElement("div",{className:"rating-card"},_react2["default"].createElement("section",{className:(0,_classnames2["default"])("not-rating",{hide:canRate})},_react2["default"].createElement("h3",null),_react2["default"].createElement("ul",null,_react2["default"].createElement("hr",null),_react2["default"].createElement("li",null,"为猎头顾问",_react2["default"].createElement("span",{className:"from-name"},activeContact.oppositeUserName||activeContact.oppositeUserNameShow),"的服务做个评价吧"),_react2["default"].createElement("li",null,_react2["default"].createElement("button",{type:"button",className:"btn-rating",onClick:function onClick(){_this2.nowRate(imcore,activeContact.oppositeUserId,id)}},"我要评价")))),_react2["default"].createElement("section",{className:(0,_classnames2["default"])("rating-bar",{hide:!canRate})},_react2["default"].createElement("h3",null,"请选择"),_react2["default"].createElement("ul",null,_react2["default"].createElement("li",{className:"stars",ref:function ref(dom){return _this2.starsDom=dom}},stars.map(function(v,i){return _react2["default"].createElement("span",{key:i,title:v.desc,onClick:function onClick(){_this2.nowRate(imcore,activeContact.oppositeUserId,id,!0,v.score)}},_react2["default"].createElement("i",{className:(0,_classnames2["default"])({"webim-icons32":!0,"icons32-starno":hoverScore<=v.score,"icons32-star":hoverScore>v.score})}))})))))}}]),Rating}(_react.Component),mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:(0,_redux.bindActionCreators)(_extends({},_actions.toastActions),dispatch)}},exports["default"]=(0,_reactRedux.connect)(null,mapDispatchToProps)(Rating)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}function RecommendJob(props){var message=props.message,scrollToBottom=props.scrollToBottom,imcore=props.imcore,ifISend=props.ifISend,title=message.title,salary=message.salary,jobHref=message.jobHref,company=message.company,dqName=message.dqName,senderKind=message.senderKind,Tiletext="",jobTlog=void 0;return"0"===senderKind?(Tiletext="我感兴趣的职位",jobTlog="c:C000010112"):"1"===senderKind?(jobTlog="c:C000010490",Tiletext="邀请您应聘的职位"):"2"===senderKind&&(jobTlog="c:C000010489",Tiletext="为您推荐的职位"),message.state===_enums.MsgState.INITIAL?_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("img",{src:"//concat.lietou-static.com/dev/c/pc/revs/v3/static/images/message/sending_56b2bf41.gif"})):_react2["default"].createElement("div",{className:"job-card content"},_react2["default"].createElement("h3",{className:(0,_classnames2["default"])(ifISend?"":"hsend")},Tiletext),_react2["default"].createElement("a",{className:"chat-job",onClick:function onClick(){window.tlog=window.tlog||[],tlog.push(jobTlog)},href:jobHref,target:"_blank"},_react2["default"].createElement("dl",null,_react2["default"].createElement("dt",null,title,_react2["default"].createElement("em",{className:"text-warning"}," [",salary,"]")),_react2["default"].createElement("dd",null,company),_react2["default"].createElement("dd",{className:"clearfix"},_react2["default"].createElement("span",null,dqName),!ifISend&&"2"===senderKind&&_react2["default"].createElement(RefuseJob,props),_react2["default"].createElement("em",null,"查看职位详情")))))}var _createClass,getRefuseJobStatus,refuseJob,_react,_react2,_actions,_utils,_send,_config,_config2,_enums,_redux,_reactRedux,_classnames,_classnames2,_Dialog,_Dialog2,RefuseJob1,mapStateToProps,RefuseJob;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),getRefuseJobStatus=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(imcore,jobId,cb){var data;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.jobstatus,type:"post",data:{jobId:jobId}});case 3:return data=_context.sent,_context.abrupt("return",cb(data));case 7:_context.prev=7,_context.t0=_context["catch"](0),imcore.handleErr(_context.t0);case 10:case"end":return _context.stop()}},_callee,this,[[0,7]])}));return function getRefuseJobStatus(_x,_x2,_x3){return _ref.apply(this,arguments)}}(),refuseJob=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(imcore,message,code,cb){var data;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,(0,_utils.pajax)({url:(0,_config2["default"])(imcore.env).urls.jobrefuse,type:"post",data:{job_id:message.jobId,fb:code}});case 3:return data=_context2.sent,window.tlog=window.tlog||[],tlog.push("c:C000010488"),_context2.abrupt("return",cb(data));case 9:_context2.prev=9,_context2.t0=_context2["catch"](0),imcore.handleErr(_context2.t0);case 12:case"end":return _context2.stop()}},_callee2,this,[[0,9]])}));return function refuseJob(_x4,_x5,_x6,_x7){return _ref2.apply(this,arguments)}}(),exports["default"]=RecommendJob,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_actions=__webpack_require__(173),_utils=__webpack_require__(150),_send=__webpack_require__(221),_config=__webpack_require__(176),_config2=_interopRequireDefault(_config),_enums=__webpack_require__(162),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),_Dialog=__webpack_require__(119),_Dialog2=_interopRequireDefault(_Dialog),__webpack_require__(294),RefuseJob1=function(_Component){function RefuseJob1(props){_classCallCheck(this,RefuseJob1);var _this=_possibleConstructorReturn(this,(RefuseJob1.__proto__||Object.getPrototypeOf(RefuseJob1)).call(this,props));
return _this.state={refuseJobList:[{code:0,text:"对行业不感兴趣"},{code:1,text:"对职能不感兴趣"},{code:2,text:"工作地点与期望不符"},{code:3,text:"薪酬范围不理想"},{code:4,text:"工作内容不感兴趣"},{code:5,text:"职位级别不符合预期"},{code:6,text:"暂时不考虑换工作"}],curCode:0,dialog:{refuseJobvisible:!1,footer:!1,title:!0,position:"bottom",width:"100%"}},_this}return _inherits(RefuseJob1,_Component),_createClass(RefuseJob1,[{key:"showRefuseJobDialog",value:function showRefuseJobDialog(e){var that,_that$props,imcore,actions,message;e.preventDefault(),that=this,_that$props=that.props,imcore=_that$props.imcore,actions=_that$props.actions,message=_that$props.message,getRefuseJobStatus(imcore,message.jobId,function(data){data.flag?that.setState({curCode:0,dialog:{refuseJobvisible:!0,footer:!1,title:"请选择您暂不考虑的理由",position:"bottom",width:"100%"}}):_Dialog2["default"].alert({parent:"chat",width:300,text:data.msg})})}},{key:"closeRefuseJobDialog",value:function closeRefuseJobDialog(status){var _props=this.props,imcore=_props.imcore,actions=_props.actions;this.setState({dialog:{refuseJobvisible:!1,footer:!1,title:"请选择您暂不考虑的理由",position:"bottom",width:"100%"}})}},{key:"setRefuseJob",value:function setRefuseJob(code,reason){var _this2=this,_props2=this.props,imcore=_props2.imcore,actions=_props2.actions,message=_props2.message,activeContact=_props2.activeContact,dispatch=_props2.dispatch;refuseJob(imcore,message,code,function(data){var userInfo,msg;data.flag?(userInfo=imcore.userInfo,msg=new _send.TxtMsg,msg.set({from:userInfo,to:activeContact,data:"",extType:_enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK,jobId:message.jobId,jobKind:message.jobKind,reason:reason,title:message.title,salary:message.salary,jobHref:message.jobHref}),dispatch(_actions.messageActions.sendMsg(imcore,msg,{success:function success(){_this2.setState({dialog:{refuseJobvisible:!1}}),message.isHandler=!0,_actions.panelActions.panelUpdateMsg(imcore,message),dispatch(_actions.toastActions.openToast({text:"操作成功！"}))}}))):(_this2.setState({dialog:{refuseJobvisible:!1}}),_Dialog2["default"].alert({parent:"chat",width:300,text:data.msg}))})}},{key:"dialogContent",value:function dialogContent(){var _this3=this,_props3=this.props,imcore=_props3.imcore,actions=_props3.actions,message=_props3.message,_state=this.state,curCode=_state.curCode,dialog=_state.dialog,refuseJobList=_state.refuseJobList,iconActive=_state.iconActive,html=void 0;return"bottom"===dialog.position?html=_react2["default"].createElement("div",{className:"refusejob-dialog-box"},_react2["default"].createElement("p",null,refuseJobList.map(function(v,i){return _react2["default"].createElement("a",{key:i,onClick:function onClick(){return _this3.setRefuseJob(v.code,v.text)},href:"javascript:;"},v.text)}))):"center"===dialog.position&&(html=_react2["default"].createElement("p",{className:"text-center"},"操作成功！")),html}},{key:"componentDidMount",value:function componentDidMount(){this.props.scrollToBottom()}},{key:"render",value:function render(){var _this4=this,_props4=this.props,imcore=_props4.imcore,actions=_props4.actions,message=_props4.message,_state2=this.state,curCode=_state2.curCode,dialog=_state2.dialog;return message.isHandler?_react2["default"].createElement("em",{className:"no-thank"},"已拒绝"):_react2["default"].createElement("em",{className:"no-thank active",onClick:function onClick(e){_this4.showRefuseJobDialog(e)}},"暂不考虑",_react2["default"].createElement(_Dialog.ChatDialog,{id:"refuseJob",visible:dialog.refuseJobvisible,onClose:function onClose(){_this4.closeRefuseJobDialog()},header:!0,backBtn:!1,footer:dialog.footer,title:dialog.title,position:dialog.position,width:dialog.width},this.dialogContent()))}}]),RefuseJob1}(_react.Component),mapStateToProps=function mapStateToProps(state){return{activeContact:state.panel.activeContact}},RefuseJob=(0,_reactRedux.connect)(mapStateToProps,null)(RefuseJob1)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function ApplyResumeFeedback(props){var msg,message=props.message,imcore=props.imcore;return message.state===_enums.MsgState.INITIAL?_react2["default"].createElement("img",{src:"https://concat.lietou-static.com/dev/c/pc/revs/v3/static/images/message/sending_56b2bf41.gif"}):(msg="",_enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK===message.extType&&(msg=message.ext&&message.ext.extBody&&0===message.ext.extBody.messageSource&&message.reason?"由于【"+(message.reason.name?message.reason.name:message.reason)+"】，所以我暂不考虑应聘该职位，非常感谢您的推荐。":0===message.messageSource?"由于【"+(message.reason.name?message.reason.name:message.reason)+"】，所以我暂不考虑应聘该职位，非常感谢您的推荐。":message.reason?message.reason:"我暂不考虑应聘该职位，非常感谢您的推荐"),_react2["default"].createElement("ul",{className:"feed-back content"},_react2["default"].createElement("li",null,msg),_react2["default"].createElement("li",null,"相关职位：",_react2["default"].createElement("a",{className:"job-link cjob",href:message.jobHref,target:"_blank"},message.title?message.title:"",_react2["default"].createElement("em",null,"[",message.salary?message.salary:"","]")))))}var _react,_react2,_enums,_redux,_reactRedux,_classnames,_classnames2;Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=ApplyResumeFeedback,_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_enums=__webpack_require__(162),_redux=__webpack_require__(120),_reactRedux=__webpack_require__(134),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),__webpack_require__(296)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _createClass,_react,_react2,_reactRedux,_utils,_enums,_actions,_cMessageActions,_classnames,_classnames2,NameCard;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_reactRedux=__webpack_require__(134),_utils=__webpack_require__(150),_enums=__webpack_require__(162),_actions=__webpack_require__(173),_cMessageActions=__webpack_require__(287),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),__webpack_require__(298),NameCard=function(_Component){function NameCard(props){_classCallCheck(this,NameCard);var _this=_possibleConstructorReturn(this,(NameCard.__proto__||Object.getPrototypeOf(NameCard)).call(this,props));return _this.state={sendStatus:props.sendStatus||!1},_this}return _inherits(NameCard,_Component),_createClass(NameCard,[{key:"componentDidMount",value:function componentDidMount(){}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){nextProps.message.sendStatus!==this.props.message.sendStatus&&this.setState({sendStatus:nextProps.message.sendStatus})}},{key:"sendResume",value:function sendResume(event){var _props,dispatch,imcore,message,actions,that,sendStatus;event.preventDefault(),_props=this.props,dispatch=_props.dispatch,imcore=_props.imcore,message=_props.message,actions=_props.actions,that=this,sendStatus=this.state.sendStatus,sendStatus||dispatch((0,_cMessageActions.canApply)(imcore,message.jobKind,message.jobId,function(){window.tlog=window.tlog||[],tlog.push("c:C000010795"),that.setState({sendStatus:!0})}))}},{key:"render",value:function render(){var _this2=this,message=this.props.message,sendStatus=this.state.sendStatus;return message.state===_enums.MsgState.INITIAL?_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("img",{src:"//concat.lietou-static.com/dev/c/pc/revs/v3/static/images/message/sending_56b2bf41.gif"})):_react2["default"].createElement("div",{className:"name-card content"},_react2["default"].createElement("a",{className:"name-card-main",href:message.resumeUrl,target:"_blank"},_react2["default"].createElement("dl",null,_react2["default"].createElement("dt",null,_react2["default"].createElement("i",{className:"webim-icons32 icons32-resume"})),_react2["default"].createElement("dd",null,_react2["default"].createElement("ul",null,_react2["default"].createElement("li",null,_react2["default"].createElement("span",{className:"title",title:message.name},message.name),_react2["default"].createElement("span",null,message.sex||"")),_react2["default"].createElement("li",null,_react2["default"].createElement("span",null,null!=message.workyear?message.workyear?message.workyear+"年经验":"少于1年工作经验":""),_react2["default"].createElement("span",{className:"dq-name",title:message.dq||""},message.dq||"")),_react2["default"].createElement("li",null,_react2["default"].createElement("span",{className:"job-tit",title:message.title},message.title||""),_react2["default"].createElement("span",null,"|"),_react2["default"].createElement("span",{className:"cpy-tit",title:message.company},message.company||"")),_react2["default"].createElement("li",null,_react2["default"].createElement("em",{className:(0,_classnames2["default"])({muted:sendStatus}),onClick:function onClick(event){_this2.sendResume(event)}},sendStatus?"已发送":"发送简历")))))))}}]),NameCard}(_react.Component),exports["default"]=(0,_reactRedux.connect)(null,null)(NameCard)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _createClass,_react,_react2,_reactRedux,_utils,_enums,_actions,_cMessageActions,_classnames,_classnames2,AskResume;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function defineProperties(target,props){var i,descriptor;for(i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(110),_react2=_interopRequireDefault(_react),_reactRedux=__webpack_require__(134),_utils=__webpack_require__(150),_enums=__webpack_require__(162),_actions=__webpack_require__(173),_cMessageActions=__webpack_require__(287),_classnames=__webpack_require__(144),_classnames2=_interopRequireDefault(_classnames),__webpack_require__(300),AskResume=function(_Component){function AskResume(props){_classCallCheck(this,AskResume);var _this=_possibleConstructorReturn(this,(AskResume.__proto__||Object.getPrototypeOf(AskResume)).call(this,props));return _this.state={sendStatus:props.sendStatus||!1,refuse:!1},_this}return _inherits(AskResume,_Component),_createClass(AskResume,[{key:"componentDidMount",value:function componentDidMount(){}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){nextProps.message.sendStatus!==this.props.message.sendStatus&&this.setState({sendStatus:nextProps.message.sendStatus,refuse:!0})}},{key:"sendResume",value:function sendResume(){var _props=this.props,dispatch=_props.dispatch,imcore=_props.imcore,message=_props.message,actions=_props.actions,that=this,_state=this.state,sendStatus=_state.sendStatus,refuse=_state.refuse;sendStatus||refuse||(window.tlog=window.tlog||[],tlog.push("c:C000010796"),dispatch((0,_cMessageActions.canApply)(imcore,message.jobKind,message.jobId,function(){actions.updateMsgList(imcore,function(list){var newlist=list.map(function(v){return v.extType===_enums.ExtType.MESSAGE_SEND_NAMECARD||v.extType===_enums.ExtType.MESSAGE_ASK_RESUME?Object.assign({},v,{sendStatus:!0}):v});return newlist||[]}),actions.updateInitialServerHistory(imcore,function(list){var newlist=list.map(function(v){return v.extType===_enums.ExtType.MESSAGE_SEND_NAMECARD||v.extType===_enums.ExtType.MESSAGE_ASK_RESUME?Object.assign({},v,{sendStatus:!0}):v});return newlist||[]})})))}},{key:"refuse",value:function refuse(){var _state2=this.state,sendStatus=_state2.sendStatus,refuse=_state2.refuse;refuse||(window.tlog=window.tlog||[],tlog.push("c:C000010797"),this.setState({refuse:!0}))}},{key:"render",value:function render(){var _this2=this,message=this.props.message,_state3=this.state,sendStatus=_state3.sendStatus,refuse=_state3.refuse;return message.state===_enums.MsgState.INITIAL?_react2["default"].createElement("div",{className:"content"},_react2["default"].createElement("img",{src:"//concat.lietou-static.com/dev/c/pc/revs/v3/static/images/message/sending_56b2bf41.gif"})):_react2["default"].createElement("div",{className:"ask-resume content"},_react2["default"].createElement("p",{className:"ask-content"},"我想要一份你的简历，你是否同意？"),_react2["default"].createElement("p",{className:"ask-btns"},_react2["default"].createElement("a",{className:(0,_classnames2["default"])({muted:sendStatus||refuse}),href:"javascript:;",onClick:function onClick(){return _this2.sendResume()}},sendStatus?"已发送":"同意"),_react2["default"].createElement("a",{className:(0,_classnames2["default"])({muted:refuse}),href:"javascript:;",onClick:function onClick(){return _this2.refuse()}},"拒绝")))}}]),AskResume}(_react.Component),exports["default"]=(0,_reactRedux.connect)(null,null)(AskResume)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){var info,value;try{info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}return step("next")})}}var initJobMessage,fillInfo,_enums,_utils;Object.defineProperty(exports,"__esModule",{value:!0}),exports.fillInfo=exports.initJobMessage=void 0,initJobMessage=exports.initJobMessage=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(jobId,jobKind,senderKind){var data;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,(0,_utils.pajax)({url:LT.Env.wwwRoot+"job/loadjobinfo.json",data:{jobId:jobId,jobKind:jobKind,fromUK:senderKind}});case 2:if(data=_context.sent,!data.flag){_context.next=7;break}return _context.abrupt("return",data.data);case 7:return _context.abrupt("return",{exist:!1});case 8:case"end":return _context.stop()}},_callee,this)}));return function initJobMessage(_x,_x2,_x3){return _ref.apply(this,arguments)}}(),fillInfo=exports.fillInfo=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(imcore,message,extBody){var info,_ImcacheInfo,jobs,resumes,userId,jobId,jobKind,senderKind;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:info={},_ImcacheInfo=ImcacheInfo,jobs=_ImcacheInfo.jobs,resumes=_ImcacheInfo.resumes,userId=void 0,jobId=void 0,jobKind=void 0,senderKind=void 0,jobId=message.jobId,jobKind=message.jobKind,senderKind=message.senderKind,_context2.t0=message.extType,_context2.next=_context2.t0===_enums.ExtType.MESSAGE_RESUME?9:_context2.t0===_enums.ExtType.MESSAGE_SEND_APPLYRESUME?12:_context2.t0===_enums.ExtType.MESSAGE_SEND_NAMECARD?13:_context2.t0===_enums.ExtType.MESSAGE_SEND_APPLYSUCFEEDBACK?15:_context2.t0===_enums.ExtType.MESSAGE_SEND_JOB?15:_context2.t0===_enums.ExtType.MESSAGE_SEND_APPLYFAILDFEEDBACK?15:25;break;case 9:return userId=extBody.userInfo?extBody.userInfo.userId:message.from,userId===imcore.userInfo.oppositeImId&&(info={name:imcore.userInfo.oppositeUserName,title:imcore.userInfo.oppositeUserTitle,company:imcore.userInfo.oppositeUserCompany}),_context2.abrupt("break",25);case 12:return _context2.abrupt("break",25);case 13:return info={name:imcore.userInfo.oppositeUserName,sex:imcore.userInfo.oppositeUserGender,workyear:imcore.userInfo.oppositeUserWorkYears,dq:imcore.userInfo.oppositeUserDqName,title:imcore.userInfo.oppositeUserTitle,company:imcore.userInfo.oppositeUserCompany},_context2.abrupt("break",25);case 15:if(!jobs[jobId]){_context2.next=19;break}info=jobs[jobId],_context2.next=23;break;case 19:return _context2.next=21,initJobMessage(jobId,jobKind,senderKind);case 21:info=_context2.sent,jobs[jobId]=info;case 23:return info.messageSource=extBody.messageSource,_context2.abrupt("break",25);case 25:return _context2.abrupt("return",info);case 26:case"end":return _context2.stop()}},_callee2,this)}));return function fillInfo(_x4,_x5,_x6){return _ref2.apply(this,arguments)}}(),_enums=__webpack_require__(162),_utils=__webpack_require__(150)}]);